(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const h of o)if(h.type==="childList")for(const l of h.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function e(o){const h={};return o.integrity&&(h.integrity=o.integrity),o.referrerPolicy&&(h.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?h.credentials="include":o.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function r(o){if(o.ep)return;o.ep=!0;const h=e(o);fetch(o.href,h)}})();let mi;const Cf="BhoomiTechOfflineDB",Hn="submissions",Ya=indexedDB.open(Cf,1);Ya.onupgradeneeded=function(i){mi=i.target.result,mi.objectStoreNames.contains(Hn)||mi.createObjectStore(Hn,{keyPath:"id"})};Ya.onsuccess=function(i){mi=i.target.result,console.log("IndexedDB Ready")};Ya.onerror=function(){console.error("IndexedDB Error")};function Rf(i){return new Promise((t,e)=>{const r=mi.transaction(Hn,"readwrite");r.objectStore(Hn).put(i),r.oncomplete=t,r.onerror=e})}function kf(){return new Promise((i,t)=>{const o=mi.transaction(Hn,"readonly").objectStore(Hn).getAll();o.onsuccess=()=>i(o.result),o.onerror=t})}function xf(i){mi.transaction(Hn,"readwrite").objectStore(Hn).delete(i)}const Lf=()=>{};var ph={};const Mc=function(i){const t=[];let e=0;for(let r=0;r<i.length;r++){let o=i.charCodeAt(r);o<128?t[e++]=o:o<2048?(t[e++]=o>>6|192,t[e++]=o&63|128):(o&64512)===55296&&r+1<i.length&&(i.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(i.charCodeAt(++r)&1023),t[e++]=o>>18|240,t[e++]=o>>12&63|128,t[e++]=o>>6&63|128,t[e++]=o&63|128):(t[e++]=o>>12|224,t[e++]=o>>6&63|128,t[e++]=o&63|128)}return t},Of=function(i){const t=[];let e=0,r=0;for(;e<i.length;){const o=i[e++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){const h=i[e++];t[r++]=String.fromCharCode((o&31)<<6|h&63)}else if(o>239&&o<365){const h=i[e++],l=i[e++],m=i[e++],_=((o&7)<<18|(h&63)<<12|(l&63)<<6|m&63)-65536;t[r++]=String.fromCharCode(55296+(_>>10)),t[r++]=String.fromCharCode(56320+(_&1023))}else{const h=i[e++],l=i[e++];t[r++]=String.fromCharCode((o&15)<<12|(h&63)<<6|l&63)}}return t.join("")},Vc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,t){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<i.length;o+=3){const h=i[o],l=o+1<i.length,m=l?i[o+1]:0,_=o+2<i.length,v=_?i[o+2]:0,A=h>>2,b=(h&3)<<4|m>>4;let R=(m&15)<<2|v>>6,U=v&63;_||(U=64,l||(R=64)),r.push(e[A],e[b],e[R],e[U])}return r.join("")},encodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(i):this.encodeByteArray(Mc(i),t)},decodeString(i,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(i):Of(this.decodeStringToByteArray(i,t))},decodeStringToByteArray(i,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<i.length;){const h=e[i.charAt(o++)],m=o<i.length?e[i.charAt(o)]:0;++o;const v=o<i.length?e[i.charAt(o)]:64;++o;const b=o<i.length?e[i.charAt(o)]:64;if(++o,h==null||m==null||v==null||b==null)throw new Nf;const R=h<<2|m>>4;if(r.push(R),v!==64){const U=m<<4&240|v>>2;if(r.push(U),b!==64){const z=v<<6&192|b;r.push(z)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class Nf extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Df=function(i){const t=Mc(i);return Vc.encodeByteArray(t,!0)},Ro=function(i){return Df(i).replace(/\./g,"")},Bc=function(i){try{return Vc.decodeString(i,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Mf(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Vf=()=>Mf().__FIREBASE_DEFAULTS__,Bf=()=>{if(typeof process>"u"||typeof ph>"u")return;const i=ph.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},Uf=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=i&&Bc(i[1]);return t&&JSON.parse(t)},Ko=()=>{try{return Lf()||Vf()||Bf()||Uf()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},Uc=i=>Ko()?.emulatorHosts?.[i],Fc=i=>{const t=Uc(i);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),r]:[t.substring(0,e),r]},zc=()=>Ko()?.config,Hc=i=>Ko()?.[`_${i}`];class Ff{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,r))}}}function Kn(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tu(i){return(await fetch(i,{credentials:"include"})).ok}function jc(i,t){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},r=t||"demo-project",o=i.iat||0,h=i.sub||i.user_id;if(!h)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:h,user_id:h,firebase:{sign_in_provider:"custom",identities:{}},...i};return[Ro(JSON.stringify(e)),Ro(JSON.stringify(l)),""].join(".")}const is={};function zf(){const i={prod:[],emulator:[]};for(const t of Object.keys(is))is[t]?i.emulator.push(t):i.prod.push(t);return i}function Hf(i){let t=document.getElementById(i),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",i),e=!0),{created:e,element:t}}let mh=!1;function eu(i,t){if(typeof window>"u"||typeof document>"u"||!Kn(window.location.host)||is[i]===t||is[i]||mh)return;is[i]=t;function e(R){return`__firebase__banner__${R}`}const r="__firebase__banner",h=zf().prod.length>0;function l(){const R=document.getElementById(r);R&&R.remove()}function m(R){R.style.display="flex",R.style.background="#7faaf0",R.style.position="fixed",R.style.bottom="5px",R.style.left="5px",R.style.padding=".5em",R.style.borderRadius="5px",R.style.alignItems="center"}function _(R,U){R.setAttribute("width","24"),R.setAttribute("id",U),R.setAttribute("height","24"),R.setAttribute("viewBox","0 0 24 24"),R.setAttribute("fill","none"),R.style.marginLeft="-6px"}function v(){const R=document.createElement("span");return R.style.cursor="pointer",R.style.marginLeft="16px",R.style.fontSize="24px",R.innerHTML=" &times;",R.onclick=()=>{mh=!0,l()},R}function A(R,U){R.setAttribute("id",U),R.innerText="Learn more",R.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",R.setAttribute("target","__blank"),R.style.paddingLeft="5px",R.style.textDecoration="underline"}function b(){const R=Hf(r),U=e("text"),z=document.getElementById(U)||document.createElement("span"),H=e("learnmore"),G=document.getElementById(H)||document.createElement("a"),at=e("preprendIcon"),ut=document.getElementById(at)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(R.created){const et=R.element;m(et),A(G,H);const dt=v();_(ut,at),et.append(ut,z,G,dt),document.body.appendChild(et)}h?(z.innerText="Preview backend disconnected.",ut.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ut.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,z.innerText="Preview backend running in this workspace."),z.setAttribute("id",U)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}function ne(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ne())}function Wf(){const i=Ko()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Zf(){const i=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof i=="object"&&i.id!==void 0}function Gf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Kf(){const i=ne();return i.indexOf("MSIE ")>=0||i.indexOf("Trident/")>=0}function $f(){return!Wf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Jf(){try{return typeof indexedDB=="object"}catch{return!1}}function Xf(){return new Promise((i,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),e||self.indexedDB.deleteDatabase(r),i(!0)},o.onupgradeneeded=()=>{e=!1},o.onerror=()=>{t(o.error?.message||"")}}catch(e){t(e)}})}const Qf="FirebaseError";class tn extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=Qf,Object.setPrototypeOf(this,tn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vs.prototype.create)}}class vs{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,h=this.errors[t],l=h?Yf(h,r):"Error",m=`${this.serviceName}: ${l} (${o}).`;return new tn(o,m,r)}}function Yf(i,t){return i.replace(tp,(e,r)=>{const o=t[r];return o!=null?String(o):`<${r}?>`})}const tp=/\{\$([^}]+)}/g;function ep(i){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t))return!1;return!0}function wi(i,t){if(i===t)return!0;const e=Object.keys(i),r=Object.keys(t);for(const o of e){if(!r.includes(o))return!1;const h=i[o],l=t[o];if(_h(h)&&_h(l)){if(!wi(h,l))return!1}else if(h!==l)return!1}for(const o of r)if(!e.includes(o))return!1;return!0}function _h(i){return i!==null&&typeof i=="object"}function ws(i){const t=[];for(const[e,r]of Object.entries(i))Array.isArray(r)?r.forEach(o=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(o))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function np(i,t){const e=new ip(i,t);return e.subscribe.bind(e)}class ip{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let o;if(t===void 0&&e===void 0&&r===void 0)throw new Error("Missing Observer.");rp(t,["next","error","complete"])?o=t:o={next:t,error:e,complete:r},o.next===void 0&&(o.next=va),o.error===void 0&&(o.error=va),o.complete===void 0&&(o.complete=va);const h=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),h}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function rp(i,t){if(typeof i!="object"||i===null)return!1;for(const e of t)if(e in i&&typeof i[e]=="function")return!0;return!1}function va(){}function ue(i){return i&&i._delegate?i._delegate:i}class jn{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const fi="[DEFAULT]";class sp{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new Ff;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:e});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),r=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(ap(t))try{this.getOrInitializeService({instanceIdentifier:fi})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(e);try{const h=this.getOrInitializeService({instanceIdentifier:o});r.resolve(h)}catch{}}}}clearInstance(t=fi){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=fi){return this.instances.has(t)}getOptions(t=fi){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[h,l]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(h);r===m&&l.resolve(o)}return o}onInit(t,e){const r=this.normalizeInstanceIdentifier(e),o=this.onInitCallbacks.get(r)??new Set;o.add(t),this.onInitCallbacks.set(r,o);const h=this.instances.get(r);return h&&t(h,r),()=>{o.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const o of r)try{o(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:op(t),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=fi){return this.component?this.component.multipleInstances?t:fi:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function op(i){return i===fi?void 0:i}function ap(i){return i.instantiationMode==="EAGER"}class up{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new sp(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var ht;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(ht||(ht={}));const hp={debug:ht.DEBUG,verbose:ht.VERBOSE,info:ht.INFO,warn:ht.WARN,error:ht.ERROR,silent:ht.SILENT},cp=ht.INFO,lp={[ht.DEBUG]:"log",[ht.VERBOSE]:"log",[ht.INFO]:"info",[ht.WARN]:"warn",[ht.ERROR]:"error"},dp=(i,t,...e)=>{if(t<i.logLevel)return;const r=new Date().toISOString(),o=lp[t];if(o)console[o](`[${r}]  ${i.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class nu{constructor(t){this.name=t,this._logLevel=cp,this._logHandler=dp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ht))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?hp[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,ht.DEBUG,...t),this._logHandler(this,ht.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,ht.VERBOSE,...t),this._logHandler(this,ht.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,ht.INFO,...t),this._logHandler(this,ht.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,ht.WARN,...t),this._logHandler(this,ht.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,ht.ERROR,...t),this._logHandler(this,ht.ERROR,...t)}}const fp=(i,t)=>t.some(e=>i instanceof e);let gh,yh;function pp(){return gh||(gh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function mp(){return yh||(yh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Wc=new WeakMap,La=new WeakMap,qc=new WeakMap,wa=new WeakMap,iu=new WeakMap;function _p(i){const t=new Promise((e,r)=>{const o=()=>{i.removeEventListener("success",h),i.removeEventListener("error",l)},h=()=>{e(Un(i.result)),o()},l=()=>{r(i.error),o()};i.addEventListener("success",h),i.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&Wc.set(e,i)}).catch(()=>{}),iu.set(t,i),t}function gp(i){if(La.has(i))return;const t=new Promise((e,r)=>{const o=()=>{i.removeEventListener("complete",h),i.removeEventListener("error",l),i.removeEventListener("abort",l)},h=()=>{e(),o()},l=()=>{r(i.error||new DOMException("AbortError","AbortError")),o()};i.addEventListener("complete",h),i.addEventListener("error",l),i.addEventListener("abort",l)});La.set(i,t)}let Oa={get(i,t,e){if(i instanceof IDBTransaction){if(t==="done")return La.get(i);if(t==="objectStoreNames")return i.objectStoreNames||qc.get(i);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Un(i[t])},set(i,t,e){return i[t]=e,!0},has(i,t){return i instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in i}};function yp(i){Oa=i(Oa)}function vp(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const r=i.call(Ta(this),t,...e);return qc.set(r,t.sort?t.sort():[t]),Un(r)}:mp().includes(i)?function(...t){return i.apply(Ta(this),t),Un(Wc.get(this))}:function(...t){return Un(i.apply(Ta(this),t))}}function wp(i){return typeof i=="function"?vp(i):(i instanceof IDBTransaction&&gp(i),fp(i,pp())?new Proxy(i,Oa):i)}function Un(i){if(i instanceof IDBRequest)return _p(i);if(wa.has(i))return wa.get(i);const t=wp(i);return t!==i&&(wa.set(i,t),iu.set(t,i)),t}const Ta=i=>iu.get(i);function Tp(i,t,{blocked:e,upgrade:r,blocking:o,terminated:h}={}){const l=indexedDB.open(i,t),m=Un(l);return r&&l.addEventListener("upgradeneeded",_=>{r(Un(l.result),_.oldVersion,_.newVersion,Un(l.transaction),_)}),e&&l.addEventListener("blocked",_=>e(_.oldVersion,_.newVersion,_)),m.then(_=>{h&&_.addEventListener("close",()=>h()),o&&_.addEventListener("versionchange",v=>o(v.oldVersion,v.newVersion,v))}).catch(()=>{}),m}const Ep=["get","getKey","getAll","getAllKeys","count"],Ip=["put","add","delete","clear"],Ea=new Map;function vh(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t=="string"))return;if(Ea.get(t))return Ea.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,o=Ip.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!(o||Ep.includes(e)))return;const h=async function(l,...m){const _=this.transaction(l,o?"readwrite":"readonly");let v=_.store;return r&&(v=v.index(m.shift())),(await Promise.all([v[e](...m),o&&_.done]))[0]};return Ea.set(t,h),h}yp(i=>({...i,get:(t,e,r)=>vh(t,e)||i.get(t,e,r),has:(t,e)=>!!vh(t,e)||i.has(t,e)}));class Ap{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Pp(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(e=>e).join(" ")}}function Pp(i){return i.getComponent()?.type==="VERSION"}const Na="@firebase/app",wh="0.14.8";const vn=new nu("@firebase/app"),bp="@firebase/app-compat",Sp="@firebase/analytics-compat",Cp="@firebase/analytics",Rp="@firebase/app-check-compat",kp="@firebase/app-check",xp="@firebase/auth",Lp="@firebase/auth-compat",Op="@firebase/database",Np="@firebase/data-connect",Dp="@firebase/database-compat",Mp="@firebase/functions",Vp="@firebase/functions-compat",Bp="@firebase/installations",Up="@firebase/installations-compat",Fp="@firebase/messaging",zp="@firebase/messaging-compat",Hp="@firebase/performance",jp="@firebase/performance-compat",Wp="@firebase/remote-config",qp="@firebase/remote-config-compat",Zp="@firebase/storage",Gp="@firebase/storage-compat",Kp="@firebase/firestore",$p="@firebase/ai",Jp="@firebase/firestore-compat",Xp="firebase",Qp="12.9.0";const Da="[DEFAULT]",Yp={[Na]:"fire-core",[bp]:"fire-core-compat",[Cp]:"fire-analytics",[Sp]:"fire-analytics-compat",[kp]:"fire-app-check",[Rp]:"fire-app-check-compat",[xp]:"fire-auth",[Lp]:"fire-auth-compat",[Op]:"fire-rtdb",[Np]:"fire-data-connect",[Dp]:"fire-rtdb-compat",[Mp]:"fire-fn",[Vp]:"fire-fn-compat",[Bp]:"fire-iid",[Up]:"fire-iid-compat",[Fp]:"fire-fcm",[zp]:"fire-fcm-compat",[Hp]:"fire-perf",[jp]:"fire-perf-compat",[Wp]:"fire-rc",[qp]:"fire-rc-compat",[Zp]:"fire-gcs",[Gp]:"fire-gcs-compat",[Kp]:"fire-fst",[Jp]:"fire-fst-compat",[$p]:"fire-vertex","fire-js":"fire-js",[Xp]:"fire-js-all"};const ko=new Map,tm=new Map,Ma=new Map;function Th(i,t){try{i.container.addComponent(t)}catch(e){vn.debug(`Component ${t.name} failed to register with FirebaseApp ${i.name}`,e)}}function Ti(i){const t=i.name;if(Ma.has(t))return vn.debug(`There were multiple attempts to register component ${t}.`),!1;Ma.set(t,i);for(const e of ko.values())Th(e,i);for(const e of tm.values())Th(e,i);return!0}function $o(i,t){const e=i.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),i.container.getProvider(t)}function Oe(i){return i==null?!1:i.settings!==void 0}const em={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Fn=new vs("app","Firebase",em);class nm{constructor(t,e,r){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new jn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Fn.create("app-deleted",{appName:this._name})}}const Ci=Qp;function Zc(i,t={}){let e=i;typeof t!="object"&&(t={name:t});const r={name:Da,automaticDataCollectionEnabled:!0,...t},o=r.name;if(typeof o!="string"||!o)throw Fn.create("bad-app-name",{appName:String(o)});if(e||(e=zc()),!e)throw Fn.create("no-options");const h=ko.get(o);if(h){if(wi(e,h.options)&&wi(r,h.config))return h;throw Fn.create("duplicate-app",{appName:o})}const l=new up(o);for(const _ of Ma.values())l.addComponent(_);const m=new nm(e,r,l);return ko.set(o,m),m}function ru(i=Da){const t=ko.get(i);if(!t&&i===Da&&zc())return Zc();if(!t)throw Fn.create("no-app",{appName:i});return t}function Ke(i,t,e){let r=Yp[i]??i;e&&(r+=`-${e}`);const o=r.match(/\s|\//),h=t.match(/\s|\//);if(o||h){const l=[`Unable to register library "${r}" with version "${t}":`];o&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&h&&l.push("and"),h&&l.push(`version name "${t}" contains illegal characters (whitespace or "/")`),vn.warn(l.join(" "));return}Ti(new jn(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const im="firebase-heartbeat-database",rm=1,ls="firebase-heartbeat-store";let Ia=null;function Gc(){return Ia||(Ia=Tp(im,rm,{upgrade:(i,t)=>{switch(t){case 0:try{i.createObjectStore(ls)}catch(e){console.warn(e)}}}}).catch(i=>{throw Fn.create("idb-open",{originalErrorMessage:i.message})})),Ia}async function sm(i){try{const e=(await Gc()).transaction(ls),r=await e.objectStore(ls).get(Kc(i));return await e.done,r}catch(t){if(t instanceof tn)vn.warn(t.message);else{const e=Fn.create("idb-get",{originalErrorMessage:t?.message});vn.warn(e.message)}}}async function Eh(i,t){try{const r=(await Gc()).transaction(ls,"readwrite");await r.objectStore(ls).put(t,Kc(i)),await r.done}catch(e){if(e instanceof tn)vn.warn(e.message);else{const r=Fn.create("idb-set",{originalErrorMessage:e?.message});vn.warn(r.message)}}}function Kc(i){return`${i.name}!${i.options.appId}`}const om=1024,am=30;class um{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new cm(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ih();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:e}),this._heartbeatsCache.heartbeats.length>am){const o=lm(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){vn.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ih(),{heartbeatsToSend:e,unsentEntries:r}=hm(this._heartbeatsCache.heartbeats),o=Ro(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return vn.warn(t),""}}}function Ih(){return new Date().toISOString().substring(0,10)}function hm(i,t=om){const e=[];let r=i.slice();for(const o of i){const h=e.find(l=>l.agent===o.agent);if(h){if(h.dates.push(o.date),Ah(e)>t){h.dates.pop();break}}else if(e.push({agent:o.agent,dates:[o.date]}),Ah(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}class cm{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jf()?Xf().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await sm(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return Eh(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return Eh(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function Ah(i){return Ro(JSON.stringify({version:2,heartbeats:i})).length}function lm(i){if(i.length===0)return-1;let t=0,e=i[0].date;for(let r=1;r<i.length;r++)i[r].date<e&&(e=i[r].date,t=r);return t}function dm(i){Ti(new jn("platform-logger",t=>new Ap(t),"PRIVATE")),Ti(new jn("heartbeat",t=>new um(t),"PRIVATE")),Ke(Na,wh,i),Ke(Na,wh,"esm2020"),Ke("fire-js","")}dm("");var fm="firebase",pm="12.9.0";Ke(fm,pm,"app");function $c(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const mm=$c,Jc=new vs("auth","Firebase",$c());const xo=new nu("@firebase/auth");function _m(i,...t){xo.logLevel<=ht.WARN&&xo.warn(`Auth (${Ci}): ${i}`,...t)}function wo(i,...t){xo.logLevel<=ht.ERROR&&xo.error(`Auth (${Ci}): ${i}`,...t)}function wn(i,...t){throw su(i,...t)}function $e(i,...t){return su(i,...t)}function Xc(i,t,e){const r={...mm(),[t]:e};return new vs("auth","Firebase",r).create(t,{appName:i.name})}function _i(i){return Xc(i,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function su(i,...t){if(typeof i!="string"){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=i.name),i._errorFactory.create(e,...r)}return Jc.create(i,...t)}function X(i,t,...e){if(!i)throw su(t,...e)}function mn(i){const t="INTERNAL ASSERTION FAILED: "+i;throw wo(t),new Error(t)}function Tn(i,t){i||mn(t)}function Va(){return typeof self<"u"&&self.location?.href||""}function gm(){return Ph()==="http:"||Ph()==="https:"}function Ph(){return typeof self<"u"&&self.location?.protocol||null}function ym(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(gm()||Zf()||"connection"in navigator)?navigator.onLine:!0}function vm(){if(typeof navigator>"u")return null;const i=navigator;return i.languages&&i.languages[0]||i.language||null}class Ts{constructor(t,e){this.shortDelay=t,this.longDelay=e,Tn(e>t,"Short delay should be less than long delay!"),this.isMobile=jf()||Gf()}get(){return ym()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ou(i,t){Tn(i.emulator,"Emulator should always be set here");const{url:e}=i.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class Qc{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;mn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;mn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;mn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const wm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const Tm=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Em=new Ts(3e4,6e4);function au(i,t){return i.tenantId&&!t.tenantId?{...t,tenantId:i.tenantId}:t}async function wr(i,t,e,r,o={}){return Yc(i,o,async()=>{let h={},l={};r&&(t==="GET"?l=r:h={body:JSON.stringify(r)});const m=ws({key:i.config.apiKey,...l}).slice(1),_=await i._getAdditionalHeaders();_["Content-Type"]="application/json",i.languageCode&&(_["X-Firebase-Locale"]=i.languageCode);const v={method:t,headers:_,...h};return qf()||(v.referrerPolicy="no-referrer"),i.emulatorConfig&&Kn(i.emulatorConfig.host)&&(v.credentials="include"),Qc.fetch()(await tl(i,i.config.apiHost,e,m),v)})}async function Yc(i,t,e){i._canInitEmulator=!1;const r={...wm,...t};try{const o=new Am(i),h=await Promise.race([e(),o.promise]);o.clearNetworkTimeout();const l=await h.json();if("needConfirmation"in l)throw co(i,"account-exists-with-different-credential",l);if(h.ok&&!("errorMessage"in l))return l;{const m=h.ok?l.errorMessage:l.error.message,[_,v]=m.split(" : ");if(_==="FEDERATED_USER_ID_ALREADY_LINKED")throw co(i,"credential-already-in-use",l);if(_==="EMAIL_EXISTS")throw co(i,"email-already-in-use",l);if(_==="USER_DISABLED")throw co(i,"user-disabled",l);const A=r[_]||_.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Xc(i,A,v);wn(i,A)}}catch(o){if(o instanceof tn)throw o;wn(i,"network-request-failed",{message:String(o)})}}async function Im(i,t,e,r,o={}){const h=await wr(i,t,e,r,o);return"mfaPendingCredential"in h&&wn(i,"multi-factor-auth-required",{_serverResponse:h}),h}async function tl(i,t,e,r){const o=`${t}${e}?${r}`,h=i,l=h.config.emulator?ou(i.config,o):`${i.config.apiScheme}://${o}`;return Tm.includes(e)&&(await h._persistenceManagerAvailable,h._getPersistenceType()==="COOKIE")?h._getPersistence()._getFinalTarget(l).toString():l}class Am{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r($e(this.auth,"network-request-failed")),Em.get())})}}function co(i,t,e){const r={appName:i.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const o=$e(i,t,r);return o.customData._tokenResponse=e,o}async function Pm(i,t){return wr(i,"POST","/v1/accounts:delete",t)}async function Lo(i,t){return wr(i,"POST","/v1/accounts:lookup",t)}function rs(i){if(i)try{const t=new Date(Number(i));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function bm(i,t=!1){const e=ue(i),r=await e.getIdToken(t),o=uu(r);X(o&&o.exp&&o.auth_time&&o.iat,e.auth,"internal-error");const h=typeof o.firebase=="object"?o.firebase:void 0,l=h?.sign_in_provider;return{claims:o,token:r,authTime:rs(Aa(o.auth_time)),issuedAtTime:rs(Aa(o.iat)),expirationTime:rs(Aa(o.exp)),signInProvider:l||null,signInSecondFactor:h?.sign_in_second_factor||null}}function Aa(i){return Number(i)*1e3}function uu(i){const[t,e,r]=i.split(".");if(t===void 0||e===void 0||r===void 0)return wo("JWT malformed, contained fewer than 3 sections"),null;try{const o=Bc(e);return o?JSON.parse(o):(wo("Failed to decode base64 JWT payload"),null)}catch(o){return wo("Caught error parsing JWT payload as JSON",o?.toString()),null}}function bh(i){const t=uu(i);return X(t,"internal-error"),X(typeof t.exp<"u","internal-error"),X(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function ds(i,t,e=!1){if(e)return t;try{return await t}catch(r){throw r instanceof tn&&Sm(r)&&i.auth.currentUser===i&&await i.auth.signOut(),r}}function Sm({code:i}){return i==="auth/user-disabled"||i==="auth/user-token-expired"}class Cm{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Ba{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=rs(this.lastLoginAt),this.creationTime=rs(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Oo(i){const t=i.auth,e=await i.getIdToken(),r=await ds(i,Lo(t,{idToken:e}));X(r?.users.length,t,"internal-error");const o=r.users[0];i._notifyReloadListener(o);const h=o.providerUserInfo?.length?el(o.providerUserInfo):[],l=km(i.providerData,h),m=i.isAnonymous,_=!(i.email&&o.passwordHash)&&!l?.length,v=m?_:!1,A={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Ba(o.createdAt,o.lastLoginAt),isAnonymous:v};Object.assign(i,A)}async function Rm(i){const t=ue(i);await Oo(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function km(i,t){return[...i.filter(r=>!t.some(o=>o.providerId===r.providerId)),...t]}function el(i){return i.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function xm(i,t){const e=await Yc(i,{},async()=>{const r=ws({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:o,apiKey:h}=i.config,l=await tl(i,o,"/v1/token",`key=${h}`),m=await i._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const _={method:"POST",headers:m,body:r};return i.emulatorConfig&&Kn(i.emulatorConfig.host)&&(_.credentials="include"),Qc.fetch()(l,_)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function Lm(i,t){return wr(i,"POST","/v2/accounts:revokeToken",au(i,t))}class ur{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){X(t.idToken,"internal-error"),X(typeof t.idToken<"u","internal-error"),X(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):bh(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){X(t.length!==0,"internal-error");const e=bh(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(X(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:r,refreshToken:o,expiresIn:h}=await xm(t,e);this.updateTokensAndExpiration(r,o,Number(h))}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(t,e){const{refreshToken:r,accessToken:o,expirationTime:h}=e,l=new ur;return r&&(X(typeof r=="string","internal-error",{appName:t}),l.refreshToken=r),o&&(X(typeof o=="string","internal-error",{appName:t}),l.accessToken=o),h&&(X(typeof h=="number","internal-error",{appName:t}),l.expirationTime=h),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new ur,this.toJSON())}_performRefresh(){return mn("not implemented")}}function On(i,t){X(typeof i=="string"||typeof i>"u","internal-error",{appName:t})}class Me{constructor({uid:t,auth:e,stsTokenManager:r,...o}){this.providerId="firebase",this.proactiveRefresh=new Cm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ba(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(t){const e=await ds(this,this.stsTokenManager.getToken(this.auth,t));return X(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return bm(this,t)}reload(){return Rm(this)}_assign(t){this!==t&&(X(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Me({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){X(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let r=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),e&&await Oo(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Oe(this.auth.app))return Promise.reject(_i(this.auth));const t=await this.getIdToken();return await ds(this,Pm(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const r=e.displayName??void 0,o=e.email??void 0,h=e.phoneNumber??void 0,l=e.photoURL??void 0,m=e.tenantId??void 0,_=e._redirectEventId??void 0,v=e.createdAt??void 0,A=e.lastLoginAt??void 0,{uid:b,emailVerified:R,isAnonymous:U,providerData:z,stsTokenManager:H}=e;X(b&&H,t,"internal-error");const G=ur.fromJSON(this.name,H);X(typeof b=="string",t,"internal-error"),On(r,t.name),On(o,t.name),X(typeof R=="boolean",t,"internal-error"),X(typeof U=="boolean",t,"internal-error"),On(h,t.name),On(l,t.name),On(m,t.name),On(_,t.name),On(v,t.name),On(A,t.name);const at=new Me({uid:b,auth:t,email:o,emailVerified:R,displayName:r,isAnonymous:U,photoURL:l,phoneNumber:h,tenantId:m,stsTokenManager:G,createdAt:v,lastLoginAt:A});return z&&Array.isArray(z)&&(at.providerData=z.map(ut=>({...ut}))),_&&(at._redirectEventId=_),at}static async _fromIdTokenResponse(t,e,r=!1){const o=new ur;o.updateFromServerResponse(e);const h=new Me({uid:e.localId,auth:t,stsTokenManager:o,isAnonymous:r});return await Oo(h),h}static async _fromGetAccountInfoResponse(t,e,r){const o=e.users[0];X(o.localId!==void 0,"internal-error");const h=o.providerUserInfo!==void 0?el(o.providerUserInfo):[],l=!(o.email&&o.passwordHash)&&!h?.length,m=new ur;m.updateFromIdToken(r);const _=new Me({uid:o.localId,auth:t,stsTokenManager:m,isAnonymous:l}),v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:h,metadata:new Ba(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!h?.length};return Object.assign(_,v),_}}const Sh=new Map;function _n(i){Tn(i instanceof Function,"Expected a class definition");let t=Sh.get(i);return t?(Tn(t instanceof i,"Instance stored in cache mismatched with class"),t):(t=new i,Sh.set(i,t),t)}class nl{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}nl.type="NONE";const Ch=nl;function To(i,t,e){return`firebase:${i}:${t}:${e}`}class hr{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:o,name:h}=this.auth;this.fullUserKey=To(this.userKey,o.apiKey,h),this.fullPersistenceKey=To("persistence",o.apiKey,h),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Lo(this.auth,{idToken:t}).catch(()=>{});return e?Me._fromGetAccountInfoResponse(this.auth,e,t):null}return Me._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,r="authUser"){if(!e.length)return new hr(_n(Ch),t,r);const o=(await Promise.all(e.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let h=o[0]||_n(Ch);const l=To(r,t.config.apiKey,t.name);let m=null;for(const v of e)try{const A=await v._get(l);if(A){let b;if(typeof A=="string"){const R=await Lo(t,{idToken:A}).catch(()=>{});if(!R)break;b=await Me._fromGetAccountInfoResponse(t,R,A)}else b=Me._fromJSON(t,A);v!==h&&(m=b),h=v;break}}catch{}const _=o.filter(v=>v._shouldAllowMigration);return!h._shouldAllowMigration||!_.length?new hr(h,t,r):(h=_[0],m&&await h._set(l,m.toJSON()),await Promise.all(e.map(async v=>{if(v!==h)try{await v._remove(l)}catch{}})),new hr(h,t,r))}}function Rh(i){const t=i.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ol(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(il(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ul(t))return"Blackberry";if(hl(t))return"Webos";if(rl(t))return"Safari";if((t.includes("chrome/")||sl(t))&&!t.includes("edge/"))return"Chrome";if(al(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=i.match(e);if(r?.length===2)return r[1]}return"Other"}function il(i=ne()){return/firefox\//i.test(i)}function rl(i=ne()){const t=i.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function sl(i=ne()){return/crios\//i.test(i)}function ol(i=ne()){return/iemobile/i.test(i)}function al(i=ne()){return/android/i.test(i)}function ul(i=ne()){return/blackberry/i.test(i)}function hl(i=ne()){return/webos/i.test(i)}function hu(i=ne()){return/iphone|ipad|ipod/i.test(i)||/macintosh/i.test(i)&&/mobile/i.test(i)}function Om(i=ne()){return hu(i)&&!!window.navigator?.standalone}function Nm(){return Kf()&&document.documentMode===10}function cl(i=ne()){return hu(i)||al(i)||hl(i)||ul(i)||/windows phone/i.test(i)||ol(i)}function ll(i,t=[]){let e;switch(i){case"Browser":e=Rh(ne());break;case"Worker":e=`${Rh(ne())}-${i}`;break;default:e=i}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Ci}/${r}`}class Dm{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=h=>new Promise((l,m)=>{try{const _=t(h);l(_)}catch(_){m(_)}});r.onAbort=e,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const r of this.queue)await r(t),r.onAbort&&e.push(r.onAbort)}catch(r){e.reverse();for(const o of e)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Mm(i,t={}){return wr(i,"GET","/v2/passwordPolicy",au(i,t))}const Vm=6;class Bm{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??Vm,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(e.meetsMinPasswordLength=t.length>=r),o&&(e.meetsMaxPasswordLength=t.length<=o)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let r;for(let o=0;o<t.length;o++)r=t.charAt(o),this.updatePasswordCharacterOptionsStatuses(e,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(t,e,r,o,h){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=h))}}class Um{constructor(t,e,r,o){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new kh(this),this.idTokenSubscription=new kh(this),this.beforeStateQueue=new Dm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jc,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(h=>this._resolvePersistenceManagerAvailable=h)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=_n(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await hr.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Lo(this,{idToken:t}),r=await Me._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(Oe(this.app)){const h=this.app.settings.authIdToken;return h?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(h).then(l,l))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let r=e,o=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const h=this.redirectUser?._redirectEventId,l=r?._redirectEventId,m=await this.tryRedirectSignIn(t);(!h||h===l)&&m?.user&&(r=m.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(h){r=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(h))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return X(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Oo(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=vm()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(Oe(this.app))return Promise.reject(_i(this));const e=t?ue(t):null;return e&&X(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&X(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return Oe(this.app)?Promise.reject(_i(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return Oe(this.app)?Promise.reject(_i(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_n(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await Mm(this),e=new Bm(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new vs("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const r=this.onAuthStateChanged(()=>{r(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(r.tenantId=this.tenantId),await Lm(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const r=await this.getOrInitRedirectPersistenceManager(e);return t===null?r.removeCurrentUser():r.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&_n(t)||this._popupRedirectResolver;X(e,this,"argument-error"),this.redirectPersistenceManager=await hr.create(this,[_n(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,o){if(this._deleted)return()=>{};const h=typeof e=="function"?e:e.next.bind(e);let l=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(X(m,this,"internal-error"),m.then(()=>{l||h(this.currentUser)}),typeof e=="function"){const _=t.addObserver(e,r,o);return()=>{l=!0,_()}}else{const _=t.addObserver(e);return()=>{l=!0,_()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return X(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=ll(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){if(Oe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&_m(`Error while retrieving App Check token: ${t.error}`),t?.token}}function cu(i){return ue(i)}class kh{constructor(t){this.auth=t,this.observer=null,this.addObserver=np(e=>this.observer=e)}get next(){return X(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let lu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Fm(i){lu=i}function zm(i){return lu.loadJS(i)}function Hm(){return lu.gapiScript}function jm(i){return`__${i}${Math.floor(Math.random()*1e6)}`}function Wm(i,t){const e=$o(i,"auth");if(e.isInitialized()){const o=e.getImmediate(),h=e.getOptions();if(wi(h,t??{}))return o;wn(o,"already-initialized")}return e.initialize({options:t})}function qm(i,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(_n);t?.errorMap&&i._updateErrorMap(t.errorMap),i._initializeWithPersistence(r,t?.popupRedirectResolver)}function Zm(i,t,e){const r=cu(i);X(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const o=!1,h=dl(t),{host:l,port:m}=Gm(t),_=m===null?"":`:${m}`,v={url:`${h}//${l}${_}/`},A=Object.freeze({host:l,port:m,protocol:h.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){X(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),X(wi(v,r.config.emulator)&&wi(A,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=v,r.emulatorConfig=A,r.settings.appVerificationDisabledForTesting=!0,Kn(l)?(tu(`${h}//${l}${_}`),eu("Auth",!0)):Km()}function dl(i){const t=i.indexOf(":");return t<0?"":i.substr(0,t+1)}function Gm(i){const t=dl(i),e=/(\/\/)?([^?#/]+)/.exec(i.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const h=o[1];return{host:h,port:xh(r.substr(h.length+1))}}else{const[h,l]=r.split(":");return{host:h,port:xh(l)}}}function xh(i){if(!i)return null;const t=Number(i);return isNaN(t)?null:t}function Km(){function i(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",i):i())}class fl{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return mn("not implemented")}_getIdTokenResponse(t){return mn("not implemented")}_linkToIdToken(t,e){return mn("not implemented")}_getReauthenticationResolver(t){return mn("not implemented")}}async function cr(i,t){return Im(i,"POST","/v1/accounts:signInWithIdp",au(i,t))}const $m="http://localhost";class Ei extends fl{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Ei(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):wn("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:r,signInMethod:o,...h}=e;if(!r||!o)return null;const l=new Ei(r,o);return l.idToken=h.idToken||void 0,l.accessToken=h.accessToken||void 0,l.secret=h.secret,l.nonce=h.nonce,l.pendingToken=h.pendingToken||null,l}_getIdTokenResponse(t){const e=this.buildRequest();return cr(t,e)}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,cr(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,cr(t,e)}buildRequest(){const t={requestUri:$m,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=ws(e)}return t}}class pl{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Es extends pl{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Nn extends Es{constructor(){super("facebook.com")}static credential(t){return Ei._fromParams({providerId:Nn.PROVIDER_ID,signInMethod:Nn.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Nn.credentialFromTaggedObject(t)}static credentialFromError(t){return Nn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Nn.credential(t.oauthAccessToken)}catch{return null}}}Nn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Nn.PROVIDER_ID="facebook.com";class Dn extends Es{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Ei._fromParams({providerId:Dn.PROVIDER_ID,signInMethod:Dn.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Dn.credentialFromTaggedObject(t)}static credentialFromError(t){return Dn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:r}=t;if(!e&&!r)return null;try{return Dn.credential(e,r)}catch{return null}}}Dn.GOOGLE_SIGN_IN_METHOD="google.com";Dn.PROVIDER_ID="google.com";class Mn extends Es{constructor(){super("github.com")}static credential(t){return Ei._fromParams({providerId:Mn.PROVIDER_ID,signInMethod:Mn.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Mn.credentialFromTaggedObject(t)}static credentialFromError(t){return Mn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Mn.credential(t.oauthAccessToken)}catch{return null}}}Mn.GITHUB_SIGN_IN_METHOD="github.com";Mn.PROVIDER_ID="github.com";class Vn extends Es{constructor(){super("twitter.com")}static credential(t,e){return Ei._fromParams({providerId:Vn.PROVIDER_ID,signInMethod:Vn.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Vn.credentialFromTaggedObject(t)}static credentialFromError(t){return Vn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:r}=t;if(!e||!r)return null;try{return Vn.credential(e,r)}catch{return null}}}Vn.TWITTER_SIGN_IN_METHOD="twitter.com";Vn.PROVIDER_ID="twitter.com";class pr{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,r,o=!1){const h=await Me._fromIdTokenResponse(t,r,o),l=Lh(r);return new pr({user:h,providerId:l,_tokenResponse:r,operationType:e})}static async _forOperation(t,e,r){await t._updateTokensIfNecessary(r,!0);const o=Lh(r);return new pr({user:t,providerId:o,_tokenResponse:r,operationType:e})}}function Lh(i){return i.providerId?i.providerId:"phoneNumber"in i?"phone":null}class No extends tn{constructor(t,e,r,o){super(e.code,e.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,No.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,o){return new No(t,e,r,o)}}function ml(i,t,e,r){return(t==="reauthenticate"?e._getReauthenticationResolver(i):e._getIdTokenResponse(i)).catch(h=>{throw h.code==="auth/multi-factor-auth-required"?No._fromErrorAndOperation(i,h,t,r):h})}async function Jm(i,t,e=!1){const r=await ds(i,t._linkToIdToken(i.auth,await i.getIdToken()),e);return pr._forOperation(i,"link",r)}async function Xm(i,t,e=!1){const{auth:r}=i;if(Oe(r.app))return Promise.reject(_i(r));const o="reauthenticate";try{const h=await ds(i,ml(r,o,t,i),e);X(h.idToken,r,"internal-error");const l=uu(h.idToken);X(l,r,"internal-error");const{sub:m}=l;return X(i.uid===m,r,"user-mismatch"),pr._forOperation(i,o,h)}catch(h){throw h?.code==="auth/user-not-found"&&wn(r,"user-mismatch"),h}}async function Qm(i,t,e=!1){if(Oe(i.app))return Promise.reject(_i(i));const r="signIn",o=await ml(i,r,t),h=await pr._fromIdTokenResponse(i,r,o);return e||await i._updateCurrentUser(h.user),h}function Ym(i,t,e,r){return ue(i).onIdTokenChanged(t,e,r)}function t_(i,t,e){return ue(i).beforeAuthStateChanged(t,e)}const Do="__sak";class _l{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Do,"1"),this.storage.removeItem(Do),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const e_=1e3,n_=10;class gl extends _l{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cl(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const r=this.storage.getItem(e),o=this.localCache[e];r!==o&&t(e,o,r)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((l,m,_)=>{this.notifyListeners(l,_)});return}const r=t.key;e?this.detachListener():this.stopPolling();const o=()=>{const l=this.storage.getItem(r);!e&&this.localCache[r]===l||this.notifyListeners(r,l)},h=this.storage.getItem(r);Nm()&&h!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,n_):o()}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const o of Array.from(r))o(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:r}),!0)})},e_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}gl.type="LOCAL";const i_=gl;class yl extends _l{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}yl.type="SESSION";const vl=yl;function r_(i){return Promise.all(i.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class Jo{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(o=>o.isListeningto(t));if(e)return e;const r=new Jo(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:r,eventType:o,data:h}=e.data,l=this.handlersMap[o];if(!l?.size)return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const m=Array.from(l).map(async v=>v(e.origin,h)),_=await r_(m);e.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:_})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jo.receivers=[];function du(i="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(Math.random()*10);return i+e}class s_{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let h,l;return new Promise((m,_)=>{const v=du("",20);o.port1.start();const A=setTimeout(()=>{_(new Error("unsupported_event"))},r);l={messageChannel:o,onMessage(b){const R=b;if(R.data.eventId===v)switch(R.data.status){case"ack":clearTimeout(A),h=setTimeout(()=>{_(new Error("timeout"))},3e3);break;case"done":clearTimeout(h),m(R.data.response);break;default:clearTimeout(A),clearTimeout(h),_(new Error("invalid_response"));break}}},this.handlers.add(l),o.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:t,eventId:v,data:e},[o.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function Je(){return window}function o_(i){Je().location.href=i}function wl(){return typeof Je().WorkerGlobalScope<"u"&&typeof Je().importScripts=="function"}async function a_(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function u_(){return navigator?.serviceWorker?.controller||null}function h_(){return wl()?self:null}const Tl="firebaseLocalStorageDb",c_=1,Mo="firebaseLocalStorage",El="fbase_key";class Is{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Xo(i,t){return i.transaction([Mo],t?"readwrite":"readonly").objectStore(Mo)}function l_(){const i=indexedDB.deleteDatabase(Tl);return new Is(i).toPromise()}function Ua(){const i=indexedDB.open(Tl,c_);return new Promise((t,e)=>{i.addEventListener("error",()=>{e(i.error)}),i.addEventListener("upgradeneeded",()=>{const r=i.result;try{r.createObjectStore(Mo,{keyPath:El})}catch(o){e(o)}}),i.addEventListener("success",async()=>{const r=i.result;r.objectStoreNames.contains(Mo)?t(r):(r.close(),await l_(),t(await Ua()))})})}async function Oh(i,t,e){const r=Xo(i,!0).put({[El]:t,value:e});return new Is(r).toPromise()}async function d_(i,t){const e=Xo(i,!1).get(t),r=await new Is(e).toPromise();return r===void 0?null:r.value}function Nh(i,t){const e=Xo(i,!0).delete(t);return new Is(e).toPromise()}const f_=800,p_=3;class Il{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ua(),this.db)}async _withRetries(t){let e=0;for(;;)try{const r=await this._openDb();return await t(r)}catch(r){if(e++>p_)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wl()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jo._getInstance(h_()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await a_(),!this.activeServiceWorker)return;this.sender=new s_(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||u_()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await Ua();return await Oh(t,Do,"1"),await Nh(t,Do),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(r=>Oh(r,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(r=>d_(r,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>Nh(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(o=>{const h=Xo(o,!1).getAll();return new Is(h).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],r=new Set;if(t.length!==0)for(const{fbase_key:o,value:h}of t)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(h)&&(this.notifyListeners(o,h),e.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),e.push(o));return e}notifyListeners(t,e){this.localCache[t]=e;const r=this.listeners[t];if(r)for(const o of Array.from(r))o(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Il.type="LOCAL";const m_=Il;new Ts(3e4,6e4);function __(i,t){return t?_n(t):(X(i._popupRedirectResolver,i,"argument-error"),i._popupRedirectResolver)}class fu extends fl{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return cr(t,this._buildIdpRequest())}_linkToIdToken(t,e){return cr(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return cr(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function g_(i){return Qm(i.auth,new fu(i),i.bypassAuthState)}function y_(i){const{auth:t,user:e}=i;return X(e,t,"internal-error"),Xm(e,new fu(i),i.bypassAuthState)}async function v_(i){const{auth:t,user:e}=i;return X(e,t,"internal-error"),Jm(e,new fu(i),i.bypassAuthState)}class Al{constructor(t,e,r,o,h=!1){this.auth=t,this.resolver=r,this.user=o,this.bypassAuthState=h,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:r,postBody:o,tenantId:h,error:l,type:m}=t;if(l){this.reject(l);return}const _={auth:this.auth,requestUri:e,sessionId:r,tenantId:h||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(_))}catch(v){this.reject(v)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return g_;case"linkViaPopup":case"linkViaRedirect":return v_;case"reauthViaPopup":case"reauthViaRedirect":return y_;default:wn(this.auth,"internal-error")}}resolve(t){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Tn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const w_=new Ts(2e3,1e4);class ar extends Al{constructor(t,e,r,o,h){super(t,e,o,h),this.provider=r,this.authWindow=null,this.pollId=null,ar.currentPopupAction&&ar.currentPopupAction.cancel(),ar.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return X(t,this.auth,"internal-error"),t}async onExecution(){Tn(this.filter.length===1,"Popup operations only handle one event");const t=du();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject($e(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject($e(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ar.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($e(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,w_.get())};t()}}ar.currentPopupAction=null;const T_="pendingRedirect",Eo=new Map;class E_ extends Al{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}async execute(){let t=Eo.get(this.auth._key());if(!t){try{const r=await I_(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(r)}catch(e){t=()=>Promise.reject(e)}Eo.set(this.auth._key(),t)}return this.bypassAuthState||Eo.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function I_(i,t){const e=b_(t),r=P_(i);if(!await r._isAvailable())return!1;const o=await r._get(e)==="true";return await r._remove(e),o}function A_(i,t){Eo.set(i._key(),t)}function P_(i){return _n(i._redirectPersistence)}function b_(i){return To(T_,i.config.apiKey,i.name)}async function S_(i,t,e=!1){if(Oe(i.app))return Promise.reject(_i(i));const r=cu(i),o=__(r,t),l=await new E_(r,o,e).execute();return l&&!e&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,t)),l}const C_=600*1e3;class R_{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!k_(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!Pl(t)){const r=t.error.code?.split("auth/")[1]||"internal-error";e.onError($e(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=C_&&this.cachedEventUids.clear(),this.cachedEventUids.has(Dh(t))}saveEventToCache(t){this.cachedEventUids.add(Dh(t)),this.lastProcessedEventTime=Date.now()}}function Dh(i){return[i.type,i.eventId,i.sessionId,i.tenantId].filter(t=>t).join("-")}function Pl({type:i,error:t}){return i==="unknown"&&t?.code==="auth/no-auth-event"}function k_(i){switch(i.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pl(i);default:return!1}}async function x_(i,t={}){return wr(i,"GET","/v1/projects",t)}const L_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,O_=/^https?/;async function N_(i){if(i.config.emulator)return;const{authorizedDomains:t}=await x_(i);for(const e of t)try{if(D_(e))return}catch{}wn(i,"unauthorized-domain")}function D_(i){const t=Va(),{protocol:e,hostname:r}=new URL(t);if(i.startsWith("chrome-extension://")){const l=new URL(i);return l.hostname===""&&r===""?e==="chrome-extension:"&&i.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&l.hostname===r}if(!O_.test(e))return!1;if(L_.test(i))return r===i;const o=i.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}const M_=new Ts(3e4,6e4);function Mh(){const i=Je().___jsl;if(i?.H){for(const t of Object.keys(i.H))if(i.H[t].r=i.H[t].r||[],i.H[t].L=i.H[t].L||[],i.H[t].r=[...i.H[t].L],i.CP)for(let e=0;e<i.CP.length;e++)i.CP[e]=null}}function V_(i){return new Promise((t,e)=>{function r(){Mh(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Mh(),e($e(i,"network-request-failed"))},timeout:M_.get()})}if(Je().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(Je().gapi?.load)r();else{const o=jm("iframefcb");return Je()[o]=()=>{gapi.load?r():e($e(i,"network-request-failed"))},zm(`${Hm()}?onload=${o}`).catch(h=>e(h))}}).catch(t=>{throw Io=null,t})}let Io=null;function B_(i){return Io=Io||V_(i),Io}const U_=new Ts(5e3,15e3),F_="__/auth/iframe",z_="emulator/auth/iframe",H_={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},j_=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function W_(i){const t=i.config;X(t.authDomain,i,"auth-domain-config-required");const e=t.emulator?ou(t,z_):`https://${i.config.authDomain}/${F_}`,r={apiKey:t.apiKey,appName:i.name,v:Ci},o=j_.get(i.config.apiHost);o&&(r.eid=o);const h=i._getFrameworks();return h.length&&(r.fw=h.join(",")),`${e}?${ws(r).slice(1)}`}async function q_(i){const t=await B_(i),e=Je().gapi;return X(e,i,"internal-error"),t.open({where:document.body,url:W_(i),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:H_,dontclear:!0},r=>new Promise(async(o,h)=>{await r.restyle({setHideOnLeave:!1});const l=$e(i,"network-request-failed"),m=Je().setTimeout(()=>{h(l)},U_.get());function _(){Je().clearTimeout(m),o(r)}r.ping(_).then(_,()=>{h(l)})}))}const Z_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G_=500,K_=600,$_="_blank",J_="http://localhost";class Vh{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function X_(i,t,e,r=G_,o=K_){const h=Math.max((window.screen.availHeight-o)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let m="";const _={...Z_,width:r.toString(),height:o.toString(),top:h,left:l},v=ne().toLowerCase();e&&(m=sl(v)?$_:e),il(v)&&(t=t||J_,_.scrollbars="yes");const A=Object.entries(_).reduce((R,[U,z])=>`${R}${U}=${z},`,"");if(Om(v)&&m!=="_self")return Q_(t||"",m),new Vh(null);const b=window.open(t||"",m,A);X(b,i,"popup-blocked");try{b.focus()}catch{}return new Vh(b)}function Q_(i,t){const e=document.createElement("a");e.href=i,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}const Y_="__/auth/handler",tg="emulator/auth/handler",eg=encodeURIComponent("fac");async function Bh(i,t,e,r,o,h){X(i.config.authDomain,i,"auth-domain-config-required"),X(i.config.apiKey,i,"invalid-api-key");const l={apiKey:i.config.apiKey,appName:i.name,authType:e,redirectUrl:r,v:Ci,eventId:o};if(t instanceof pl){t.setDefaultLanguage(i.languageCode),l.providerId=t.providerId||"",ep(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[A,b]of Object.entries({}))l[A]=b}if(t instanceof Es){const A=t.getScopes().filter(b=>b!=="");A.length>0&&(l.scopes=A.join(","))}i.tenantId&&(l.tid=i.tenantId);const m=l;for(const A of Object.keys(m))m[A]===void 0&&delete m[A];const _=await i._getAppCheckToken(),v=_?`#${eg}=${encodeURIComponent(_)}`:"";return`${ng(i)}?${ws(m).slice(1)}${v}`}function ng({config:i}){return i.emulator?ou(i,tg):`https://${i.authDomain}/${Y_}`}const Pa="webStorageSupport";class ig{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vl,this._completeRedirectFn=S_,this._overrideRedirectResult=A_}async _openPopup(t,e,r,o){Tn(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const h=await Bh(t,e,r,Va(),o);return X_(t,h,du())}async _openRedirect(t,e,r,o){await this._originValidation(t);const h=await Bh(t,e,r,Va(),o);return o_(h),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:o,promise:h}=this.eventManagers[e];return o?Promise.resolve(o):(Tn(h,"If manager is not set, promise should be"),h)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}async initAndGetManager(t){const e=await q_(t),r=new R_(t);return e.register("authEvent",o=>(X(o?.authEvent,t,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=e,r}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Pa,{type:Pa},o=>{const h=o?.[0]?.[Pa];h!==void 0&&e(!!h),wn(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=N_(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return cl()||rl()||hu()}}const rg=ig;var Uh="@firebase/auth",Fh="1.12.0";class sg{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{t(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){X(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function og(i){switch(i){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ag(i){Ti(new jn("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),o=t.getProvider("heartbeat"),h=t.getProvider("app-check-internal"),{apiKey:l,authDomain:m}=r.options;X(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const _={apiKey:l,authDomain:m,clientPlatform:i,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ll(i)},v=new Um(r,o,h,_);return qm(v,e),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Ti(new jn("auth-internal",t=>{const e=cu(t.getProvider("auth").getImmediate());return(r=>new sg(r))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ke(Uh,Fh,og(i)),Ke(Uh,Fh,"esm2020")}const ug=300,hg=Hc("authIdTokenMaxAge")||ug;let zh=null;const cg=i=>async t=>{const e=t&&await t.getIdTokenResult(),r=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(r&&r>hg)return;const o=e?.token;zh!==o&&(zh=o,await fetch(i,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function lg(i=ru()){const t=$o(i,"auth");if(t.isInitialized())return t.getImmediate();const e=Wm(i,{popupRedirectResolver:rg,persistence:[m_,i_,vl]}),r=Hc("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const h=new URL(r,location.origin);if(location.origin===h.origin){const l=cg(h.toString());t_(e,l,()=>l(e.currentUser)),Ym(e,m=>l(m))}}const o=Uc("auth");return o&&Zm(e,`http://${o}`),e}function dg(){return document.getElementsByTagName("head")?.[0]??document}Fm({loadJS(i){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",i),r.onload=t,r.onerror=o=>{const h=$e("internal-error");h.customData=o,e(h)},r.type="text/javascript",r.charset="UTF-8",dg().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ag("Browser");const bl="firebasestorage.googleapis.com",Sl="storageBucket",fg=120*1e3,pg=600*1e3;class Lt extends tn{constructor(t,e,r=0){super(ba(t),`Firebase Storage: ${e} (${ba(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Lt.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return ba(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var xt;(function(i){i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(xt||(xt={}));function ba(i){return"storage/"+i}function pu(){const i="An unknown error occurred, please check the error payload for server response.";return new Lt(xt.UNKNOWN,i)}function mg(i){return new Lt(xt.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}function _g(i){return new Lt(xt.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function gg(){const i="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Lt(xt.UNAUTHENTICATED,i)}function yg(){return new Lt(xt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function vg(i){return new Lt(xt.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}function wg(){return new Lt(xt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Tg(){return new Lt(xt.CANCELED,"User canceled the upload/download.")}function Eg(i){return new Lt(xt.INVALID_URL,"Invalid URL '"+i+"'.")}function Ig(i){return new Lt(xt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}function Ag(){return new Lt(xt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Sl+"' property when initializing the app?")}function Pg(){return new Lt(xt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function bg(){return new Lt(xt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Sg(i){return new Lt(xt.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Fa(i){return new Lt(xt.INVALID_ARGUMENT,i)}function Cl(){return new Lt(xt.APP_DELETED,"The Firebase app was deleted.")}function Cg(i){return new Lt(xt.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ss(i,t){return new Lt(xt.INVALID_FORMAT,"String does not match format '"+i+"': "+t)}function Qr(i){throw new Lt(xt.INTERNAL_ERROR,"Internal error: "+i)}class ye{constructor(t,e){this.bucket=t,this.path_=e}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,e){let r;try{r=ye.makeFromUrl(t,e)}catch{return new ye(t,"")}if(r.path==="")return r;throw Ig(t)}static makeFromUrl(t,e){let r=null;const o="([A-Za-z0-9.\\-_]+)";function h(dt){dt.path.charAt(dt.path.length-1)==="/"&&(dt.path_=dt.path_.slice(0,-1))}const l="(/(.*))?$",m=new RegExp("^gs://"+o+l,"i"),_={bucket:1,path:3};function v(dt){dt.path_=decodeURIComponent(dt.path)}const A="v[A-Za-z0-9_]+",b=e.replace(/[.]/g,"\\."),R="(/([^?#]*).*)?$",U=new RegExp(`^https?://${b}/${A}/b/${o}/o${R}`,"i"),z={bucket:1,path:3},H=e===bl?"(?:storage.googleapis.com|storage.cloud.google.com)":e,G="([^?#]*)",at=new RegExp(`^https?://${H}/${o}/${G}`,"i"),et=[{regex:m,indices:_,postModify:h},{regex:U,indices:z,postModify:v},{regex:at,indices:{bucket:1,path:2},postModify:v}];for(let dt=0;dt<et.length;dt++){const Bt=et[dt],Ct=Bt.regex.exec(t);if(Ct){const S=Ct[Bt.indices.bucket];let w=Ct[Bt.indices.path];w||(w=""),r=new ye(S,w),Bt.postModify(r);break}}if(r==null)throw Eg(t);return r}}class Rg{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}function kg(i,t,e){let r=1,o=null,h=null,l=!1,m=0;function _(){return m===2}let v=!1;function A(...G){v||(v=!0,t.apply(null,G))}function b(G){o=setTimeout(()=>{o=null,i(U,_())},G)}function R(){h&&clearTimeout(h)}function U(G,...at){if(v){R();return}if(G){R(),A.call(null,G,...at);return}if(_()||l){R(),A.call(null,G,...at);return}r<64&&(r*=2);let et;m===1?(m=2,et=0):et=(r+Math.random())*1e3,b(et)}let z=!1;function H(G){z||(z=!0,R(),!v&&(o!==null?(G||(m=2),clearTimeout(o),b(0)):G||(m=1)))}return b(0),h=setTimeout(()=>{l=!0,H(!0)},e),H}function xg(i){i(!1)}function Lg(i){return i!==void 0}function Og(i){return typeof i=="object"&&!Array.isArray(i)}function mu(i){return typeof i=="string"||i instanceof String}function Hh(i){return _u()&&i instanceof Blob}function _u(){return typeof Blob<"u"}function jh(i,t,e,r){if(r<t)throw Fa(`Invalid value for '${i}'. Expected ${t} or greater.`);if(r>e)throw Fa(`Invalid value for '${i}'. Expected ${e} or less.`)}function gu(i,t,e){let r=t;return e==null&&(r=`https://${t}`),`${e}://${r}/v0${i}`}function Rl(i){const t=encodeURIComponent;let e="?";for(const r in i)if(i.hasOwnProperty(r)){const o=t(r)+"="+t(i[r]);e=e+o+"&"}return e=e.slice(0,-1),e}var gi;(function(i){i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT"})(gi||(gi={}));function Ng(i,t){const e=i>=500&&i<600,o=[408,429].indexOf(i)!==-1,h=t.indexOf(i)!==-1;return e||o||h}class Dg{constructor(t,e,r,o,h,l,m,_,v,A,b,R=!0,U=!1){this.url_=t,this.method_=e,this.headers_=r,this.body_=o,this.successCodes_=h,this.additionalRetryCodes_=l,this.callback_=m,this.errorCallback_=_,this.timeout_=v,this.progressCallback_=A,this.connectionFactory_=b,this.retry=R,this.isUsingEmulator=U,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((z,H)=>{this.resolve_=z,this.reject_=H,this.start_()})}start_(){const t=(r,o)=>{if(o){r(!1,new lo(!1,null,!0));return}const h=this.connectionFactory_();this.pendingConnection_=h;const l=m=>{const _=m.loaded,v=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(_,v)};this.progressCallback_!==null&&h.addUploadProgressListener(l),h.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&h.removeUploadProgressListener(l),this.pendingConnection_=null;const m=h.getErrorCode()===gi.NO_ERROR,_=h.getStatus();if(!m||Ng(_,this.additionalRetryCodes_)&&this.retry){const A=h.getErrorCode()===gi.ABORT;r(!1,new lo(!1,null,A));return}const v=this.successCodes_.indexOf(_)!==-1;r(!0,new lo(v,h))})},e=(r,o)=>{const h=this.resolve_,l=this.reject_,m=o.connection;if(o.wasSuccessCode)try{const _=this.callback_(m,m.getResponse());Lg(_)?h(_):h()}catch(_){l(_)}else if(m!==null){const _=pu();_.serverResponse=m.getErrorText(),this.errorCallback_?l(this.errorCallback_(m,_)):l(_)}else if(o.canceled){const _=this.appDelete_?Cl():Tg();l(_)}else{const _=wg();l(_)}};this.canceled_?e(!1,new lo(!1,null,!0)):this.backoffId_=kg(t,e,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&xg(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class lo{constructor(t,e,r){this.wasSuccessCode=t,this.connection=e,this.canceled=!!r}}function Mg(i,t){t!==null&&t.length>0&&(i.Authorization="Firebase "+t)}function Vg(i,t){i["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function Bg(i,t){t&&(i["X-Firebase-GMPID"]=t)}function Ug(i,t){t!==null&&(i["X-Firebase-AppCheck"]=t)}function Fg(i,t,e,r,o,h,l=!0,m=!1){const _=Rl(i.urlParams),v=i.url+_,A=Object.assign({},i.headers);return Bg(A,t),Mg(A,e),Vg(A,h),Ug(A,r),new Dg(v,i.method,A,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,o,l,m)}function zg(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Hg(...i){const t=zg();if(t!==void 0){const e=new t;for(let r=0;r<i.length;r++)e.append(i[r]);return e.getBlob()}else{if(_u())return new Blob(i);throw new Lt(xt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function jg(i,t,e){return i.webkitSlice?i.webkitSlice(t,e):i.mozSlice?i.mozSlice(t,e):i.slice?i.slice(t,e):null}function Wg(i){if(typeof atob>"u")throw Sg("base-64");return atob(i)}const Ge={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Sa{constructor(t,e){this.data=t,this.contentType=e||null}}function qg(i,t){switch(i){case Ge.RAW:return new Sa(kl(t));case Ge.BASE64:case Ge.BASE64URL:return new Sa(xl(i,t));case Ge.DATA_URL:return new Sa(Gg(t),Kg(t))}throw pu()}function kl(i){const t=[];for(let e=0;e<i.length;e++){let r=i.charCodeAt(e);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(e<i.length-1&&(i.charCodeAt(e+1)&64512)===56320))t.push(239,191,189);else{const h=r,l=i.charCodeAt(++e);r=65536|(h&1023)<<10|l&1023,t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(t)}function Zg(i){let t;try{t=decodeURIComponent(i)}catch{throw ss(Ge.DATA_URL,"Malformed data URL.")}return kl(t)}function xl(i,t){switch(i){case Ge.BASE64:{const o=t.indexOf("-")!==-1,h=t.indexOf("_")!==-1;if(o||h)throw ss(i,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Ge.BASE64URL:{const o=t.indexOf("+")!==-1,h=t.indexOf("/")!==-1;if(o||h)throw ss(i,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let e;try{e=Wg(t)}catch(o){throw o.message.includes("polyfill")?o:ss(i,"Invalid character found")}const r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return r}class Ll{constructor(t){this.base64=!1,this.contentType=null;const e=t.match(/^data:([^,]+)?,/);if(e===null)throw ss(Ge.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=e[1]||null;r!=null&&(this.base64=$g(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}function Gg(i){const t=new Ll(i);return t.base64?xl(Ge.BASE64,t.rest):Zg(t.rest)}function Kg(i){return new Ll(i).contentType}function $g(i,t){return i.length>=t.length?i.substring(i.length-t.length)===t:!1}class Bn{constructor(t,e){let r=0,o="";Hh(t)?(this.data_=t,r=t.size,o=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=o}size(){return this.size_}type(){return this.type_}slice(t,e){if(Hh(this.data_)){const r=this.data_,o=jg(r,t,e);return o===null?null:new Bn(o)}else{const r=new Uint8Array(this.data_.buffer,t,e-t);return new Bn(r,!0)}}static getBlob(...t){if(_u()){const e=t.map(r=>r instanceof Bn?r.data_:r);return new Bn(Hg.apply(null,e))}else{const e=t.map(l=>mu(l)?qg(Ge.RAW,l).data:l.data_);let r=0;e.forEach(l=>{r+=l.byteLength});const o=new Uint8Array(r);let h=0;return e.forEach(l=>{for(let m=0;m<l.length;m++)o[h++]=l[m]}),new Bn(o,!0)}}uploadData(){return this.data_}}function Ol(i){let t;try{t=JSON.parse(i)}catch{return null}return Og(t)?t:null}function Jg(i){if(i.length===0)return null;const t=i.lastIndexOf("/");return t===-1?"":i.slice(0,t)}function Xg(i,t){const e=t.split("/").filter(r=>r.length>0).join("/");return i.length===0?e:i+"/"+e}function Nl(i){const t=i.lastIndexOf("/",i.length-2);return t===-1?i:i.slice(t+1)}function Qg(i,t){return t}class ae{constructor(t,e,r,o){this.server=t,this.local=e||t,this.writable=!!r,this.xform=o||Qg}}let fo=null;function Yg(i){return!mu(i)||i.length<2?i:Nl(i)}function Dl(){if(fo)return fo;const i=[];i.push(new ae("bucket")),i.push(new ae("generation")),i.push(new ae("metageneration")),i.push(new ae("name","fullPath",!0));function t(h,l){return Yg(l)}const e=new ae("name");e.xform=t,i.push(e);function r(h,l){return l!==void 0?Number(l):l}const o=new ae("size");return o.xform=r,i.push(o),i.push(new ae("timeCreated")),i.push(new ae("updated")),i.push(new ae("md5Hash",null,!0)),i.push(new ae("cacheControl",null,!0)),i.push(new ae("contentDisposition",null,!0)),i.push(new ae("contentEncoding",null,!0)),i.push(new ae("contentLanguage",null,!0)),i.push(new ae("contentType",null,!0)),i.push(new ae("metadata","customMetadata",!0)),fo=i,fo}function ty(i,t){function e(){const r=i.bucket,o=i.fullPath,h=new ye(r,o);return t._makeStorageReference(h)}Object.defineProperty(i,"ref",{get:e})}function ey(i,t,e){const r={};r.type="file";const o=e.length;for(let h=0;h<o;h++){const l=e[h];r[l.local]=l.xform(r,t[l.server])}return ty(r,i),r}function Ml(i,t,e){const r=Ol(t);return r===null?null:ey(i,r,e)}function ny(i,t,e,r){const o=Ol(t);if(o===null||!mu(o.downloadTokens))return null;const h=o.downloadTokens;if(h.length===0)return null;const l=encodeURIComponent;return h.split(",").map(v=>{const A=i.bucket,b=i.fullPath,R="/b/"+l(A)+"/o/"+l(b),U=gu(R,e,r),z=Rl({alt:"media",token:v});return U+z})[0]}function iy(i,t){const e={},r=t.length;for(let o=0;o<r;o++){const h=t[o];h.writable&&(e[h.server]=i[h.local])}return JSON.stringify(e)}class Vl{constructor(t,e,r,o){this.url=t,this.method=e,this.handler=r,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Bl(i){if(!i)throw pu()}function ry(i,t){function e(r,o){const h=Ml(i,o,t);return Bl(h!==null),h}return e}function sy(i,t){function e(r,o){const h=Ml(i,o,t);return Bl(h!==null),ny(h,o,i.host,i._protocol)}return e}function Ul(i){function t(e,r){let o;return e.getStatus()===401?e.getErrorText().includes("Firebase App Check token is invalid")?o=yg():o=gg():e.getStatus()===402?o=_g(i.bucket):e.getStatus()===403?o=vg(i.path):o=r,o.status=e.getStatus(),o.serverResponse=r.serverResponse,o}return t}function oy(i){const t=Ul(i);function e(r,o){let h=t(r,o);return r.getStatus()===404&&(h=mg(i.path)),h.serverResponse=o.serverResponse,h}return e}function ay(i,t,e){const r=t.fullServerUrl(),o=gu(r,i.host,i._protocol),h="GET",l=i.maxOperationRetryTime,m=new Vl(o,h,sy(i,e),l);return m.errorHandler=oy(t),m}function uy(i,t){return i&&i.contentType||t&&t.type()||"application/octet-stream"}function hy(i,t,e){const r=Object.assign({},e);return r.fullPath=i.path,r.size=t.size(),r.contentType||(r.contentType=uy(null,t)),r}function cy(i,t,e,r,o){const h=t.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function m(){let et="";for(let dt=0;dt<2;dt++)et=et+Math.random().toString().slice(2);return et}const _=m();l["Content-Type"]="multipart/related; boundary="+_;const v=hy(t,r,o),A=iy(v,e),b="--"+_+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+A+`\r
--`+_+`\r
Content-Type: `+v.contentType+`\r
\r
`,R=`\r
--`+_+"--",U=Bn.getBlob(b,r,R);if(U===null)throw Pg();const z={name:v.fullPath},H=gu(h,i.host,i._protocol),G="POST",at=i.maxUploadRetryTime,ut=new Vl(H,G,ry(i,e),at);return ut.urlParams=z,ut.headers=l,ut.body=U.uploadData(),ut.errorHandler=Ul(t),ut}class ly{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=gi.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=gi.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=gi.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,e,r,o,h){if(this.sent_)throw Qr("cannot .send() more than once");if(Kn(t)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(e,t,!0),h!==void 0)for(const l in h)h.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,h[l].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Qr("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Qr("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Qr("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Qr("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class dy extends ly{initXhr(){this.xhr_.responseType="text"}}function Fl(){return new dy}class Ii{constructor(t,e){this._service=t,e instanceof ye?this._location=e:this._location=ye.makeFromUrl(e,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,e){return new Ii(t,e)}get root(){const t=new ye(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Nl(this._location.path)}get storage(){return this._service}get parent(){const t=Jg(this._location.path);if(t===null)return null;const e=new ye(this._location.bucket,t);return new Ii(this._service,e)}_throwIfRoot(t){if(this._location.path==="")throw Cg(t)}}function fy(i,t,e){i._throwIfRoot("uploadBytes");const r=cy(i.storage,i._location,Dl(),new Bn(t,!0),e);return i.storage.makeRequestWithTokens(r,Fl).then(o=>({metadata:o,ref:i}))}function py(i){i._throwIfRoot("getDownloadURL");const t=ay(i.storage,i._location,Dl());return i.storage.makeRequestWithTokens(t,Fl).then(e=>{if(e===null)throw bg();return e})}function my(i,t){const e=Xg(i._location.path,t),r=new ye(i._location.bucket,e);return new Ii(i.storage,r)}function _y(i){return/^[A-Za-z]+:\/\//.test(i)}function gy(i,t){return new Ii(i,t)}function zl(i,t){if(i instanceof yu){const e=i;if(e._bucket==null)throw Ag();const r=new Ii(e,e._bucket);return t!=null?zl(r,t):r}else return t!==void 0?my(i,t):i}function yy(i,t){if(t&&_y(t)){if(i instanceof yu)return gy(i,t);throw Fa("To use ref(service, url), the first argument must be a Storage instance.")}else return zl(i,t)}function Wh(i,t){const e=t?.[Sl];return e==null?null:ye.makeFromBucketSpec(e,i)}function vy(i,t,e,r={}){i.host=`${t}:${e}`;const o=Kn(t);o&&(tu(`https://${i.host}/b`),eu("Storage",!0)),i._isUsingEmulator=!0,i._protocol=o?"https":"http";const{mockUserToken:h}=r;h&&(i._overrideAuthToken=typeof h=="string"?h:jc(h,i.app.options.projectId))}class yu{constructor(t,e,r,o,h,l=!1){this.app=t,this._authProvider=e,this._appCheckProvider=r,this._url=o,this._firebaseVersion=h,this._isUsingEmulator=l,this._bucket=null,this._host=bl,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=fg,this._maxUploadRetryTime=pg,this._requests=new Set,o!=null?this._bucket=ye.makeFromBucketSpec(o,this._host):this._bucket=Wh(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=ye.makeFromBucketSpec(this._url,t):this._bucket=Wh(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){jh("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){jh("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const e=await t.getToken();if(e!==null)return e.accessToken}return null}async _getAppCheckToken(){if(Oe(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Ii(this,t)}_makeRequest(t,e,r,o,h=!0){if(this._deleted)return new Rg(Cl());{const l=Fg(t,this._appId,r,o,e,this._firebaseVersion,h,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,e){const[r,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,e,r,o).getPromise()}}const qh="@firebase/storage",Zh="0.14.0";const Hl="storage";function wy(i,t,e){return i=ue(i),fy(i,t,e)}function Ty(i){return i=ue(i),py(i)}function Ey(i,t){return i=ue(i),yy(i,t)}function Iy(i=ru(),t){i=ue(i);const r=$o(i,Hl).getImmediate({identifier:t}),o=Fc("storage");return o&&Ay(r,...o),r}function Ay(i,t,e,r={}){vy(i,t,e,r)}function Py(i,{instanceIdentifier:t}){const e=i.getProvider("app").getImmediate(),r=i.getProvider("auth-internal"),o=i.getProvider("app-check-internal");return new yu(e,r,o,t,Ci)}function by(){Ti(new jn(Hl,Py,"PUBLIC").setMultipleInstances(!0)),Ke(qh,Zh,""),Ke(qh,Zh,"esm2020")}by();var Gh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var vu;(function(){var i;function t(S,w){function I(){}I.prototype=w.prototype,S.F=w.prototype,S.prototype=new I,S.prototype.constructor=S,S.D=function(C,P,k){for(var E=Array(arguments.length-2),At=2;At<arguments.length;At++)E[At-2]=arguments[At];return w.prototype[P].apply(C,E)}}function e(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,e),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(S,w,I){I||(I=0);const C=Array(16);if(typeof w=="string")for(var P=0;P<16;++P)C[P]=w.charCodeAt(I++)|w.charCodeAt(I++)<<8|w.charCodeAt(I++)<<16|w.charCodeAt(I++)<<24;else for(P=0;P<16;++P)C[P]=w[I++]|w[I++]<<8|w[I++]<<16|w[I++]<<24;w=S.g[0],I=S.g[1],P=S.g[2];let k=S.g[3],E;E=w+(k^I&(P^k))+C[0]+3614090360&4294967295,w=I+(E<<7&4294967295|E>>>25),E=k+(P^w&(I^P))+C[1]+3905402710&4294967295,k=w+(E<<12&4294967295|E>>>20),E=P+(I^k&(w^I))+C[2]+606105819&4294967295,P=k+(E<<17&4294967295|E>>>15),E=I+(w^P&(k^w))+C[3]+3250441966&4294967295,I=P+(E<<22&4294967295|E>>>10),E=w+(k^I&(P^k))+C[4]+4118548399&4294967295,w=I+(E<<7&4294967295|E>>>25),E=k+(P^w&(I^P))+C[5]+1200080426&4294967295,k=w+(E<<12&4294967295|E>>>20),E=P+(I^k&(w^I))+C[6]+2821735955&4294967295,P=k+(E<<17&4294967295|E>>>15),E=I+(w^P&(k^w))+C[7]+4249261313&4294967295,I=P+(E<<22&4294967295|E>>>10),E=w+(k^I&(P^k))+C[8]+1770035416&4294967295,w=I+(E<<7&4294967295|E>>>25),E=k+(P^w&(I^P))+C[9]+2336552879&4294967295,k=w+(E<<12&4294967295|E>>>20),E=P+(I^k&(w^I))+C[10]+4294925233&4294967295,P=k+(E<<17&4294967295|E>>>15),E=I+(w^P&(k^w))+C[11]+2304563134&4294967295,I=P+(E<<22&4294967295|E>>>10),E=w+(k^I&(P^k))+C[12]+1804603682&4294967295,w=I+(E<<7&4294967295|E>>>25),E=k+(P^w&(I^P))+C[13]+4254626195&4294967295,k=w+(E<<12&4294967295|E>>>20),E=P+(I^k&(w^I))+C[14]+2792965006&4294967295,P=k+(E<<17&4294967295|E>>>15),E=I+(w^P&(k^w))+C[15]+1236535329&4294967295,I=P+(E<<22&4294967295|E>>>10),E=w+(P^k&(I^P))+C[1]+4129170786&4294967295,w=I+(E<<5&4294967295|E>>>27),E=k+(I^P&(w^I))+C[6]+3225465664&4294967295,k=w+(E<<9&4294967295|E>>>23),E=P+(w^I&(k^w))+C[11]+643717713&4294967295,P=k+(E<<14&4294967295|E>>>18),E=I+(k^w&(P^k))+C[0]+3921069994&4294967295,I=P+(E<<20&4294967295|E>>>12),E=w+(P^k&(I^P))+C[5]+3593408605&4294967295,w=I+(E<<5&4294967295|E>>>27),E=k+(I^P&(w^I))+C[10]+38016083&4294967295,k=w+(E<<9&4294967295|E>>>23),E=P+(w^I&(k^w))+C[15]+3634488961&4294967295,P=k+(E<<14&4294967295|E>>>18),E=I+(k^w&(P^k))+C[4]+3889429448&4294967295,I=P+(E<<20&4294967295|E>>>12),E=w+(P^k&(I^P))+C[9]+568446438&4294967295,w=I+(E<<5&4294967295|E>>>27),E=k+(I^P&(w^I))+C[14]+3275163606&4294967295,k=w+(E<<9&4294967295|E>>>23),E=P+(w^I&(k^w))+C[3]+4107603335&4294967295,P=k+(E<<14&4294967295|E>>>18),E=I+(k^w&(P^k))+C[8]+1163531501&4294967295,I=P+(E<<20&4294967295|E>>>12),E=w+(P^k&(I^P))+C[13]+2850285829&4294967295,w=I+(E<<5&4294967295|E>>>27),E=k+(I^P&(w^I))+C[2]+4243563512&4294967295,k=w+(E<<9&4294967295|E>>>23),E=P+(w^I&(k^w))+C[7]+1735328473&4294967295,P=k+(E<<14&4294967295|E>>>18),E=I+(k^w&(P^k))+C[12]+2368359562&4294967295,I=P+(E<<20&4294967295|E>>>12),E=w+(I^P^k)+C[5]+4294588738&4294967295,w=I+(E<<4&4294967295|E>>>28),E=k+(w^I^P)+C[8]+2272392833&4294967295,k=w+(E<<11&4294967295|E>>>21),E=P+(k^w^I)+C[11]+1839030562&4294967295,P=k+(E<<16&4294967295|E>>>16),E=I+(P^k^w)+C[14]+4259657740&4294967295,I=P+(E<<23&4294967295|E>>>9),E=w+(I^P^k)+C[1]+2763975236&4294967295,w=I+(E<<4&4294967295|E>>>28),E=k+(w^I^P)+C[4]+1272893353&4294967295,k=w+(E<<11&4294967295|E>>>21),E=P+(k^w^I)+C[7]+4139469664&4294967295,P=k+(E<<16&4294967295|E>>>16),E=I+(P^k^w)+C[10]+3200236656&4294967295,I=P+(E<<23&4294967295|E>>>9),E=w+(I^P^k)+C[13]+681279174&4294967295,w=I+(E<<4&4294967295|E>>>28),E=k+(w^I^P)+C[0]+3936430074&4294967295,k=w+(E<<11&4294967295|E>>>21),E=P+(k^w^I)+C[3]+3572445317&4294967295,P=k+(E<<16&4294967295|E>>>16),E=I+(P^k^w)+C[6]+76029189&4294967295,I=P+(E<<23&4294967295|E>>>9),E=w+(I^P^k)+C[9]+3654602809&4294967295,w=I+(E<<4&4294967295|E>>>28),E=k+(w^I^P)+C[12]+3873151461&4294967295,k=w+(E<<11&4294967295|E>>>21),E=P+(k^w^I)+C[15]+530742520&4294967295,P=k+(E<<16&4294967295|E>>>16),E=I+(P^k^w)+C[2]+3299628645&4294967295,I=P+(E<<23&4294967295|E>>>9),E=w+(P^(I|~k))+C[0]+4096336452&4294967295,w=I+(E<<6&4294967295|E>>>26),E=k+(I^(w|~P))+C[7]+1126891415&4294967295,k=w+(E<<10&4294967295|E>>>22),E=P+(w^(k|~I))+C[14]+2878612391&4294967295,P=k+(E<<15&4294967295|E>>>17),E=I+(k^(P|~w))+C[5]+4237533241&4294967295,I=P+(E<<21&4294967295|E>>>11),E=w+(P^(I|~k))+C[12]+1700485571&4294967295,w=I+(E<<6&4294967295|E>>>26),E=k+(I^(w|~P))+C[3]+2399980690&4294967295,k=w+(E<<10&4294967295|E>>>22),E=P+(w^(k|~I))+C[10]+4293915773&4294967295,P=k+(E<<15&4294967295|E>>>17),E=I+(k^(P|~w))+C[1]+2240044497&4294967295,I=P+(E<<21&4294967295|E>>>11),E=w+(P^(I|~k))+C[8]+1873313359&4294967295,w=I+(E<<6&4294967295|E>>>26),E=k+(I^(w|~P))+C[15]+4264355552&4294967295,k=w+(E<<10&4294967295|E>>>22),E=P+(w^(k|~I))+C[6]+2734768916&4294967295,P=k+(E<<15&4294967295|E>>>17),E=I+(k^(P|~w))+C[13]+1309151649&4294967295,I=P+(E<<21&4294967295|E>>>11),E=w+(P^(I|~k))+C[4]+4149444226&4294967295,w=I+(E<<6&4294967295|E>>>26),E=k+(I^(w|~P))+C[11]+3174756917&4294967295,k=w+(E<<10&4294967295|E>>>22),E=P+(w^(k|~I))+C[2]+718787259&4294967295,P=k+(E<<15&4294967295|E>>>17),E=I+(k^(P|~w))+C[9]+3951481745&4294967295,S.g[0]=S.g[0]+w&4294967295,S.g[1]=S.g[1]+(P+(E<<21&4294967295|E>>>11))&4294967295,S.g[2]=S.g[2]+P&4294967295,S.g[3]=S.g[3]+k&4294967295}r.prototype.v=function(S,w){w===void 0&&(w=S.length);const I=w-this.blockSize,C=this.C;let P=this.h,k=0;for(;k<w;){if(P==0)for(;k<=I;)o(this,S,k),k+=this.blockSize;if(typeof S=="string"){for(;k<w;)if(C[P++]=S.charCodeAt(k++),P==this.blockSize){o(this,C),P=0;break}}else for(;k<w;)if(C[P++]=S[k++],P==this.blockSize){o(this,C),P=0;break}}this.h=P,this.o+=w},r.prototype.A=function(){var S=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);S[0]=128;for(var w=1;w<S.length-8;++w)S[w]=0;w=this.o*8;for(var I=S.length-8;I<S.length;++I)S[I]=w&255,w/=256;for(this.v(S),S=Array(16),w=0,I=0;I<4;++I)for(let C=0;C<32;C+=8)S[w++]=this.g[I]>>>C&255;return S};function h(S,w){var I=m;return Object.prototype.hasOwnProperty.call(I,S)?I[S]:I[S]=w(S)}function l(S,w){this.h=w;const I=[];let C=!0;for(let P=S.length-1;P>=0;P--){const k=S[P]|0;C&&k==w||(I[P]=k,C=!1)}this.g=I}var m={};function _(S){return-128<=S&&S<128?h(S,function(w){return new l([w|0],w<0?-1:0)}):new l([S|0],S<0?-1:0)}function v(S){if(isNaN(S)||!isFinite(S))return b;if(S<0)return G(v(-S));const w=[];let I=1;for(let C=0;S>=I;C++)w[C]=S/I|0,I*=4294967296;return new l(w,0)}function A(S,w){if(S.length==0)throw Error("number format error: empty string");if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(S.charAt(0)=="-")return G(A(S.substring(1),w));if(S.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=v(Math.pow(w,8));let C=b;for(let k=0;k<S.length;k+=8){var P=Math.min(8,S.length-k);const E=parseInt(S.substring(k,k+P),w);P<8?(P=v(Math.pow(w,P)),C=C.j(P).add(v(E))):(C=C.j(I),C=C.add(v(E)))}return C}var b=_(0),R=_(1),U=_(16777216);i=l.prototype,i.m=function(){if(H(this))return-G(this).m();let S=0,w=1;for(let I=0;I<this.g.length;I++){const C=this.i(I);S+=(C>=0?C:4294967296+C)*w,w*=4294967296}return S},i.toString=function(S){if(S=S||10,S<2||36<S)throw Error("radix out of range: "+S);if(z(this))return"0";if(H(this))return"-"+G(this).toString(S);const w=v(Math.pow(S,6));var I=this;let C="";for(;;){const P=dt(I,w).g;I=at(I,P.j(w));let k=((I.g.length>0?I.g[0]:I.h)>>>0).toString(S);if(I=P,z(I))return k+C;for(;k.length<6;)k="0"+k;C=k+C}},i.i=function(S){return S<0?0:S<this.g.length?this.g[S]:this.h};function z(S){if(S.h!=0)return!1;for(let w=0;w<S.g.length;w++)if(S.g[w]!=0)return!1;return!0}function H(S){return S.h==-1}i.l=function(S){return S=at(this,S),H(S)?-1:z(S)?0:1};function G(S){const w=S.g.length,I=[];for(let C=0;C<w;C++)I[C]=~S.g[C];return new l(I,~S.h).add(R)}i.abs=function(){return H(this)?G(this):this},i.add=function(S){const w=Math.max(this.g.length,S.g.length),I=[];let C=0;for(let P=0;P<=w;P++){let k=C+(this.i(P)&65535)+(S.i(P)&65535),E=(k>>>16)+(this.i(P)>>>16)+(S.i(P)>>>16);C=E>>>16,k&=65535,E&=65535,I[P]=E<<16|k}return new l(I,I[I.length-1]&-2147483648?-1:0)};function at(S,w){return S.add(G(w))}i.j=function(S){if(z(this)||z(S))return b;if(H(this))return H(S)?G(this).j(G(S)):G(G(this).j(S));if(H(S))return G(this.j(G(S)));if(this.l(U)<0&&S.l(U)<0)return v(this.m()*S.m());const w=this.g.length+S.g.length,I=[];for(var C=0;C<2*w;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(let P=0;P<S.g.length;P++){const k=this.i(C)>>>16,E=this.i(C)&65535,At=S.i(P)>>>16,en=S.i(P)&65535;I[2*C+2*P]+=E*en,ut(I,2*C+2*P),I[2*C+2*P+1]+=k*en,ut(I,2*C+2*P+1),I[2*C+2*P+1]+=E*At,ut(I,2*C+2*P+1),I[2*C+2*P+2]+=k*At,ut(I,2*C+2*P+2)}for(S=0;S<w;S++)I[S]=I[2*S+1]<<16|I[2*S];for(S=w;S<2*w;S++)I[S]=0;return new l(I,0)};function ut(S,w){for(;(S[w]&65535)!=S[w];)S[w+1]+=S[w]>>>16,S[w]&=65535,w++}function et(S,w){this.g=S,this.h=w}function dt(S,w){if(z(w))throw Error("division by zero");if(z(S))return new et(b,b);if(H(S))return w=dt(G(S),w),new et(G(w.g),G(w.h));if(H(w))return w=dt(S,G(w)),new et(G(w.g),w.h);if(S.g.length>30){if(H(S)||H(w))throw Error("slowDivide_ only works with positive integers.");for(var I=R,C=w;C.l(S)<=0;)I=Bt(I),C=Bt(C);var P=Ct(I,1),k=Ct(C,1);for(C=Ct(C,2),I=Ct(I,2);!z(C);){var E=k.add(C);E.l(S)<=0&&(P=P.add(I),k=E),C=Ct(C,1),I=Ct(I,1)}return w=at(S,P.j(w)),new et(P,w)}for(P=b;S.l(w)>=0;){for(I=Math.max(1,Math.floor(S.m()/w.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),k=v(I),E=k.j(w);H(E)||E.l(S)>0;)I-=C,k=v(I),E=k.j(w);z(k)&&(k=R),P=P.add(k),S=at(S,E)}return new et(P,S)}i.B=function(S){return dt(this,S).h},i.and=function(S){const w=Math.max(this.g.length,S.g.length),I=[];for(let C=0;C<w;C++)I[C]=this.i(C)&S.i(C);return new l(I,this.h&S.h)},i.or=function(S){const w=Math.max(this.g.length,S.g.length),I=[];for(let C=0;C<w;C++)I[C]=this.i(C)|S.i(C);return new l(I,this.h|S.h)},i.xor=function(S){const w=Math.max(this.g.length,S.g.length),I=[];for(let C=0;C<w;C++)I[C]=this.i(C)^S.i(C);return new l(I,this.h^S.h)};function Bt(S){const w=S.g.length+1,I=[];for(let C=0;C<w;C++)I[C]=S.i(C)<<1|S.i(C-1)>>>31;return new l(I,S.h)}function Ct(S,w){const I=w>>5;w%=32;const C=S.g.length-I,P=[];for(let k=0;k<C;k++)P[k]=w>0?S.i(k+I)>>>w|S.i(k+I+1)<<32-w:S.i(k+I);return new l(P,S.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=v,l.fromString=A,vu=l}).apply(typeof Gh<"u"?Gh:typeof self<"u"?self:typeof window<"u"?window:{});var po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var jl,es,Wl,Ao,za,ql,Zl,Gl;(function(){var i,t=Object.defineProperty;function e(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof po=="object"&&po];for(var d=0;d<a.length;++d){var p=a[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=e(this);function o(a,d){if(d)t:{var p=r;a=a.split(".");for(var y=0;y<a.length-1;y++){var x=a[y];if(!(x in p))break t;p=p[x]}a=a[a.length-1],y=p[a],d=d(y),d!=y&&d!=null&&t(p,a,{configurable:!0,writable:!0,value:d})}}o("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(a){return a||function(d){var p=[],y;for(y in d)Object.prototype.hasOwnProperty.call(d,y)&&p.push([y,d[y]]);return p}});var h=h||{},l=this||self;function m(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function _(a,d,p){return a.call.apply(a.bind,arguments)}function v(a,d,p){return v=_,v.apply(null,arguments)}function A(a,d){var p=Array.prototype.slice.call(arguments,1);return function(){var y=p.slice();return y.push.apply(y,arguments),a.apply(this,y)}}function b(a,d){function p(){}p.prototype=d.prototype,a.Z=d.prototype,a.prototype=new p,a.prototype.constructor=a,a.Ob=function(y,x,N){for(var F=Array(arguments.length-2),tt=2;tt<arguments.length;tt++)F[tt-2]=arguments[tt];return d.prototype[x].apply(y,F)}}var R=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function U(a){const d=a.length;if(d>0){const p=Array(d);for(let y=0;y<d;y++)p[y]=a[y];return p}return[]}function z(a,d){for(let y=1;y<arguments.length;y++){const x=arguments[y];var p=typeof x;if(p=p!="object"?p:x?Array.isArray(x)?"array":p:"null",p=="array"||p=="object"&&typeof x.length=="number"){p=a.length||0;const N=x.length||0;a.length=p+N;for(let F=0;F<N;F++)a[p+F]=x[F]}else a.push(x)}}class H{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return this.h>0?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function G(a){l.setTimeout(()=>{throw a},0)}function at(){var a=S;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class ut{constructor(){this.h=this.g=null}add(d,p){const y=et.get();y.set(d,p),this.h?this.h.next=y:this.g=y,this.h=y}}var et=new H(()=>new dt,a=>a.reset());class dt{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Bt,Ct=!1,S=new ut,w=()=>{const a=Promise.resolve(void 0);Bt=()=>{a.then(I)}};function I(){for(var a;a=at();){try{a.h.call(a.g)}catch(p){G(p)}var d=et;d.j(a),d.h<100&&(d.h++,a.next=d.g,d.g=a)}Ct=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var k=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};l.addEventListener("test",p,d),l.removeEventListener("test",p,d)}catch{}return a})();function E(a){return/^[\s\xa0]*$/.test(a)}function At(a,d){P.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,d)}b(At,P),At.prototype.init=function(a,d){const p=this.type=a.type,y=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget,d||(p=="mouseover"?d=a.fromElement:p=="mouseout"&&(d=a.toElement)),this.relatedTarget=d,y?(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&At.Z.h.call(this)},At.prototype.h=function(){At.Z.h.call(this);const a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var en="closure_listenable_"+(Math.random()*1e6|0),ie=0;function $n(a,d,p,y,x){this.listener=a,this.proxy=null,this.src=d,this.type=p,this.capture=!!y,this.ha=x,this.key=++ie,this.da=this.fa=!1}function J(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Jn(a,d,p){for(const y in a)d.call(p,a[y],y,a)}function Q(a,d){for(const p in a)d.call(void 0,a[p],p,a)}function wt(a){const d={};for(const p in a)d[p]=a[p];return d}const qt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Zt(a,d){let p,y;for(let x=1;x<arguments.length;x++){y=arguments[x];for(p in y)a[p]=y[p];for(let N=0;N<qt.length;N++)p=qt[N],Object.prototype.hasOwnProperty.call(y,p)&&(a[p]=y[p])}}function It(a){this.src=a,this.g={},this.h=0}It.prototype.add=function(a,d,p,y,x){const N=a.toString();a=this.g[N],a||(a=this.g[N]=[],this.h++);const F=rt(a,d,y,x);return F>-1?(d=a[F],p||(d.fa=!1)):(d=new $n(d,this.src,N,!!y,x),d.fa=p,a.push(d)),d};function ft(a,d){const p=d.type;if(p in a.g){var y=a.g[p],x=Array.prototype.indexOf.call(y,d,void 0),N;(N=x>=0)&&Array.prototype.splice.call(y,x,1),N&&(J(d),a.g[p].length==0&&(delete a.g[p],a.h--))}}function rt(a,d,p,y){for(let x=0;x<a.length;++x){const N=a[x];if(!N.da&&N.listener==d&&N.capture==!!p&&N.ha==y)return x}return-1}var me="closure_lm_"+(Math.random()*1e6|0),ve={};function Ir(a,d,p,y,x){if(Array.isArray(d)){for(let N=0;N<d.length;N++)Ir(a,d[N],p,y,x);return null}return p=Yn(p),a&&a[en]?a.J(d,p,m(y)?!!y.capture:!1,x):Ar(a,d,p,!1,y,x)}function Ar(a,d,p,y,x,N){if(!d)throw Error("Invalid event type");const F=m(x)?!!x.capture:!!x;let tt=xi(a);if(tt||(a[me]=tt=new It(a)),p=tt.add(d,p,y,F,N),p.proxy)return p;if(y=Pr(),p.proxy=y,y.src=a,y.listener=p,a.addEventListener)k||(x=F),x===void 0&&(x=!1),a.addEventListener(d.toString(),y,x);else if(a.attachEvent)a.attachEvent(ks(d.toString()),y);else if(a.addListener&&a.removeListener)a.addListener(y);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Pr(){function a(p){return d.call(a.src,a.listener,p)}const d=xs;return a}function En(a,d,p,y,x){if(Array.isArray(d))for(var N=0;N<d.length;N++)En(a,d[N],p,y,x);else y=m(y)?!!y.capture:!!y,p=Yn(p),a&&a[en]?(a=a.i,N=String(d).toString(),N in a.g&&(d=a.g[N],p=rt(d,p,y,x),p>-1&&(J(d[p]),Array.prototype.splice.call(d,p,1),d.length==0&&(delete a.g[N],a.h--)))):a&&(a=xi(a))&&(d=a.g[d.toString()],a=-1,d&&(a=rt(d,p,y,x)),(p=a>-1?d[a]:null)&&Xn(p))}function Xn(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[en])ft(d.i,a);else{var p=a.type,y=a.proxy;d.removeEventListener?d.removeEventListener(p,y,a.capture):d.detachEvent?d.detachEvent(ks(p),y):d.addListener&&d.removeListener&&d.removeListener(y),(p=xi(d))?(ft(p,a),p.h==0&&(p.src=null,d[me]=null)):J(a)}}}function ks(a){return a in ve?ve[a]:ve[a]="on"+a}function xs(a,d){if(a.da)a=!0;else{d=new At(d,this);const p=a.listener,y=a.ha||a.src;a.fa&&Xn(a),a=p.call(y,d)}return a}function xi(a){return a=a[me],a instanceof It?a:null}var Qn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Yn(a){return typeof a=="function"?a:(a[Qn]||(a[Qn]=function(d){return a.handleEvent(d)}),a[Qn])}function Ut(){C.call(this),this.i=new It(this),this.M=this,this.G=null}b(Ut,C),Ut.prototype[en]=!0,Ut.prototype.removeEventListener=function(a,d,p,y){En(this,a,d,p,y)};function Ft(a,d){var p,y=a.G;if(y)for(p=[];y;y=y.G)p.push(y);if(a=a.M,y=d.type||d,typeof d=="string")d=new P(d,a);else if(d instanceof P)d.target=d.target||a;else{var x=d;d=new P(y,a),Zt(d,x)}x=!0;let N,F;if(p)for(F=p.length-1;F>=0;F--)N=d.g=p[F],x=In(N,y,!0,d)&&x;if(N=d.g=a,x=In(N,y,!0,d)&&x,x=In(N,y,!1,d)&&x,p)for(F=0;F<p.length;F++)N=d.g=p[F],x=In(N,y,!1,d)&&x}Ut.prototype.N=function(){if(Ut.Z.N.call(this),this.i){var a=this.i;for(const d in a.g){const p=a.g[d];for(let y=0;y<p.length;y++)J(p[y]);delete a.g[d],a.h--}}this.G=null},Ut.prototype.J=function(a,d,p,y){return this.i.add(String(a),d,!1,p,y)},Ut.prototype.K=function(a,d,p,y){return this.i.add(String(a),d,!0,p,y)};function In(a,d,p,y){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();let x=!0;for(let N=0;N<d.length;++N){const F=d[N];if(F&&!F.da&&F.capture==p){const tt=F.listener,mt=F.ha||F.src;F.fa&&ft(a.i,F),x=tt.call(mt,y)!==!1&&x}}return x&&!y.defaultPrevented}function Ls(a,d){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=v(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(d)>2147483647?-1:l.setTimeout(a,d||0)}function br(a){a.g=Ls(()=>{a.g=null,a.i&&(a.i=!1,br(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class oa extends C{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:br(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ti(a){C.call(this),this.h=a,this.g={}}b(ti,C);var Li=[];function Sr(a){Jn(a.g,function(d,p){this.g.hasOwnProperty(p)&&Xn(d)},a),a.g={}}ti.prototype.N=function(){ti.Z.N.call(this),Sr(this)},ti.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Oi=l.JSON.stringify,aa=l.JSON.parse,Os=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function Cr(){}function Ns(){}var An={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function ei(){P.call(this,"d")}b(ei,P);function Ni(){P.call(this,"c")}b(Ni,P);var nn={},Pn=null;function Di(){return Pn=Pn||new Ut}nn.Ia="serverreachability";function Ds(a){P.call(this,nn.Ia,a)}b(Ds,P);function bn(a){const d=Di();Ft(d,new Ds(d))}nn.STAT_EVENT="statevent";function Rr(a,d){P.call(this,nn.STAT_EVENT,a),this.stat=d}b(Rr,P);function zt(a){const d=Di();Ft(d,new Rr(d,a))}nn.Ja="timingevent";function Ms(a,d){P.call(this,nn.Ja,a),this.size=d}b(Ms,P);function ni(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},d)}function ii(){this.g=!0}ii.prototype.ua=function(){this.g=!1};function ua(a,d,p,y,x,N){a.info(function(){if(a.g)if(N){var F="",tt=N.split("&");for(let gt=0;gt<tt.length;gt++){var mt=tt[gt].split("=");if(mt.length>1){const Ot=mt[0];mt=mt[1];const Ae=Ot.split("_");F=Ae.length>=2&&Ae[1]=="type"?F+(Ot+"="+mt+"&"):F+(Ot+"=redacted&")}}}else F=null;else F=N;return"XMLHTTP REQ ("+y+") [attempt "+x+"]: "+d+`
`+p+`
`+F})}function ha(a,d,p,y,x,N,F){a.info(function(){return"XMLHTTP RESP ("+y+") [ attempt "+x+"]: "+d+`
`+p+`
`+N+" "+F})}function Sn(a,d,p,y){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+ca(a,p)+(y?" "+y:"")})}function kr(a,d){a.info(function(){return"TIMEOUT: "+d})}ii.prototype.info=function(){};function ca(a,d){if(!a.g)return d;if(!d)return null;try{const N=JSON.parse(d);if(N){for(a=0;a<N.length;a++)if(Array.isArray(N[a])){var p=N[a];if(!(p.length<2)){var y=p[1];if(Array.isArray(y)&&!(y.length<1)){var x=y[0];if(x!="noop"&&x!="stop"&&x!="close")for(let F=1;F<y.length;F++)y[F]=""}}}}return Oi(N)}catch{return d}}var Mi={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Vs={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Bs;function he(){}b(he,Cr),he.prototype.g=function(){return new XMLHttpRequest},Bs=new he;function q(a){return encodeURIComponent(String(a))}function Us(a){var d=1;a=a.split(":");const p=[];for(;d>0&&a.length;)p.push(a.shift()),d--;return a.length&&p.push(a.join(":")),p}function Se(a,d,p,y){this.j=a,this.i=d,this.l=p,this.S=y||1,this.V=new ti(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new xr}function xr(){this.i=null,this.g="",this.h=!1}var Lr={},ri={};function Vi(a,d,p){a.M=1,a.A=Tt(re(d)),a.u=p,a.R=!0,rn(a,null)}function rn(a,d){a.F=Date.now(),Bi(a),a.B=re(a.A);var p=a.B,y=a.S;Array.isArray(y)||(y=[String(y)]),ji(p.i,"t",y),a.C=0,p=a.j.L,a.h=new xr,a.g=Zr(a.j,p?d:null,!a.u),a.P>0&&(a.O=new oa(v(a.Y,a,a.g),a.P)),d=a.V,p=a.g,y=a.ba;var x="readystatechange";Array.isArray(x)||(x&&(Li[0]=x.toString()),x=Li);for(let N=0;N<x.length;N++){const F=Ir(p,x[N],y||d.handleEvent,!1,d.h||d);if(!F)break;d.g[F.key]=F}d=a.J?wt(a.J):{},a.u?(a.v||(a.v="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,d)):(a.v="GET",a.g.ea(a.B,a.v,null,d)),bn(),ua(a.i,a.v,a.B,a.l,a.S,a.u)}Se.prototype.ba=function(a){a=a.target;const d=this.O;d&&ze(a)==3?d.j():this.Y(a)},Se.prototype.Y=function(a){try{if(a==this.g)t:{const tt=ze(this.g),mt=this.g.ya(),gt=this.g.ca();if(!(tt<3)&&(tt!=3||this.g&&(this.h.h||this.g.la()||Ur(this.g)))){this.K||tt!=4||mt==7||(mt==8||gt<=0?bn(3):bn(2)),Ui(this);var d=this.g.ca();this.X=d;var p=Fs(this);if(this.o=d==200,ha(this.i,this.v,this.B,this.l,this.S,tt,d),this.o){if(this.U&&!this.L){e:{if(this.g){var y,x=this.g;if((y=x.g?x.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(y)){var N=y;break e}}N=null}if(a=N)Sn(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Or(this,a);else{this.o=!1,this.m=3,zt(12),we(this),si(this);break t}}if(this.R){a=!0;let Ot;for(;!this.K&&this.C<p.length;)if(Ot=la(this,p),Ot==ri){tt==4&&(this.m=4,zt(14),a=!1),Sn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ot==Lr){this.m=4,zt(15),Sn(this.i,this.l,p,"[Invalid Chunk]"),a=!1;break}else Sn(this.i,this.l,Ot,null),Or(this,Ot);if(zs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tt!=4||p.length!=0||this.h.h||(this.m=1,zt(16),a=!1),this.o=this.o&&a,!a)Sn(this.i,this.l,p,"[Invalid Chunked Response]"),we(this),si(this);else if(p.length>0&&!this.W){this.W=!0;var F=this.j;F.g==this&&F.aa&&!F.P&&(F.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Wr(F),F.P=!0,zt(11))}}else Sn(this.i,this.l,p,null),Or(this,p);tt==4&&we(this),this.o&&!this.K&&(tt==4?ge(this.j,this):(this.o=!1,Bi(this)))}else Fr(this.g),d==400&&p.indexOf("Unknown SID")>0?(this.m=3,zt(12)):(this.m=0,zt(13)),we(this),si(this)}}}catch{}};function Fs(a){if(!zs(a))return a.g.la();const d=Ur(a.g);if(d==="")return"";let p="";const y=d.length,x=ze(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return we(a),si(a),"";a.h.i=new l.TextDecoder}for(let N=0;N<y;N++)a.h.h=!0,p+=a.h.i.decode(d[N],{stream:!(x&&N==y-1)});return d.length=0,a.h.g+=p,a.C=0,a.h.g}function zs(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function la(a,d){var p=a.C,y=d.indexOf(`
`,p);return y==-1?ri:(p=Number(d.substring(p,y)),isNaN(p)?Lr:(y+=1,y+p>d.length?ri:(d=d.slice(y,y+p),a.C=y+p,d)))}Se.prototype.cancel=function(){this.K=!0,we(this)};function Bi(a){a.T=Date.now()+a.H,Hs(a,a.H)}function Hs(a,d){if(a.D!=null)throw Error("WatchDog timer not null");a.D=ni(v(a.aa,a),d)}function Ui(a){a.D&&(l.clearTimeout(a.D),a.D=null)}Se.prototype.aa=function(){this.D=null;const a=Date.now();a-this.T>=0?(kr(this.i,this.B),this.M!=2&&(bn(),zt(17)),we(this),this.m=2,si(this)):Hs(this,this.T-a)};function si(a){a.j.I==0||a.K||ge(a.j,a)}function we(a){Ui(a);var d=a.O;d&&typeof d.dispose=="function"&&d.dispose(),a.O=null,Sr(a.V),a.g&&(d=a.g,a.g=null,d.abort(),d.dispose())}function Or(a,d){try{var p=a.j;if(p.I!=0&&(p.g==a||oi(p.h,a))){if(!a.L&&oi(p.h,a)&&p.I==3){try{var y=p.Ba.g.parse(d)}catch{y=null}if(Array.isArray(y)&&y.length==3){var x=y;if(x[0]==0){t:if(!p.v){if(p.g)if(p.g.F+3e3<a.F)Ki(p),Zi(p);else break t;jr(p),zt(18)}}else p.xa=x[1],0<p.xa-p.K&&x[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=ni(v(p.Va,p),6e3));qs(p.h)<=1&&p.ta&&(p.ta=void 0)}else je(p,11)}else if((a.L||p.g==a)&&Ki(p),!E(d))for(x=p.Ba.g.parse(d),d=0;d<x.length;d++){let gt=x[d];const Ot=gt[0];if(!(Ot<=p.K))if(p.K=Ot,gt=gt[1],p.I==2)if(gt[0]=="c"){p.M=gt[1],p.ba=gt[2];const Ae=gt[3];Ae!=null&&(p.ka=Ae,p.j.info("VER="+p.ka));const ke=gt[4];ke!=null&&(p.za=ke,p.j.info("SVER="+p.za));const Pe=gt[5];Pe!=null&&typeof Pe=="number"&&Pe>0&&(y=1.5*Pe,p.O=y,p.j.info("backChannelRequestTimeoutMs_="+y)),y=p;const We=a.g;if(We){const Xi=We.g?We.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xi){var N=y.h;N.g||Xi.indexOf("spdy")==-1&&Xi.indexOf("quic")==-1&&Xi.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(sn(N,N.h),N.h=null))}if(y.G){const Qi=We.g?We.g.getResponseHeader("X-HTTP-Session-Id"):null;Qi&&(y.wa=Qi,W(y.J,y.G,Qi))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-a.F,p.j.info("Handshake RTT: "+p.T+"ms")),y=p;var F=a;if(y.na=qr(y,y.L?y.ba:null,y.W),F.L){Nr(y.h,F);var tt=F,mt=y.O;mt&&(tt.H=mt),tt.D&&(Ui(tt),Bi(tt)),y.g=F}else Hr(y);p.i.length>0&&He(p)}else gt[0]!="stop"&&gt[0]!="close"||je(p,7);else p.I==3&&(gt[0]=="stop"||gt[0]=="close"?gt[0]=="stop"?je(p,7):st(p):gt[0]!="noop"&&p.l&&p.l.qa(gt),p.A=0)}}bn(4)}catch{}}var da=class{constructor(a,d){this.g=a,this.map=d}};function js(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ws(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function qs(a){return a.h?1:a.g?a.g.size:0}function oi(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function sn(a,d){a.g?a.g.add(d):a.h=d}function Nr(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}js.prototype.cancel=function(){if(this.i=Dr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Dr(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const p of a.g.values())d=d.concat(p.G);return d}return U(a.i)}var Cn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ct(a,d){if(a){a=a.split("&");for(let p=0;p<a.length;p++){const y=a[p].indexOf("=");let x,N=null;y>=0?(x=a[p].substring(0,y),N=a[p].substring(y+1)):x=a[p],d(x,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function pt(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let d;a instanceof pt?(this.l=a.l,Te(this,a.j),this.o=a.o,this.g=a.g,Ee(this,a.u),this.h=a.h,ai(this,ui(a.i)),this.m=a.m):a&&(d=String(a).match(Cn))?(this.l=!1,Te(this,d[1]||"",!0),this.o=on(d[2]||""),this.g=on(d[3]||"",!0),Ee(this,d[4]),this.h=on(d[5]||"",!0),ai(this,d[6]||"",!0),this.m=on(d[7]||"")):(this.l=!1,this.i=new Ce(null,this.l))}pt.prototype.toString=function(){const a=[];var d=this.j;d&&a.push(Be(d,Zs,!0),":");var p=this.g;return(p||d=="file")&&(a.push("//"),(d=this.o)&&a.push(Be(d,Zs,!0),"@"),a.push(q(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&a.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push(Be(p,p.charAt(0)=="/"?an:Fi,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",Be(p,un)),a.join("")},pt.prototype.resolve=function(a){const d=re(this);let p=!!a.j;p?Te(d,a.j):p=!!a.o,p?d.o=a.o:p=!!a.g,p?d.g=a.g:p=a.u!=null;var y=a.h;if(p)Ee(d,a.u);else if(p=!!a.h){if(y.charAt(0)!="/")if(this.g&&!this.h)y="/"+y;else{var x=d.h.lastIndexOf("/");x!=-1&&(y=d.h.slice(0,x+1)+y)}if(x=y,x==".."||x==".")y="";else if(x.indexOf("./")!=-1||x.indexOf("/.")!=-1){y=x.lastIndexOf("/",0)==0,x=x.split("/");const N=[];for(let F=0;F<x.length;){const tt=x[F++];tt=="."?y&&F==x.length&&N.push(""):tt==".."?((N.length>1||N.length==1&&N[0]!="")&&N.pop(),y&&F==x.length&&N.push("")):(N.push(tt),y=!0)}y=N.join("/")}else y=x}return p?d.h=y:p=a.i.toString()!=="",p?ai(d,ui(a.i)):p=!!a.m,p&&(d.m=a.m),d};function re(a){return new pt(a)}function Te(a,d,p){a.j=p?on(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function Ee(a,d){if(d){if(d=Number(d),isNaN(d)||d<0)throw Error("Bad port number "+d);a.u=d}else a.u=null}function ai(a,d,p){d instanceof Ce?(a.i=d,Mr(a.i,a.l)):(p||(d=Be(d,Rt)),a.i=new Ce(d,a.l))}function W(a,d,p){a.i.set(d,p)}function Tt(a){return W(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function on(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Be(a,d,p){return typeof a=="string"?(a=encodeURI(a).replace(d,ce),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function ce(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Zs=/[#\/\?@]/g,Fi=/[#\?:]/g,an=/[#\?]/g,Rt=/[#\?@]/g,un=/#/g;function Ce(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function _e(a){a.g||(a.g=new Map,a.h=0,a.i&&ct(a.i,function(d,p){a.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}i=Ce.prototype,i.add=function(a,d){_e(this),this.i=null,a=Ue(this,a);let p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(d),this.h+=1,this};function zi(a,d){_e(a),d=Ue(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function Rn(a,d){return _e(a),d=Ue(a,d),a.g.has(d)}i.forEach=function(a,d){_e(this),this.g.forEach(function(p,y){p.forEach(function(x){a.call(d,x,y,this)},this)},this)};function Hi(a,d){_e(a);let p=[];if(typeof d=="string")Rn(a,d)&&(p=p.concat(a.g.get(Ue(a,d))));else for(a=Array.from(a.g.values()),d=0;d<a.length;d++)p=p.concat(a[d]);return p}i.set=function(a,d){return _e(this),this.i=null,a=Ue(this,a),Rn(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},i.get=function(a,d){return a?(a=Hi(this,a),a.length>0?String(a[0]):d):d};function ji(a,d,p){zi(a,d),p.length>0&&(a.i=null,a.g.set(Ue(a,d),U(p)),a.h+=p.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(let y=0;y<d.length;y++){var p=d[y];const x=q(p);p=Hi(this,p);for(let N=0;N<p.length;N++){let F=x;p[N]!==""&&(F+="="+q(p[N])),a.push(F)}}return this.i=a.join("&")};function ui(a){const d=new Ce;return d.i=a.i,a.g&&(d.g=new Map(a.g),d.h=a.h),d}function Ue(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function Mr(a,d){d&&!a.j&&(_e(a),a.i=null,a.g.forEach(function(p,y){const x=y.toLowerCase();y!=x&&(zi(this,y),ji(this,x,p))},a)),a.j=d}function Wi(a,d){const p=new ii;if(l.Image){const y=new Image;y.onload=A(Ie,p,"TestLoadImage: loaded",!0,d,y),y.onerror=A(Ie,p,"TestLoadImage: error",!1,d,y),y.onabort=A(Ie,p,"TestLoadImage: abort",!1,d,y),y.ontimeout=A(Ie,p,"TestLoadImage: timeout",!1,d,y),l.setTimeout(function(){y.ontimeout&&y.ontimeout()},1e4),y.src=a}else d(!1)}function Gs(a,d){const p=new ii,y=new AbortController,x=setTimeout(()=>{y.abort(),Ie(p,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:y.signal}).then(N=>{clearTimeout(x),N.ok?Ie(p,"TestPingServer: ok",!0,d):Ie(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(x),Ie(p,"TestPingServer: error",!1,d)})}function Ie(a,d,p,y,x){try{x&&(x.onload=null,x.onerror=null,x.onabort=null,x.ontimeout=null),y(p)}catch{}}function fa(){this.g=new Os}function Y(a){this.i=a.Sb||null,this.h=a.ab||!1}b(Y,Cr),Y.prototype.g=function(){return new se(this.i,this.h)};function se(a,d){Ut.call(this),this.H=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(se,Ut),i=se.prototype,i.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=d,this.readyState=1,hn(this)},i.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const d={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(d.body=a),(this.H||l).fetch(new Request(this.D,d)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,kn(this)),this.readyState=0},i.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,hn(this)),this.g&&(this.readyState=3,hn(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;vt(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function vt(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}i.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.B.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?kn(this):hn(this),this.readyState==3&&vt(this)}},i.Oa=function(a){this.g&&(this.response=this.responseText=a,kn(this))},i.Na=function(a){this.g&&(this.response=a,kn(this))},i.ga=function(){this.g&&kn(this)};function kn(a){a.readyState=4,a.l=null,a.j=null,a.B=null,hn(a)}i.setRequestHeader=function(a,d){this.A.append(a,d)},i.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=d.next();return a.join(`\r
`)};function hn(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(se.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function qi(a){let d="";return Jn(a,function(p,y){d+=y,d+=":",d+=p,d+=`\r
`}),d}function hi(a,d,p){t:{for(y in p){var y=!1;break t}y=!0}y||(p=qi(p),typeof a=="string"?p!=null&&q(p):W(a,d,p))}function _t(a){Ut.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(_t,Ut);var Vr=/^https?$/i,ci=["POST","PUT"];i=_t.prototype,i.Fa=function(a){this.H=a},i.ea=function(a,d,p,y){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Bs.g(),this.g.onreadystatechange=R(v(this.Ca,this));try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(N){Nt(this,N);return}if(a=p||"",p=new Map(this.headers),y)if(Object.getPrototypeOf(y)===Object.prototype)for(var x in y)p.set(x,y[x]);else if(typeof y.keys=="function"&&typeof y.get=="function")for(const N of y.keys())p.set(N,y.get(N));else throw Error("Unknown input type for opt_headers: "+String(y));y=Array.from(p.keys()).find(N=>N.toLowerCase()=="content-type"),x=l.FormData&&a instanceof l.FormData,!(Array.prototype.indexOf.call(ci,d,void 0)>=0)||y||x||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[N,F]of p)this.g.setRequestHeader(N,F);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(N){Nt(this,N)}};function Nt(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.o=5,Fe(a),li(a)}function Fe(a){a.A||(a.A=!0,Ft(a,"complete"),Ft(a,"error"))}i.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,Ft(this,"complete"),Ft(this,"abort"),li(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),li(this,!0)),_t.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?Br(this):this.Xa())},i.Xa=function(){Br(this)};function Br(a){if(a.h&&typeof h<"u"){if(a.v&&ze(a)==4)setTimeout(a.Ca.bind(a),0);else if(Ft(a,"readystatechange"),ze(a)==4){a.h=!1;try{const N=a.ca();t:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break t;default:d=!1}var p;if(!(p=d)){var y;if(y=N===0){let F=String(a.D).match(Cn)[1]||null;!F&&l.self&&l.self.location&&(F=l.self.location.protocol.slice(0,-1)),y=!Vr.test(F?F.toLowerCase():"")}p=y}if(p)Ft(a,"complete"),Ft(a,"success");else{a.o=6;try{var x=ze(a)>2?a.g.statusText:""}catch{x=""}a.l=x+" ["+a.ca()+"]",Fe(a)}}finally{li(a)}}}}function li(a,d){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);const p=a.g;a.g=null,d||Ft(a,"ready");try{p.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function ze(a){return a.g?a.g.readyState:0}i.ca=function(){try{return ze(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),aa(d)}};function Ur(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Fr(a){const d={};a=(a.g&&ze(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let y=0;y<a.length;y++){if(E(a[y]))continue;var p=Us(a[y]);const x=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const N=d[x]||[];d[x]=N,N.push(p)}Q(d,function(y){return y.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function di(a,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||d}function zr(a){this.za=0,this.i=[],this.j=new ii,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=di("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=di("baseRetryDelayMs",5e3,a),this.Za=di("retryDelaySeedMs",1e4,a),this.Ta=di("forwardChannelMaxRetries",2,a),this.va=di("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new js(a&&a.concurrentRequestLimit),this.Ba=new fa,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=zr.prototype,i.ka=8,i.I=1,i.connect=function(a,d,p,y){zt(0),this.W=a,this.H=d||{},p&&y!==void 0&&(this.H.OSID=p,this.H.OAID=y),this.F=this.X,this.J=qr(this,null,this.W),He(this)};function st(a){if(le(a),a.I==3){var d=a.V++,p=re(a.J);if(W(p,"SID",a.M),W(p,"RID",d),W(p,"TYPE","terminate"),cn(a,p),d=new Se(a,a.j,d),d.M=2,d.A=Tt(re(p)),p=!1,l.navigator&&l.navigator.sendBeacon)try{p=l.navigator.sendBeacon(d.A.toString(),"")}catch{}!p&&l.Image&&(new Image().src=d.A,p=!0),p||(d.g=Zr(d.j,null),d.g.ea(d.A)),d.F=Date.now(),Bi(d)}Re(a)}function Zi(a){a.g&&(Wr(a),a.g.cancel(),a.g=null)}function le(a){Zi(a),a.v&&(l.clearTimeout(a.v),a.v=null),Ki(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&l.clearTimeout(a.m),a.m=null)}function He(a){if(!Ws(a.h)&&!a.m){a.m=!0;var d=a.Ea;Bt||w(),Ct||(Bt(),Ct=!0),S.add(d,a),a.D=0}}function Ks(a,d){return qs(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=d.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=ni(v(a.Ea,a,d),Xs(a,a.D)),a.D++,!0)}i.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;const x=new Se(this,this.j,a);let N=this.o;if(this.U&&(N?(N=wt(N),Zt(N,this.U)):N=this.U),this.u!==null||this.R||(x.J=N,N=null),this.S)t:{for(var d=0,p=0;p<this.i.length;p++){e:{var y=this.i[p];if("__data__"in y.map&&(y=y.map.__data__,typeof y=="string")){y=y.length;break e}y=void 0}if(y===void 0)break;if(d+=y,d>4096){d=p;break t}if(d===4096||p===this.i.length-1){d=p+1;break t}}d=1e3}else d=1e3;d=Js(this,x,d),p=re(this.J),W(p,"RID",a),W(p,"CVER",22),this.G&&W(p,"X-HTTP-Session-Id",this.G),cn(this,p),N&&(this.R?d="headers="+q(qi(N))+"&"+d:this.u&&hi(p,this.u,N)),sn(this.h,x),this.Ra&&W(p,"TYPE","init"),this.S?(W(p,"$req",d),W(p,"SID","null"),x.U=!0,Vi(x,p,null)):Vi(x,p,d),this.I=2}}else this.I==3&&(a?$s(this,a):this.i.length==0||Ws(this.h)||$s(this))};function $s(a,d){var p;d?p=d.l:p=a.V++;const y=re(a.J);W(y,"SID",a.M),W(y,"RID",p),W(y,"AID",a.K),cn(a,y),a.u&&a.o&&hi(y,a.u,a.o),p=new Se(a,a.j,p,a.D+1),a.u===null&&(p.J=a.o),d&&(a.i=d.G.concat(a.i)),d=Js(a,p,1e3),p.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),sn(a.h,p),Vi(p,y,d)}function cn(a,d){a.H&&Jn(a.H,function(p,y){W(d,y,p)}),a.l&&Jn({},function(p,y){W(d,y,p)})}function Js(a,d,p){p=Math.min(a.i.length,p);const y=a.l?v(a.l.Ka,a.l,a):null;t:{var x=a.i;let tt=-1;for(;;){const mt=["count="+p];tt==-1?p>0?(tt=x[0].g,mt.push("ofs="+tt)):tt=0:mt.push("ofs="+tt);let gt=!0;for(let Ot=0;Ot<p;Ot++){var N=x[Ot].g;const Ae=x[Ot].map;if(N-=tt,N<0)tt=Math.max(0,x[Ot].g-100),gt=!1;else try{N="req"+N+"_"||"";try{var F=Ae instanceof Map?Ae:Object.entries(Ae);for(const[ke,Pe]of F){let We=Pe;m(Pe)&&(We=Oi(Pe)),mt.push(N+ke+"="+encodeURIComponent(We))}}catch(ke){throw mt.push(N+"type="+encodeURIComponent("_badmap")),ke}}catch{y&&y(Ae)}}if(gt){F=mt.join("&");break t}}F=void 0}return a=a.i.splice(0,p),d.G=a,F}function Hr(a){if(!a.g&&!a.v){a.Y=1;var d=a.Da;Bt||w(),Ct||(Bt(),Ct=!0),S.add(d,a),a.A=0}}function jr(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=ni(v(a.Da,a),Xs(a,a.A)),a.A++,!0)}i.Da=function(){if(this.v=null,Gi(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=ni(v(this.Wa,this),a)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,zt(10),Zi(this),Gi(this))};function Wr(a){a.B!=null&&(l.clearTimeout(a.B),a.B=null)}function Gi(a){a.g=new Se(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var d=re(a.na);W(d,"RID","rpc"),W(d,"SID",a.M),W(d,"AID",a.K),W(d,"CI",a.F?"0":"1"),!a.F&&a.ia&&W(d,"TO",a.ia),W(d,"TYPE","xmlhttp"),cn(a,d),a.u&&a.o&&hi(d,a.u,a.o),a.O&&(a.g.H=a.O);var p=a.g;a=a.ba,p.M=1,p.A=Tt(re(d)),p.u=null,p.R=!0,rn(p,a)}i.Va=function(){this.C!=null&&(this.C=null,Zi(this),jr(this),zt(19))};function Ki(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function ge(a,d){var p=null;if(a.g==d){Ki(a),Wr(a),a.g=null;var y=2}else if(oi(a.h,d))p=d.G,Nr(a.h,d),y=1;else return;if(a.I!=0){if(d.o)if(y==1){p=d.u?d.u.length:0,d=Date.now()-d.F;var x=a.D;y=Di(),Ft(y,new Ms(y,p)),He(a)}else Hr(a);else if(x=d.m,x==3||x==0&&d.X>0||!(y==1&&Ks(a,d)||y==2&&jr(a)))switch(p&&p.length>0&&(d=a.h,d.i=d.i.concat(p)),x){case 1:je(a,5);break;case 4:je(a,10);break;case 3:je(a,6);break;default:je(a,2)}}}function Xs(a,d){let p=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(p*=2),p*d}function je(a,d){if(a.j.info("Error code "+d),d==2){var p=v(a.bb,a),y=a.Ua;const x=!y;y=new pt(y||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Te(y,"https"),Tt(y),x?Wi(y.toString(),p):Gs(y.toString(),p)}else zt(2);a.I=0,a.l&&a.l.pa(d),Re(a),le(a)}i.bb=function(a){a?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function Re(a){if(a.I=0,a.ja=[],a.l){const d=Dr(a.h);(d.length!=0||a.i.length!=0)&&(z(a.ja,d),z(a.ja,a.i),a.h.i.length=0,U(a.i),a.i.length=0),a.l.oa()}}function qr(a,d,p){var y=p instanceof pt?re(p):new pt(p);if(y.g!="")d&&(y.g=d+"."+y.g),Ee(y,y.u);else{var x=l.location;y=x.protocol,d=d?d+"."+x.hostname:x.hostname,x=+x.port;const N=new pt(null);y&&Te(N,y),d&&(N.g=d),x&&Ee(N,x),p&&(N.h=p),y=N}return p=a.G,d=a.wa,p&&d&&W(y,p,d),W(y,"VER",a.ka),cn(a,y),y}function Zr(a,d,p){if(d&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Aa&&!a.ma?new _t(new Y({ab:p})):new _t(a.ma),d.Fa(a.L),d}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function $i(){}i=$i.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Ji(){}Ji.prototype.g=function(a,d){return new Xt(a,d)};function Xt(a,d){Ut.call(this),this.g=new zr(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.sa&&(a?a["X-WebChannel-Client-Profile"]=d.sa:a={"X-WebChannel-Client-Profile":d.sa}),this.g.U=a,(a=d&&d.Qb)&&!E(a)&&(this.g.u=a),this.A=d&&d.supportsCrossDomainXhr||!1,this.v=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!E(d)&&(this.g.G=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new xn(this)}b(Xt,Ut),Xt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xt.prototype.close=function(){st(this.g)},Xt.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.v&&(p={},p.__data__=Oi(a),a=p);d.i.push(new da(d.Ya++,a)),d.I==3&&He(d)},Xt.prototype.N=function(){this.g.l=null,delete this.j,st(this.g),delete this.g,Xt.Z.N.call(this)};function Gr(a){ei.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){t:{for(const p in d){a=p;break t}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}b(Gr,ei);function Qs(){Ni.call(this),this.status=1}b(Qs,Ni);function xn(a){this.g=a}b(xn,$i),xn.prototype.ra=function(){Ft(this.g,"a")},xn.prototype.qa=function(a){Ft(this.g,new Gr(a))},xn.prototype.pa=function(a){Ft(this.g,new Qs)},xn.prototype.oa=function(){Ft(this.g,"b")},Ji.prototype.createWebChannel=Ji.prototype.g,Xt.prototype.send=Xt.prototype.o,Xt.prototype.open=Xt.prototype.m,Xt.prototype.close=Xt.prototype.close,Gl=function(){return new Ji},Zl=function(){return Di()},ql=nn,za={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Mi.NO_ERROR=0,Mi.TIMEOUT=8,Mi.HTTP_ERROR=6,Ao=Mi,Vs.COMPLETE="complete",Wl=Vs,Ns.EventType=An,An.OPEN="a",An.CLOSE="b",An.ERROR="c",An.MESSAGE="d",Ut.prototype.listen=Ut.prototype.J,es=Ns,_t.prototype.listenOnce=_t.prototype.K,_t.prototype.getLastError=_t.prototype.Ha,_t.prototype.getLastErrorCode=_t.prototype.ya,_t.prototype.getStatus=_t.prototype.ca,_t.prototype.getResponseJson=_t.prototype.La,_t.prototype.getResponseText=_t.prototype.la,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Fa,jl=_t}).apply(typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{});class Yt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Yt.UNAUTHENTICATED=new Yt(null),Yt.GOOGLE_CREDENTIALS=new Yt("google-credentials-uid"),Yt.FIRST_PARTY=new Yt("first-party-uid"),Yt.MOCK_USER=new Yt("mock-user");let Tr="12.9.0";function Sy(i){Tr=i}const Ai=new nu("@firebase/firestore");function sr(){return Ai.logLevel}function Z(i,...t){if(Ai.logLevel<=ht.DEBUG){const e=t.map(wu);Ai.debug(`Firestore (${Tr}): ${i}`,...e)}}function Pi(i,...t){if(Ai.logLevel<=ht.ERROR){const e=t.map(wu);Ai.error(`Firestore (${Tr}): ${i}`,...e)}}function fs(i,...t){if(Ai.logLevel<=ht.WARN){const e=t.map(wu);Ai.warn(`Firestore (${Tr}): ${i}`,...e)}}function wu(i){if(typeof i=="string")return i;try{return(function(e){return JSON.stringify(e)})(i)}catch{return i}}function it(i,t,e){let r="Unexpected state";typeof t=="string"?r=t:e=t,Kl(i,r,e)}function Kl(i,t,e){let r=`FIRESTORE (${Tr}) INTERNAL ASSERTION FAILED: ${t} (ID: ${i.toString(16)})`;if(e!==void 0)try{r+=" CONTEXT: "+JSON.stringify(e)}catch{r+=" CONTEXT: "+e}throw Pi(r),new Error(r)}function kt(i,t,e,r){let o="Unexpected state";typeof e=="string"?o=e:r=e,i||Kl(t,o,r)}function Et(i,t){return i}const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class K extends tn{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class yi{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class $l{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Cy{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Yt.UNAUTHENTICATED)))}shutdown(){}}class Ry{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ky{constructor(t){this.t=t,this.currentUser=Yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){kt(this.o===void 0,42304);let r=this.i;const o=_=>this.i!==r?(r=this.i,e(_)):Promise.resolve();let h=new yi;this.o=()=>{this.i++,this.currentUser=this.u(),h.resolve(),h=new yi,t.enqueueRetryable((()=>o(this.currentUser)))};const l=()=>{const _=h;t.enqueueRetryable((async()=>{await _.promise,await o(this.currentUser)}))},m=_=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=_,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((_=>m(_))),setTimeout((()=>{if(!this.auth){const _=this.t.getImmediate({optional:!0});_?m(_):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),h.resolve(),h=new yi)}}),0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((r=>this.i!==t?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(kt(typeof r.accessToken=="string",31837,{l:r}),new $l(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return kt(t===null||typeof t=="string",2055,{h:t}),new Yt(t)}}class xy{constructor(t,e,r){this.P=t,this.T=e,this.I=r,this.type="FirstParty",this.user=Yt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const t=this.A();return t&&this.R.set("Authorization",t),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class Ly{constructor(t,e,r){this.P=t,this.T=e,this.I=r}getToken(){return Promise.resolve(new xy(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Yt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Kh{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Oy{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Oe(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){kt(this.o===void 0,3512);const r=h=>{h.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${h.error.message}`);const l=h.token!==this.m;return this.m=h.token,Z("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(h.token):Promise.resolve()};this.o=h=>{t.enqueueRetryable((()=>r(h)))};const o=h=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=h,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((h=>o(h))),setTimeout((()=>{if(!this.appCheck){const h=this.V.getImmediate({optional:!0});h?o(h):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Kh(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(kt(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new Kh(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ny(i){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(i);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let r=0;r<i;r++)e[r]=Math.floor(256*Math.random());return e}class Tu{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=Ny(40);for(let h=0;h<o.length;++h)r.length<20&&o[h]<e&&(r+=t.charAt(o[h]%62))}return r}}function yt(i,t){return i<t?-1:i>t?1:0}function Ha(i,t){const e=Math.min(i.length,t.length);for(let r=0;r<e;r++){const o=i.charAt(r),h=t.charAt(r);if(o!==h)return Ca(o)===Ca(h)?yt(o,h):Ca(o)?1:-1}return yt(i.length,t.length)}const Dy=55296,My=57343;function Ca(i){const t=i.charCodeAt(0);return t>=Dy&&t<=My}function mr(i,t,e){return i.length===t.length&&i.every(((r,o)=>e(r,t[o])))}const $h="__name__";class Ze{constructor(t,e,r){e===void 0?e=0:e>t.length&&it(637,{offset:e,range:t.length}),r===void 0?r=t.length-e:r>t.length-e&&it(1746,{length:r,range:t.length-e}),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return Ze.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Ze?t.forEach((r=>{e.push(r)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let o=0;o<r;o++){const h=Ze.compareSegments(t.get(o),e.get(o));if(h!==0)return h}return yt(t.length,e.length)}static compareSegments(t,e){const r=Ze.isNumericId(t),o=Ze.isNumericId(e);return r&&!o?-1:!r&&o?1:r&&o?Ze.extractNumericId(t).compare(Ze.extractNumericId(e)):Ha(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return vu.fromString(t.substring(4,t.length-2))}}class St extends Ze{construct(t,e,r){return new St(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new K(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter((o=>o.length>0)))}return new St(e)}static emptyPath(){return new St([])}}const Vy=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $t extends Ze{construct(t,e,r){return new $t(t,e,r)}static isValidIdentifier(t){return Vy.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$t.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===$h}static keyField(){return new $t([$h])}static fromServerFormat(t){const e=[];let r="",o=0;const h=()=>{if(r.length===0)throw new K(B.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let l=!1;for(;o<t.length;){const m=t[o];if(m==="\\"){if(o+1===t.length)throw new K(B.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const _=t[o+1];if(_!=="\\"&&_!=="."&&_!=="`")throw new K(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=_,o+=2}else m==="`"?(l=!l,o++):m!=="."||l?(r+=m,o++):(h(),o++)}if(h(),l)throw new K(B.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new $t(e)}static emptyPath(){return new $t([])}}class nt{constructor(t){this.path=t}static fromPath(t){return new nt(St.fromString(t))}static fromName(t){return new nt(St.fromString(t).popFirst(5))}static empty(){return new nt(St.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&St.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return St.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new nt(new St(t.slice()))}}function Jl(i,t,e){if(!e)throw new K(B.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${t}.`)}function By(i,t,e,r){if(t===!0&&r===!0)throw new K(B.INVALID_ARGUMENT,`${i} and ${e} cannot be used together.`)}function Jh(i){if(!nt.isDocumentKey(i))throw new K(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Xh(i){if(nt.isDocumentKey(i))throw new K(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function Xl(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function Eu(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const t=(function(r){return r.constructor?r.constructor.name:null})(i);return t?`a custom ${t} object`:"an object"}}return typeof i=="function"?"a function":it(12329,{type:typeof i})}function Ql(i,t){if("_delegate"in i&&(i=i._delegate),!(i instanceof t)){if(t.name===i.constructor.name)throw new K(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Eu(i);throw new K(B.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return i}function Vt(i,t){const e={typeString:i};return t&&(e.value=t),e}function As(i,t){if(!Xl(i))throw new K(B.INVALID_ARGUMENT,"JSON must be an object");let e;for(const r in t)if(t[r]){const o=t[r].typeString,h="value"in t[r]?{value:t[r].value}:void 0;if(!(r in i)){e=`JSON missing required field: '${r}'`;break}const l=i[r];if(o&&typeof l!==o){e=`JSON field '${r}' must be a ${o}.`;break}if(h!==void 0&&l!==h.value){e=`Expected '${r}' field to equal '${h.value}'`;break}}if(e)throw new K(B.INVALID_ARGUMENT,e);return!0}const Qh=-62135596800,Yh=1e6;class bt{static now(){return bt.fromMillis(Date.now())}static fromDate(t){return bt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor((t-1e3*e)*Yh);return new bt(e,r)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new K(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new K(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<Qh)throw new K(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new K(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Yh}_compareTo(t){return this.seconds===t.seconds?yt(this.nanoseconds,t.nanoseconds):yt(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(As(t,bt._jsonSchema))return new bt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-Qh;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}bt._jsonSchemaVersion="firestore/timestamp/1.0",bt._jsonSchema={type:Vt("string",bt._jsonSchemaVersion),seconds:Vt("number"),nanoseconds:Vt("number")};class Pt{static fromTimestamp(t){return new Pt(t)}static min(){return new Pt(new bt(0,0))}static max(){return new Pt(new bt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ps=-1;function Uy(i,t){const e=i.toTimestamp().seconds,r=i.toTimestamp().nanoseconds+1,o=Pt.fromTimestamp(r===1e9?new bt(e+1,0):new bt(e,r));return new Wn(o,nt.empty(),t)}function Fy(i){return new Wn(i.readTime,i.key,ps)}class Wn{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new Wn(Pt.min(),nt.empty(),ps)}static max(){return new Wn(Pt.max(),nt.empty(),ps)}}function zy(i,t){let e=i.readTime.compareTo(t.readTime);return e!==0?e:(e=nt.comparator(i.documentKey,t.documentKey),e!==0?e:yt(i.largestBatchId,t.largestBatchId))}const Hy="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jy{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Iu(i){if(i.code!==B.FAILED_PRECONDITION||i.message!==Hy)throw i;Z("LocalStore","Unexpectedly lost primary lease")}class M{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new M(((r,o)=>{this.nextCallback=h=>{this.wrapSuccess(t,h).next(r,o)},this.catchCallback=h=>{this.wrapFailure(e,h).next(r,o)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof M?e:M.resolve(e)}catch(e){return M.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):M.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):M.reject(e)}static resolve(t){return new M(((e,r)=>{e(t)}))}static reject(t){return new M(((e,r)=>{r(t)}))}static waitFor(t){return new M(((e,r)=>{let o=0,h=0,l=!1;t.forEach((m=>{++o,m.next((()=>{++h,l&&h===o&&e()}),(_=>r(_)))})),l=!0,h===o&&e()}))}static or(t){let e=M.resolve(!1);for(const r of t)e=e.next((o=>o?M.resolve(o):r()));return e}static forEach(t,e){const r=[];return t.forEach(((o,h)=>{r.push(e.call(this,o,h))})),this.waitFor(r)}static mapArray(t,e){return new M(((r,o)=>{const h=t.length,l=new Array(h);let m=0;for(let _=0;_<h;_++){const v=_;e(t[v]).next((A=>{l[v]=A,++m,m===h&&r(l)}),(A=>o(A)))}}))}static doWhile(t,e){return new M(((r,o)=>{const h=()=>{t()===!0?e().next((()=>{h()}),o):r()};h()}))}}function Wy(i){const t=i.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Ps(i){return i.name==="IndexedDbTransactionError"}class Au{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>e.writeSequenceNumber(r))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}Au.ce=-1;const Pu=-1;function bu(i){return i==null}function Vo(i){return i===0&&1/i==-1/0}function qy(i){return typeof i=="number"&&Number.isInteger(i)&&!Vo(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const Yl="";function Zy(i){let t="";for(let e=0;e<i.length;e++)t.length>0&&(t=tc(t)),t=Gy(i.get(e),t);return tc(t)}function Gy(i,t){let e=t;const r=i.length;for(let o=0;o<r;o++){const h=i.charAt(o);switch(h){case"\0":e+="";break;case Yl:e+="";break;default:e+=h}}return e}function tc(i){return i+Yl+""}function ec(i){let t=0;for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t++;return t}function Er(i,t){for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&t(e,i[e])}function td(i){for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t))return!1;return!0}class pe{constructor(t,e){this.comparator=t,this.root=e||Gt.EMPTY}insert(t,e){return new pe(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Gt.BLACK,null,null))}remove(t){return new pe(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Gt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(r===0)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(t,r.key);if(o===0)return e+r.left.size;o<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,r)=>(t(e,r),!1)))}toString(){const t=[];return this.inorderTraversal(((e,r)=>(t.push(`${e}:${r}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new mo(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new mo(this.root,t,this.comparator,!1)}getReverseIterator(){return new mo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new mo(this.root,t,this.comparator,!0)}}class mo{constructor(t,e,r,o){this.isReverse=o,this.nodeStack=[];let h=1;for(;!t.isEmpty();)if(h=e?r(t.key,e):1,e&&o&&(h*=-1),h<0)t=this.isReverse?t.left:t.right;else{if(h===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Gt{constructor(t,e,r,o,h){this.key=t,this.value=e,this.color=r??Gt.RED,this.left=o??Gt.EMPTY,this.right=h??Gt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,o,h){return new Gt(t??this.key,e??this.value,r??this.color,o??this.left,h??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let o=this;const h=r(t,o.key);return o=h<0?o.copy(null,null,null,o.left.insert(t,e,r),null):h===0?o.copy(null,e,null,null,null):o.copy(null,null,null,null,o.right.insert(t,e,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Gt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,o=this;if(e(t,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(t,e),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),e(t,o.key)===0){if(o.right.isEmpty())return Gt.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(t,e))}return o.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Gt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Gt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw it(27949);return t+(this.isRed()?0:1)}}Gt.EMPTY=null,Gt.RED=!0,Gt.BLACK=!1;Gt.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(t,e,r,o,h){return this}insert(t,e,r){return new Gt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Jt{constructor(t){this.comparator=t,this.data=new pe(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,r)=>(t(e),!1)))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,t[1])>=0)return;e(o.key)}}forEachWhile(t,e){let r;for(r=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new nc(this.data.getIterator())}getIteratorFrom(t){return new nc(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((r=>{e=e.add(r)})),e}isEqual(t){if(!(t instanceof Jt)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const o=e.getNext().key,h=r.getNext().key;if(this.comparator(o,h)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Jt(this.comparator);return e.data=t,e}}class nc{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ve{constructor(t){this.fields=t,t.sort($t.comparator)}static empty(){return new Ve([])}unionWith(t){let e=new Jt($t.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Ve(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return mr(this.fields,t.fields,((e,r)=>e.isEqual(r)))}}class Ky extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Qe{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(o){try{return atob(o)}catch(h){throw typeof DOMException<"u"&&h instanceof DOMException?new Ky("Invalid base64 string: "+h):h}})(t);return new Qe(e)}static fromUint8Array(t){const e=(function(o){let h="";for(let l=0;l<o.length;++l)h+=String.fromCharCode(o[l]);return h})(t);return new Qe(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return yt(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Qe.EMPTY_BYTE_STRING=new Qe("");const $y=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bi(i){if(kt(!!i,39018),typeof i=="string"){let t=0;const e=$y.exec(i);if(kt(!!e,46558,{timestamp:i}),e[1]){let o=e[1];o=(o+"000000000").substr(0,9),t=Number(o)}const r=new Date(i);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Kt(i.seconds),nanos:Kt(i.nanos)}}function Kt(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function _r(i){return typeof i=="string"?Qe.fromBase64String(i):Qe.fromUint8Array(i)}const ed="server_timestamp",nd="__type__",id="__previous_value__",rd="__local_write_time__";function Su(i){return(i?.mapValue?.fields||{})[nd]?.stringValue===ed}function Cu(i){const t=i.mapValue.fields[id];return Su(t)?Cu(t):t}function Bo(i){const t=bi(i.mapValue.fields[rd].timestampValue);return new bt(t.seconds,t.nanos)}class Jy{constructor(t,e,r,o,h,l,m,_,v,A,b){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=o,this.ssl=h,this.forceLongPolling=l,this.autoDetectLongPolling=m,this.longPollingOptions=_,this.useFetchStreams=v,this.isUsingEmulator=A,this.apiKey=b}}const Uo="(default)";class Fo{constructor(t,e){this.projectId=t,this.database=e||Uo}static empty(){return new Fo("","")}get isDefaultDatabase(){return this.database===Uo}isEqual(t){return t instanceof Fo&&t.projectId===this.projectId&&t.database===this.database}}function Xy(i,t){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new K(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fo(i.options.projectId,t)}const sd="__type__",Qy="__max__",_o={mapValue:{}},od="__vector__",ja="value";function Si(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?Su(i)?4:tv(i)?9007199254740991:Yy(i)?10:11:it(28295,{value:i})}function Ye(i,t){if(i===t)return!0;const e=Si(i);if(e!==Si(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===t.booleanValue;case 4:return Bo(i).isEqual(Bo(t));case 3:return(function(o,h){if(typeof o.timestampValue=="string"&&typeof h.timestampValue=="string"&&o.timestampValue.length===h.timestampValue.length)return o.timestampValue===h.timestampValue;const l=bi(o.timestampValue),m=bi(h.timestampValue);return l.seconds===m.seconds&&l.nanos===m.nanos})(i,t);case 5:return i.stringValue===t.stringValue;case 6:return(function(o,h){return _r(o.bytesValue).isEqual(_r(h.bytesValue))})(i,t);case 7:return i.referenceValue===t.referenceValue;case 8:return(function(o,h){return Kt(o.geoPointValue.latitude)===Kt(h.geoPointValue.latitude)&&Kt(o.geoPointValue.longitude)===Kt(h.geoPointValue.longitude)})(i,t);case 2:return(function(o,h){if("integerValue"in o&&"integerValue"in h)return Kt(o.integerValue)===Kt(h.integerValue);if("doubleValue"in o&&"doubleValue"in h){const l=Kt(o.doubleValue),m=Kt(h.doubleValue);return l===m?Vo(l)===Vo(m):isNaN(l)&&isNaN(m)}return!1})(i,t);case 9:return mr(i.arrayValue.values||[],t.arrayValue.values||[],Ye);case 10:case 11:return(function(o,h){const l=o.mapValue.fields||{},m=h.mapValue.fields||{};if(ec(l)!==ec(m))return!1;for(const _ in l)if(l.hasOwnProperty(_)&&(m[_]===void 0||!Ye(l[_],m[_])))return!1;return!0})(i,t);default:return it(52216,{left:i})}}function ms(i,t){return(i.values||[]).find((e=>Ye(e,t)))!==void 0}function gr(i,t){if(i===t)return 0;const e=Si(i),r=Si(t);if(e!==r)return yt(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return yt(i.booleanValue,t.booleanValue);case 2:return(function(h,l){const m=Kt(h.integerValue||h.doubleValue),_=Kt(l.integerValue||l.doubleValue);return m<_?-1:m>_?1:m===_?0:isNaN(m)?isNaN(_)?0:-1:1})(i,t);case 3:return ic(i.timestampValue,t.timestampValue);case 4:return ic(Bo(i),Bo(t));case 5:return Ha(i.stringValue,t.stringValue);case 6:return(function(h,l){const m=_r(h),_=_r(l);return m.compareTo(_)})(i.bytesValue,t.bytesValue);case 7:return(function(h,l){const m=h.split("/"),_=l.split("/");for(let v=0;v<m.length&&v<_.length;v++){const A=yt(m[v],_[v]);if(A!==0)return A}return yt(m.length,_.length)})(i.referenceValue,t.referenceValue);case 8:return(function(h,l){const m=yt(Kt(h.latitude),Kt(l.latitude));return m!==0?m:yt(Kt(h.longitude),Kt(l.longitude))})(i.geoPointValue,t.geoPointValue);case 9:return rc(i.arrayValue,t.arrayValue);case 10:return(function(h,l){const m=h.fields||{},_=l.fields||{},v=m[ja]?.arrayValue,A=_[ja]?.arrayValue,b=yt(v?.values?.length||0,A?.values?.length||0);return b!==0?b:rc(v,A)})(i.mapValue,t.mapValue);case 11:return(function(h,l){if(h===_o.mapValue&&l===_o.mapValue)return 0;if(h===_o.mapValue)return 1;if(l===_o.mapValue)return-1;const m=h.fields||{},_=Object.keys(m),v=l.fields||{},A=Object.keys(v);_.sort(),A.sort();for(let b=0;b<_.length&&b<A.length;++b){const R=Ha(_[b],A[b]);if(R!==0)return R;const U=gr(m[_[b]],v[A[b]]);if(U!==0)return U}return yt(_.length,A.length)})(i.mapValue,t.mapValue);default:throw it(23264,{he:e})}}function ic(i,t){if(typeof i=="string"&&typeof t=="string"&&i.length===t.length)return yt(i,t);const e=bi(i),r=bi(t),o=yt(e.seconds,r.seconds);return o!==0?o:yt(e.nanos,r.nanos)}function rc(i,t){const e=i.values||[],r=t.values||[];for(let o=0;o<e.length&&o<r.length;++o){const h=gr(e[o],r[o]);if(h)return h}return yt(e.length,r.length)}function yr(i){return Wa(i)}function Wa(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(e){const r=bi(e);return`time(${r.seconds},${r.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(e){return _r(e).toBase64()})(i.bytesValue):"referenceValue"in i?(function(e){return nt.fromName(e).toString()})(i.referenceValue):"geoPointValue"in i?(function(e){return`geo(${e.latitude},${e.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(e){let r="[",o=!0;for(const h of e.values||[])o?o=!1:r+=",",r+=Wa(h);return r+"]"})(i.arrayValue):"mapValue"in i?(function(e){const r=Object.keys(e.fields||{}).sort();let o="{",h=!0;for(const l of r)h?h=!1:o+=",",o+=`${l}:${Wa(e.fields[l])}`;return o+"}"})(i.mapValue):it(61005,{value:i})}function Po(i){switch(Si(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Cu(i);return t?16+Po(t):16;case 5:return 2*i.stringValue.length;case 6:return _r(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((o,h)=>o+Po(h)),0)})(i.arrayValue);case 10:case 11:return(function(r){let o=0;return Er(r.fields,((h,l)=>{o+=h.length+Po(l)})),o})(i.mapValue);default:throw it(13486,{value:i})}}function qa(i){return!!i&&"integerValue"in i}function Ru(i){return!!i&&"arrayValue"in i}function bo(i){return!!i&&"mapValue"in i}function Yy(i){return(i?.mapValue?.fields||{})[sd]?.stringValue===od}function os(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const t={mapValue:{fields:{}}};return Er(i.mapValue.fields,((e,r)=>t.mapValue.fields[e]=os(r))),t}if(i.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(i.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=os(i.arrayValue.values[e]);return t}return{...i}}function tv(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===Qy}class Ne{constructor(t){this.value=t}static empty(){return new Ne({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!bo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=os(e)}setAll(t){let e=$t.emptyPath(),r={},o=[];t.forEach(((l,m)=>{if(!e.isImmediateParentOf(m)){const _=this.getFieldsMap(e);this.applyChanges(_,r,o),r={},o=[],e=m.popLast()}l?r[m.lastSegment()]=os(l):o.push(m.lastSegment())}));const h=this.getFieldsMap(e);this.applyChanges(h,r,o)}delete(t){const e=this.field(t.popLast());bo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Ye(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let o=e.mapValue.fields[t.get(r)];bo(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=o),e=o}return e.mapValue.fields}applyChanges(t,e,r){Er(e,((o,h)=>t[o]=h));for(const o of r)delete t[o]}clone(){return new Ne(os(this.value))}}function ad(i){const t=[];return Er(i.fields,((e,r)=>{const o=new $t([e]);if(bo(r)){const h=ad(r.mapValue).fields;if(h.length===0)t.push(o);else for(const l of h)t.push(o.child(l))}else t.push(o)})),new Ve(t)}class Le{constructor(t,e,r,o,h,l,m){this.key=t,this.documentType=e,this.version=r,this.readTime=o,this.createTime=h,this.data=l,this.documentState=m}static newInvalidDocument(t){return new Le(t,0,Pt.min(),Pt.min(),Pt.min(),Ne.empty(),0)}static newFoundDocument(t,e,r,o){return new Le(t,1,e,Pt.min(),r,o,0)}static newNoDocument(t,e){return new Le(t,2,e,Pt.min(),Pt.min(),Ne.empty(),0)}static newUnknownDocument(t,e){return new Le(t,3,e,Pt.min(),Pt.min(),Ne.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(Pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ne.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ne.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Le&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Le(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zo{constructor(t,e){this.position=t,this.inclusive=e}}function sc(i,t,e){let r=0;for(let o=0;o<i.position.length;o++){const h=t[o],l=i.position[o];if(h.field.isKeyField()?r=nt.comparator(nt.fromName(l.referenceValue),e.key):r=gr(l,e.data.field(h.field)),h.dir==="desc"&&(r*=-1),r!==0)break}return r}function oc(i,t){if(i===null)return t===null;if(t===null||i.inclusive!==t.inclusive||i.position.length!==t.position.length)return!1;for(let e=0;e<i.position.length;e++)if(!Ye(i.position[e],t.position[e]))return!1;return!0}class Ho{constructor(t,e="asc"){this.field=t,this.dir=e}}function ev(i,t){return i.dir===t.dir&&i.field.isEqual(t.field)}class ud{}class Wt extends ud{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,r):new iv(t,e,r):e==="array-contains"?new ov(t,r):e==="in"?new av(t,r):e==="not-in"?new uv(t,r):e==="array-contains-any"?new hv(t,r):new Wt(t,e,r)}static createKeyFieldInFilter(t,e,r){return e==="in"?new rv(t,r):new sv(t,r)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(gr(e,this.value)):e!==null&&Si(this.value)===Si(e)&&this.matchesComparison(gr(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qn extends ud{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new qn(t,e)}matches(t){return hd(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hd(i){return i.op==="and"}function cd(i){return nv(i)&&hd(i)}function nv(i){for(const t of i.filters)if(t instanceof qn)return!1;return!0}function Za(i){if(i instanceof Wt)return i.field.canonicalString()+i.op.toString()+yr(i.value);if(cd(i))return i.filters.map((t=>Za(t))).join(",");{const t=i.filters.map((e=>Za(e))).join(",");return`${i.op}(${t})`}}function ld(i,t){return i instanceof Wt?(function(r,o){return o instanceof Wt&&r.op===o.op&&r.field.isEqual(o.field)&&Ye(r.value,o.value)})(i,t):i instanceof qn?(function(r,o){return o instanceof qn&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce(((h,l,m)=>h&&ld(l,o.filters[m])),!0):!1})(i,t):void it(19439)}function dd(i){return i instanceof Wt?(function(e){return`${e.field.canonicalString()} ${e.op} ${yr(e.value)}`})(i):i instanceof qn?(function(e){return e.op.toString()+" {"+e.getFilters().map(dd).join(" ,")+"}"})(i):"Filter"}class iv extends Wt{constructor(t,e,r){super(t,e,r),this.key=nt.fromName(r.referenceValue)}matches(t){const e=nt.comparator(t.key,this.key);return this.matchesComparison(e)}}class rv extends Wt{constructor(t,e){super(t,"in",e),this.keys=fd("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class sv extends Wt{constructor(t,e){super(t,"not-in",e),this.keys=fd("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function fd(i,t){return(t.arrayValue?.values||[]).map((e=>nt.fromName(e.referenceValue)))}class ov extends Wt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Ru(e)&&ms(e.arrayValue,this.value)}}class av extends Wt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&ms(this.value.arrayValue,e)}}class uv extends Wt{constructor(t,e){super(t,"not-in",e)}matches(t){if(ms(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!ms(this.value.arrayValue,e)}}class hv extends Wt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Ru(e)||!e.arrayValue.values)&&e.arrayValue.values.some((r=>ms(this.value.arrayValue,r)))}}class cv{constructor(t,e=null,r=[],o=[],h=null,l=null,m=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=o,this.limit=h,this.startAt=l,this.endAt=m,this.Te=null}}function ac(i,t=null,e=[],r=[],o=null,h=null,l=null){return new cv(i,t,e,r,o,h,l)}function ku(i){const t=Et(i);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((r=>Za(r))).join(","),e+="|ob:",e+=t.orderBy.map((r=>(function(h){return h.field.canonicalString()+h.dir})(r))).join(","),bu(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((r=>yr(r))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((r=>yr(r))).join(",")),t.Te=e}return t.Te}function xu(i,t){if(i.limit!==t.limit||i.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<i.orderBy.length;e++)if(!ev(i.orderBy[e],t.orderBy[e]))return!1;if(i.filters.length!==t.filters.length)return!1;for(let e=0;e<i.filters.length;e++)if(!ld(i.filters[e],t.filters[e]))return!1;return i.collectionGroup===t.collectionGroup&&!!i.path.isEqual(t.path)&&!!oc(i.startAt,t.startAt)&&oc(i.endAt,t.endAt)}class Qo{constructor(t,e=null,r=[],o=[],h=null,l="F",m=null,_=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=o,this.limit=h,this.limitType=l,this.startAt=m,this.endAt=_,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function lv(i,t,e,r,o,h,l,m){return new Qo(i,t,e,r,o,h,l,m)}function dv(i){return new Qo(i)}function uc(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function fv(i){return nt.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function pv(i){return i.collectionGroup!==null}function as(i){const t=Et(i);if(t.Ie===null){t.Ie=[];const e=new Set;for(const h of t.explicitOrderBy)t.Ie.push(h),e.add(h.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let m=new Jt($t.comparator);return l.filters.forEach((_=>{_.getFlattenedFilters().forEach((v=>{v.isInequality()&&(m=m.add(v.field))}))})),m})(t).forEach((h=>{e.has(h.canonicalString())||h.isKeyField()||t.Ie.push(new Ho(h,r))})),e.has($t.keyField().canonicalString())||t.Ie.push(new Ho($t.keyField(),r))}return t.Ie}function vi(i){const t=Et(i);return t.Ee||(t.Ee=mv(t,as(i))),t.Ee}function mv(i,t){if(i.limitType==="F")return ac(i.path,i.collectionGroup,t,i.filters,i.limit,i.startAt,i.endAt);{t=t.map((o=>{const h=o.dir==="desc"?"asc":"desc";return new Ho(o.field,h)}));const e=i.endAt?new zo(i.endAt.position,i.endAt.inclusive):null,r=i.startAt?new zo(i.startAt.position,i.startAt.inclusive):null;return ac(i.path,i.collectionGroup,t,i.filters,i.limit,e,r)}}function Ga(i,t,e){return new Qo(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),t,e,i.startAt,i.endAt)}function pd(i,t){return xu(vi(i),vi(t))&&i.limitType===t.limitType}function md(i){return`${ku(vi(i))}|lt:${i.limitType}`}function Yr(i){return`Query(target=${(function(e){let r=e.path.canonicalString();return e.collectionGroup!==null&&(r+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(r+=`, filters: [${e.filters.map((o=>dd(o))).join(", ")}]`),bu(e.limit)||(r+=", limit: "+e.limit),e.orderBy.length>0&&(r+=`, orderBy: [${e.orderBy.map((o=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(o))).join(", ")}]`),e.startAt&&(r+=", startAt: ",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((o=>yr(o))).join(",")),e.endAt&&(r+=", endAt: ",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((o=>yr(o))).join(",")),`Target(${r})`})(vi(i))}; limitType=${i.limitType})`}function Lu(i,t){return t.isFoundDocument()&&(function(r,o){const h=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(h):nt.isDocumentKey(r.path)?r.path.isEqual(h):r.path.isImmediateParentOf(h)})(i,t)&&(function(r,o){for(const h of as(r))if(!h.field.isKeyField()&&o.data.field(h.field)===null)return!1;return!0})(i,t)&&(function(r,o){for(const h of r.filters)if(!h.matches(o))return!1;return!0})(i,t)&&(function(r,o){return!(r.startAt&&!(function(l,m,_){const v=sc(l,m,_);return l.inclusive?v<=0:v<0})(r.startAt,as(r),o)||r.endAt&&!(function(l,m,_){const v=sc(l,m,_);return l.inclusive?v>=0:v>0})(r.endAt,as(r),o))})(i,t)}function _v(i){return(t,e)=>{let r=!1;for(const o of as(i)){const h=gv(o,t,e);if(h!==0)return h;r=r||o.field.isKeyField()}return 0}}function gv(i,t,e){const r=i.field.isKeyField()?nt.comparator(t.key,e.key):(function(h,l,m){const _=l.data.field(h),v=m.data.field(h);return _!==null&&v!==null?gr(_,v):it(42886)})(i.field,t,e);switch(i.dir){case"asc":return r;case"desc":return-1*r;default:return it(19790,{direction:i.dir})}}class Ri{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r!==void 0){for(const[o,h]of r)if(this.equalsFn(o,t))return h}}has(t){return this.get(t)!==void 0}set(t,e){const r=this.mapKeyFn(t),o=this.inner[r];if(o===void 0)return this.inner[r]=[[t,e]],void this.innerSize++;for(let h=0;h<o.length;h++)if(this.equalsFn(o[h][0],t))return void(o[h]=[t,e]);o.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],t))return r.length===1?delete this.inner[e]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(t){Er(this.inner,((e,r)=>{for(const[o,h]of r)t(o,h)}))}isEmpty(){return td(this.inner)}size(){return this.innerSize}}const yv=new pe(nt.comparator);function jo(){return yv}const _d=new pe(nt.comparator);function go(...i){let t=_d;for(const e of i)t=t.insert(e.key,e);return t}function gd(i){let t=_d;return i.forEach(((e,r)=>t=t.insert(e,r.overlayedDocument))),t}function pi(){return us()}function yd(){return us()}function us(){return new Ri((i=>i.toString()),((i,t)=>i.isEqual(t)))}const vv=new pe(nt.comparator),wv=new Jt(nt.comparator);function te(...i){let t=wv;for(const e of i)t=t.add(e);return t}const Tv=new Jt(yt);function Ev(){return Tv}function Ou(i,t){if(i.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vo(t)?"-0":t}}function vd(i){return{integerValue:""+i}}function Iv(i,t){return qy(t)?vd(t):Ou(i,t)}class Yo{constructor(){this._=void 0}}function Av(i,t,e){return i instanceof _s?(function(o,h){const l={fields:{[nd]:{stringValue:ed},[rd]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return h&&Su(h)&&(h=Cu(h)),h&&(l.fields[id]=h),{mapValue:l}})(e,t):i instanceof gs?Td(i,t):i instanceof ys?Ed(i,t):(function(o,h){const l=wd(o,h),m=hc(l)+hc(o.Ae);return qa(l)&&qa(o.Ae)?vd(m):Ou(o.serializer,m)})(i,t)}function Pv(i,t,e){return i instanceof gs?Td(i,t):i instanceof ys?Ed(i,t):e}function wd(i,t){return i instanceof Wo?(function(r){return qa(r)||(function(h){return!!h&&"doubleValue"in h})(r)})(t)?t:{integerValue:0}:null}class _s extends Yo{}class gs extends Yo{constructor(t){super(),this.elements=t}}function Td(i,t){const e=Id(t);for(const r of i.elements)e.some((o=>Ye(o,r)))||e.push(r);return{arrayValue:{values:e}}}class ys extends Yo{constructor(t){super(),this.elements=t}}function Ed(i,t){let e=Id(t);for(const r of i.elements)e=e.filter((o=>!Ye(o,r)));return{arrayValue:{values:e}}}class Wo extends Yo{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function hc(i){return Kt(i.integerValue||i.doubleValue)}function Id(i){return Ru(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class bv{constructor(t,e){this.field=t,this.transform=e}}function Sv(i,t){return i.field.isEqual(t.field)&&(function(r,o){return r instanceof gs&&o instanceof gs||r instanceof ys&&o instanceof ys?mr(r.elements,o.elements,Ye):r instanceof Wo&&o instanceof Wo?Ye(r.Ae,o.Ae):r instanceof _s&&o instanceof _s})(i.transform,t.transform)}class Cv{constructor(t,e){this.version=t,this.transformResults=e}}class gn{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new gn}static exists(t){return new gn(void 0,t)}static updateTime(t){return new gn(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function So(i,t){return i.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(i.updateTime):i.exists===void 0||i.exists===t.isFoundDocument()}class ta{}function Ad(i,t){if(!i.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return i.isNoDocument()?new bd(i.key,gn.none()):new bs(i.key,i.data,gn.none());{const e=i.data,r=Ne.empty();let o=new Jt($t.comparator);for(let h of t.fields)if(!o.has(h)){let l=e.field(h);l===null&&h.length>1&&(h=h.popLast(),l=e.field(h)),l===null?r.delete(h):r.set(h,l),o=o.add(h)}return new ki(i.key,r,new Ve(o.toArray()),gn.none())}}function Rv(i,t,e){i instanceof bs?(function(o,h,l){const m=o.value.clone(),_=lc(o.fieldTransforms,h,l.transformResults);m.setAll(_),h.convertToFoundDocument(l.version,m).setHasCommittedMutations()})(i,t,e):i instanceof ki?(function(o,h,l){if(!So(o.precondition,h))return void h.convertToUnknownDocument(l.version);const m=lc(o.fieldTransforms,h,l.transformResults),_=h.data;_.setAll(Pd(o)),_.setAll(m),h.convertToFoundDocument(l.version,_).setHasCommittedMutations()})(i,t,e):(function(o,h,l){h.convertToNoDocument(l.version).setHasCommittedMutations()})(0,t,e)}function hs(i,t,e,r){return i instanceof bs?(function(h,l,m,_){if(!So(h.precondition,l))return m;const v=h.value.clone(),A=dc(h.fieldTransforms,_,l);return v.setAll(A),l.convertToFoundDocument(l.version,v).setHasLocalMutations(),null})(i,t,e,r):i instanceof ki?(function(h,l,m,_){if(!So(h.precondition,l))return m;const v=dc(h.fieldTransforms,_,l),A=l.data;return A.setAll(Pd(h)),A.setAll(v),l.convertToFoundDocument(l.version,A).setHasLocalMutations(),m===null?null:m.unionWith(h.fieldMask.fields).unionWith(h.fieldTransforms.map((b=>b.field)))})(i,t,e,r):(function(h,l,m){return So(h.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):m})(i,t,e)}function kv(i,t){let e=null;for(const r of i.fieldTransforms){const o=t.data.field(r.field),h=wd(r.transform,o||null);h!=null&&(e===null&&(e=Ne.empty()),e.set(r.field,h))}return e||null}function cc(i,t){return i.type===t.type&&!!i.key.isEqual(t.key)&&!!i.precondition.isEqual(t.precondition)&&!!(function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&mr(r,o,((h,l)=>Sv(h,l)))})(i.fieldTransforms,t.fieldTransforms)&&(i.type===0?i.value.isEqual(t.value):i.type!==1||i.data.isEqual(t.data)&&i.fieldMask.isEqual(t.fieldMask))}class bs extends ta{constructor(t,e,r,o=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class ki extends ta{constructor(t,e,r,o,h=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=o,this.fieldTransforms=h,this.type=1}getFieldMask(){return this.fieldMask}}function Pd(i){const t=new Map;return i.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const r=i.data.field(e);t.set(e,r)}})),t}function lc(i,t,e){const r=new Map;kt(i.length===e.length,32656,{Ve:e.length,de:i.length});for(let o=0;o<e.length;o++){const h=i[o],l=h.transform,m=t.data.field(h.field);r.set(h.field,Pv(l,m,e[o]))}return r}function dc(i,t,e){const r=new Map;for(const o of i){const h=o.transform,l=e.data.field(o.field);r.set(o.field,Av(h,l,t))}return r}class bd extends ta{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xv extends ta{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Lv{constructor(t,e,r,o){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let o=0;o<this.mutations.length;o++){const h=this.mutations[o];h.key.isEqual(t.key)&&Rv(h,t,r[o])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=hs(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=hs(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=yd();return this.mutations.forEach((o=>{const h=t.get(o.key),l=h.overlayedDocument;let m=this.applyToLocalView(l,h.mutatedFields);m=e.has(o.key)?null:m;const _=Ad(l,m);_!==null&&r.set(o.key,_),l.isValidDocument()||l.convertToNoDocument(Pt.min())})),r}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),te())}isEqual(t){return this.batchId===t.batchId&&mr(this.mutations,t.mutations,((e,r)=>cc(e,r)))&&mr(this.baseMutations,t.baseMutations,((e,r)=>cc(e,r)))}}class Nu{constructor(t,e,r,o){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=o}static from(t,e,r){kt(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let o=(function(){return vv})();const h=t.mutations;for(let l=0;l<h.length;l++)o=o.insert(h[l].key,r[l].version);return new Nu(t,e,r,o)}}class Ov{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}var Mt,lt;function Nv(i){switch(i){case B.OK:return it(64938);case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0;default:return it(15467,{code:i})}}function Dv(i){if(i===void 0)return Pi("GRPC error has no .code"),B.UNKNOWN;switch(i){case Mt.OK:return B.OK;case Mt.CANCELLED:return B.CANCELLED;case Mt.UNKNOWN:return B.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return B.INTERNAL;case Mt.UNAVAILABLE:return B.UNAVAILABLE;case Mt.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Mt.NOT_FOUND:return B.NOT_FOUND;case Mt.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Mt.ABORTED:return B.ABORTED;case Mt.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Mt.DATA_LOSS:return B.DATA_LOSS;default:return it(39323,{code:i})}}(lt=Mt||(Mt={}))[lt.OK=0]="OK",lt[lt.CANCELLED=1]="CANCELLED",lt[lt.UNKNOWN=2]="UNKNOWN",lt[lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lt[lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lt[lt.NOT_FOUND=5]="NOT_FOUND",lt[lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",lt[lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",lt[lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",lt[lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lt[lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lt[lt.ABORTED=10]="ABORTED",lt[lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",lt[lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",lt[lt.INTERNAL=13]="INTERNAL",lt[lt.UNAVAILABLE=14]="UNAVAILABLE",lt[lt.DATA_LOSS=15]="DATA_LOSS";new vu([4294967295,4294967295],0);class Mv{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function Ka(i,t){return i.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Vv(i,t){return i.useProto3Json?t.toBase64():t.toUint8Array()}function Bv(i,t){return Ka(i,t.toTimestamp())}function lr(i){return kt(!!i,49232),Pt.fromTimestamp((function(e){const r=bi(e);return new bt(r.seconds,r.nanos)})(i))}function Sd(i,t){return $a(i,t).canonicalString()}function $a(i,t){const e=(function(o){return new St(["projects",o.projectId,"databases",o.database])})(i).child("documents");return t===void 0?e:e.child(t)}function Uv(i){const t=St.fromString(i);return kt(Gv(t),10190,{key:t.toString()}),t}function Ja(i,t){return Sd(i.databaseId,t.path)}function Fv(i){const t=Uv(i);return t.length===4?St.emptyPath():Hv(t)}function zv(i){return new St(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function Hv(i){return kt(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function fc(i,t,e){return{name:Ja(i,t),fields:e.value.mapValue.fields}}function jv(i,t){let e;if(t instanceof bs)e={update:fc(i,t.key,t.value)};else if(t instanceof bd)e={delete:Ja(i,t.key)};else if(t instanceof ki)e={update:fc(i,t.key,t.data),updateMask:Zv(t.fieldMask)};else{if(!(t instanceof xv))return it(16599,{dt:t.type});e={verify:Ja(i,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((r=>(function(h,l){const m=l.transform;if(m instanceof _s)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof gs)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof ys)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof Wo)return{fieldPath:l.field.canonicalString(),increment:m.Ae};throw it(20930,{transform:l.transform})})(0,r)))),t.precondition.isNone||(e.currentDocument=(function(o,h){return h.updateTime!==void 0?{updateTime:Bv(o,h.updateTime)}:h.exists!==void 0?{exists:h.exists}:it(27497)})(i,t.precondition)),e}function Wv(i,t){return i&&i.length>0?(kt(t!==void 0,14353),i.map((e=>(function(o,h){let l=o.updateTime?lr(o.updateTime):lr(h);return l.isEqual(Pt.min())&&(l=lr(h)),new Cv(l,o.transformResults||[])})(e,t)))):[]}function qv(i){let t=Fv(i.parent);const e=i.structuredQuery,r=e.from?e.from.length:0;let o=null;if(r>0){kt(r===1,65062);const A=e.from[0];A.allDescendants?o=A.collectionId:t=t.child(A.collectionId)}let h=[];e.where&&(h=(function(b){const R=Cd(b);return R instanceof qn&&cd(R)?R.getFilters():[R]})(e.where));let l=[];e.orderBy&&(l=(function(b){return b.map((R=>(function(z){return new Ho(or(z.field),(function(G){switch(G){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(z.direction))})(R)))})(e.orderBy));let m=null;e.limit&&(m=(function(b){let R;return R=typeof b=="object"?b.value:b,bu(R)?null:R})(e.limit));let _=null;e.startAt&&(_=(function(b){const R=!!b.before,U=b.values||[];return new zo(U,R)})(e.startAt));let v=null;return e.endAt&&(v=(function(b){const R=!b.before,U=b.values||[];return new zo(U,R)})(e.endAt)),lv(t,o,l,h,m,"F",_,v)}function Cd(i){return i.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const r=or(e.unaryFilter.field);return Wt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=or(e.unaryFilter.field);return Wt.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const h=or(e.unaryFilter.field);return Wt.create(h,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=or(e.unaryFilter.field);return Wt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}})(i):i.fieldFilter!==void 0?(function(e){return Wt.create(or(e.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(e){return qn.create(e.compositeFilter.filters.map((r=>Cd(r))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return it(1026)}})(e.compositeFilter.op))})(i):it(30097,{filter:i})}function or(i){return $t.fromServerFormat(i.fieldPath)}function Zv(i){const t=[];return i.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Gv(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}function Rd(i){return!!i&&typeof i._toProto=="function"&&i._protoValueType==="ProtoValue"}class Kv{constructor(t){this.yt=t}}function $v(i){const t=qv({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?Ga(t,t.limit,"L"):t}class Jv{constructor(){this.Sn=new Xv}addToCollectionParentIndex(t,e){return this.Sn.add(e),M.resolve()}getCollectionParents(t,e){return M.resolve(this.Sn.getEntries(e))}addFieldIndex(t,e){return M.resolve()}deleteFieldIndex(t,e){return M.resolve()}deleteAllFieldIndexes(t){return M.resolve()}createTargetIndexes(t,e){return M.resolve()}getDocumentsMatchingTarget(t,e){return M.resolve(null)}getIndexType(t,e){return M.resolve(0)}getFieldIndexes(t,e){return M.resolve([])}getNextCollectionGroupToUpdate(t){return M.resolve(null)}getMinOffset(t,e){return M.resolve(Wn.min())}getMinOffsetFromCollectionGroup(t,e){return M.resolve(Wn.min())}updateCollectionGroup(t,e,r){return M.resolve()}updateIndexEntries(t,e){return M.resolve()}}class Xv{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),o=this.index[e]||new Jt(St.comparator),h=!o.has(r);return this.index[e]=o.add(r),h}has(t){const e=t.lastSegment(),r=t.popLast(),o=this.index[e];return o&&o.has(r)}getEntries(t){return(this.index[t]||new Jt(St.comparator)).toArray()}}const pc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kd=41943040;class fe{static withCacheSize(t){return new fe(t,fe.DEFAULT_COLLECTION_PERCENTILE,fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}}fe.DEFAULT_COLLECTION_PERCENTILE=10,fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fe.DEFAULT=new fe(kd,fe.DEFAULT_COLLECTION_PERCENTILE,fe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fe.DISABLED=new fe(-1,0,0);class vr{constructor(t){this.sr=t}next(){return this.sr+=2,this.sr}static _r(){return new vr(0)}static ar(){return new vr(-1)}}const mc="LruGarbageCollector",Qv=1048576;function _c([i,t],[e,r]){const o=yt(i,e);return o===0?yt(t,r):o}class Yv{constructor(t){this.Pr=t,this.buffer=new Jt(_c),this.Tr=0}Ir(){return++this.Tr}Er(t){const e=[t,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(e);else{const r=this.buffer.last();_c(e,r)<0&&(this.buffer=this.buffer.delete(r).add(e))}}get maxValue(){return this.buffer.last()[0]}}class tw{constructor(t,e,r){this.garbageCollector=t,this.asyncQueue=e,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(t){Z(mc,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ps(e)?Z(mc,"Ignoring IndexedDB error during garbage collection: ",e):await Iu(e)}await this.Ar(3e5)}))}}class ew{constructor(t,e){this.Vr=t,this.params=e}calculateTargetCount(t,e){return this.Vr.dr(t).next((r=>Math.floor(e/100*r)))}nthSequenceNumber(t,e){if(e===0)return M.resolve(Au.ce);const r=new Yv(e);return this.Vr.forEachTarget(t,(o=>r.Er(o.sequenceNumber))).next((()=>this.Vr.mr(t,(o=>r.Er(o))))).next((()=>r.maxValue))}removeTargets(t,e,r){return this.Vr.removeTargets(t,e,r)}removeOrphanedDocuments(t,e){return this.Vr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),M.resolve(pc)):this.getCacheSize(t).next((r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),pc):this.gr(t,e)))}getCacheSize(t){return this.Vr.getCacheSize(t)}gr(t,e){let r,o,h,l,m,_,v;const A=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),o=this.params.maximumSequenceNumbersToCollect):o=b,l=Date.now(),this.nthSequenceNumber(t,o)))).next((b=>(r=b,m=Date.now(),this.removeTargets(t,r,e)))).next((b=>(h=b,_=Date.now(),this.removeOrphanedDocuments(t,r)))).next((b=>(v=Date.now(),sr()<=ht.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-A}ms
	Determined least recently used ${o} in `+(m-l)+`ms
	Removed ${h} targets in `+(_-m)+`ms
	Removed ${b} documents in `+(v-_)+`ms
Total Duration: ${v-A}ms`),M.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:h,documentsRemoved:b}))))}}function nw(i,t){return new ew(i,t)}class iw{constructor(){this.changes=new Ri((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Le.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return r!==void 0?M.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class rw{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class sw{constructor(t,e,r,o){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=o}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next((o=>(r=o,this.remoteDocumentCache.getEntry(t,e)))).next((o=>(r!==null&&hs(r.mutation,o,Ve.empty(),bt.now()),o)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.getLocalViewOfDocuments(t,r,te()).next((()=>r))))}getLocalViewOfDocuments(t,e,r=te()){const o=pi();return this.populateOverlays(t,o,e).next((()=>this.computeViews(t,e,o,r).next((h=>{let l=go();return h.forEach(((m,_)=>{l=l.insert(m,_.overlayedDocument)})),l}))))}getOverlayedDocuments(t,e){const r=pi();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,te())))}populateOverlays(t,e,r){const o=[];return r.forEach((h=>{e.has(h)||o.push(h)})),this.documentOverlayCache.getOverlays(t,o).next((h=>{h.forEach(((l,m)=>{e.set(l,m)}))}))}computeViews(t,e,r,o){let h=jo();const l=us(),m=(function(){return us()})();return e.forEach(((_,v)=>{const A=r.get(v.key);o.has(v.key)&&(A===void 0||A.mutation instanceof ki)?h=h.insert(v.key,v):A!==void 0?(l.set(v.key,A.mutation.getFieldMask()),hs(A.mutation,v,A.mutation.getFieldMask(),bt.now())):l.set(v.key,Ve.empty())})),this.recalculateAndSaveOverlays(t,h).next((_=>(_.forEach(((v,A)=>l.set(v,A))),e.forEach(((v,A)=>m.set(v,new rw(A,l.get(v)??null)))),m)))}recalculateAndSaveOverlays(t,e){const r=us();let o=new pe(((l,m)=>l-m)),h=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((l=>{for(const m of l)m.keys().forEach((_=>{const v=e.get(_);if(v===null)return;let A=r.get(_)||Ve.empty();A=m.applyToLocalView(v,A),r.set(_,A);const b=(o.get(m.batchId)||te()).add(_);o=o.insert(m.batchId,b)}))})).next((()=>{const l=[],m=o.getReverseIterator();for(;m.hasNext();){const _=m.getNext(),v=_.key,A=_.value,b=yd();A.forEach((R=>{if(!h.has(R)){const U=Ad(e.get(R),r.get(R));U!==null&&b.set(R,U),h=h.add(R)}})),l.push(this.documentOverlayCache.saveOverlays(t,v,b))}return M.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((r=>this.recalculateAndSaveOverlays(t,r)))}getDocumentsMatchingQuery(t,e,r,o){return fv(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):pv(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r,o):this.getDocumentsMatchingCollectionQuery(t,e,r,o)}getNextDocuments(t,e,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,o).next((h=>{const l=o-h.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,o-h.size):M.resolve(pi());let m=ps,_=h;return l.next((v=>M.forEach(v,((A,b)=>(m<b.largestBatchId&&(m=b.largestBatchId),h.get(A)?M.resolve():this.remoteDocumentCache.getEntry(t,A).next((R=>{_=_.insert(A,R)}))))).next((()=>this.populateOverlays(t,v,h))).next((()=>this.computeViews(t,_,v,te()))).next((A=>({batchId:m,changes:gd(A)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new nt(e)).next((r=>{let o=go();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o}))}getDocumentsMatchingCollectionGroupQuery(t,e,r,o){const h=e.collectionGroup;let l=go();return this.indexManager.getCollectionParents(t,h).next((m=>M.forEach(m,(_=>{const v=(function(b,R){return new Qo(R,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(e,_.child(h));return this.getDocumentsMatchingCollectionQuery(t,v,r,o).next((A=>{A.forEach(((b,R)=>{l=l.insert(b,R)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(t,e,r,o){let h;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId).next((l=>(h=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,r,h,o)))).next((l=>{h.forEach(((_,v)=>{const A=v.getKey();l.get(A)===null&&(l=l.insert(A,Le.newInvalidDocument(A)))}));let m=go();return l.forEach(((_,v)=>{const A=h.get(_);A!==void 0&&hs(A.mutation,v,Ve.empty(),bt.now()),Lu(e,v)&&(m=m.insert(_,v))})),m}))}}class ow{constructor(t){this.serializer=t,this.Nr=new Map,this.Br=new Map}getBundleMetadata(t,e){return M.resolve(this.Nr.get(e))}saveBundleMetadata(t,e){return this.Nr.set(e.id,(function(o){return{id:o.id,version:o.version,createTime:lr(o.createTime)}})(e)),M.resolve()}getNamedQuery(t,e){return M.resolve(this.Br.get(e))}saveNamedQuery(t,e){return this.Br.set(e.name,(function(o){return{name:o.name,query:$v(o.bundledQuery),readTime:lr(o.readTime)}})(e)),M.resolve()}}class aw{constructor(){this.overlays=new pe(nt.comparator),this.Lr=new Map}getOverlay(t,e){return M.resolve(this.overlays.get(e))}getOverlays(t,e){const r=pi();return M.forEach(e,(o=>this.getOverlay(t,o).next((h=>{h!==null&&r.set(o,h)})))).next((()=>r))}saveOverlays(t,e,r){return r.forEach(((o,h)=>{this.bt(t,e,h)})),M.resolve()}removeOverlaysForBatchId(t,e,r){const o=this.Lr.get(r);return o!==void 0&&(o.forEach((h=>this.overlays=this.overlays.remove(h))),this.Lr.delete(r)),M.resolve()}getOverlaysForCollection(t,e,r){const o=pi(),h=e.length+1,l=new nt(e.child("")),m=this.overlays.getIteratorFrom(l);for(;m.hasNext();){const _=m.getNext().value,v=_.getKey();if(!e.isPrefixOf(v.path))break;v.path.length===h&&_.largestBatchId>r&&o.set(_.getKey(),_)}return M.resolve(o)}getOverlaysForCollectionGroup(t,e,r,o){let h=new pe(((v,A)=>v-A));const l=this.overlays.getIterator();for(;l.hasNext();){const v=l.getNext().value;if(v.getKey().getCollectionGroup()===e&&v.largestBatchId>r){let A=h.get(v.largestBatchId);A===null&&(A=pi(),h=h.insert(v.largestBatchId,A)),A.set(v.getKey(),v)}}const m=pi(),_=h.getIterator();for(;_.hasNext()&&(_.getNext().value.forEach(((v,A)=>m.set(v,A))),!(m.size()>=o)););return M.resolve(m)}bt(t,e,r){const o=this.overlays.get(r.key);if(o!==null){const l=this.Lr.get(o.largestBatchId).delete(r.key);this.Lr.set(o.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new Ov(e,r));let h=this.Lr.get(e);h===void 0&&(h=te(),this.Lr.set(e,h)),this.Lr.set(e,h.add(r.key))}}class uw{constructor(){this.sessionToken=Qe.EMPTY_BYTE_STRING}getSessionToken(t){return M.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,M.resolve()}}class Du{constructor(){this.kr=new Jt(jt.Kr),this.qr=new Jt(jt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(t,e){const r=new jt(t,e);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(t,e){t.forEach((r=>this.addReference(r,e)))}removeReference(t,e){this.Wr(new jt(t,e))}Qr(t,e){t.forEach((r=>this.removeReference(r,e)))}Gr(t){const e=new nt(new St([])),r=new jt(e,t),o=new jt(e,t+1),h=[];return this.qr.forEachInRange([r,o],(l=>{this.Wr(l),h.push(l.key)})),h}zr(){this.kr.forEach((t=>this.Wr(t)))}Wr(t){this.kr=this.kr.delete(t),this.qr=this.qr.delete(t)}jr(t){const e=new nt(new St([])),r=new jt(e,t),o=new jt(e,t+1);let h=te();return this.qr.forEachInRange([r,o],(l=>{h=h.add(l.key)})),h}containsKey(t){const e=new jt(t,0),r=this.kr.firstAfterOrEqual(e);return r!==null&&t.isEqual(r.key)}}class jt{constructor(t,e){this.key=t,this.Hr=e}static Kr(t,e){return nt.comparator(t.key,e.key)||yt(t.Hr,e.Hr)}static Ur(t,e){return yt(t.Hr,e.Hr)||nt.comparator(t.key,e.key)}}class hw{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Yn=1,this.Jr=new Jt(jt.Kr)}checkEmpty(t){return M.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,r,o){const h=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new Lv(h,e,r,o);this.mutationQueue.push(l);for(const m of o)this.Jr=this.Jr.add(new jt(m.key,h)),this.indexManager.addToCollectionParentIndex(t,m.key.path.popLast());return M.resolve(l)}lookupMutationBatch(t,e){return M.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const r=e+1,o=this.Xr(r),h=o<0?0:o;return M.resolve(this.mutationQueue.length>h?this.mutationQueue[h]:null)}getHighestUnacknowledgedBatchId(){return M.resolve(this.mutationQueue.length===0?Pu:this.Yn-1)}getAllMutationBatches(t){return M.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new jt(e,0),o=new jt(e,Number.POSITIVE_INFINITY),h=[];return this.Jr.forEachInRange([r,o],(l=>{const m=this.Zr(l.Hr);h.push(m)})),M.resolve(h)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new Jt(yt);return e.forEach((o=>{const h=new jt(o,0),l=new jt(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([h,l],(m=>{r=r.add(m.Hr)}))})),M.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,o=r.length+1;let h=r;nt.isDocumentKey(h)||(h=h.child(""));const l=new jt(new nt(h),0);let m=new Jt(yt);return this.Jr.forEachWhile((_=>{const v=_.key.path;return!!r.isPrefixOf(v)&&(v.length===o&&(m=m.add(_.Hr)),!0)}),l),M.resolve(this.Yr(m))}Yr(t){const e=[];return t.forEach((r=>{const o=this.Zr(r);o!==null&&e.push(o)})),e}removeMutationBatch(t,e){kt(this.ei(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return M.forEach(e.mutations,(o=>{const h=new jt(o.key,e.batchId);return r=r.delete(h),this.referenceDelegate.markPotentiallyOrphaned(t,o.key)})).next((()=>{this.Jr=r}))}nr(t){}containsKey(t,e){const r=new jt(e,0),o=this.Jr.firstAfterOrEqual(r);return M.resolve(e.isEqual(o&&o.key))}performConsistencyCheck(t){return this.mutationQueue.length,M.resolve()}ei(t,e){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class cw{constructor(t){this.ti=t,this.docs=(function(){return new pe(nt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,o=this.docs.get(r),h=o?o.size:0,l=this.ti(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:l}),this.size+=l-h,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return M.resolve(r?r.document.mutableCopy():Le.newInvalidDocument(e))}getEntries(t,e){let r=jo();return e.forEach((o=>{const h=this.docs.get(o);r=r.insert(o,h?h.document.mutableCopy():Le.newInvalidDocument(o))})),M.resolve(r)}getDocumentsMatchingQuery(t,e,r,o){let h=jo();const l=e.path,m=new nt(l.child("__id-9223372036854775808__")),_=this.docs.getIteratorFrom(m);for(;_.hasNext();){const{key:v,value:{document:A}}=_.getNext();if(!l.isPrefixOf(v.path))break;v.path.length>l.length+1||zy(Fy(A),r)<=0||(o.has(A.key)||Lu(e,A))&&(h=h.insert(A.key,A.mutableCopy()))}return M.resolve(h)}getAllFromCollectionGroup(t,e,r,o){it(9500)}ni(t,e){return M.forEach(this.docs,(r=>e(r)))}newChangeBuffer(t){return new lw(this)}getSize(t){return M.resolve(this.size)}}class lw extends iw{constructor(t){super(),this.Mr=t}applyChanges(t){const e=[];return this.changes.forEach(((r,o)=>{o.isValidDocument()?e.push(this.Mr.addEntry(t,o)):this.Mr.removeEntry(r)})),M.waitFor(e)}getFromCache(t,e){return this.Mr.getEntry(t,e)}getAllFromCache(t,e){return this.Mr.getEntries(t,e)}}class dw{constructor(t){this.persistence=t,this.ri=new Ri((e=>ku(e)),xu),this.lastRemoteSnapshotVersion=Pt.min(),this.highestTargetId=0,this.ii=0,this.si=new Du,this.targetCount=0,this.oi=vr._r()}forEachTarget(t,e){return this.ri.forEach(((r,o)=>e(o))),M.resolve()}getLastRemoteSnapshotVersion(t){return M.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return M.resolve(this.ii)}allocateTargetId(t){return this.highestTargetId=this.oi.next(),M.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.ii&&(this.ii=e),M.resolve()}lr(t){this.ri.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.oi=new vr(e),this.highestTargetId=e),t.sequenceNumber>this.ii&&(this.ii=t.sequenceNumber)}addTargetData(t,e){return this.lr(e),this.targetCount+=1,M.resolve()}updateTargetData(t,e){return this.lr(e),M.resolve()}removeTargetData(t,e){return this.ri.delete(e.target),this.si.Gr(e.targetId),this.targetCount-=1,M.resolve()}removeTargets(t,e,r){let o=0;const h=[];return this.ri.forEach(((l,m)=>{m.sequenceNumber<=e&&r.get(m.targetId)===null&&(this.ri.delete(l),h.push(this.removeMatchingKeysForTargetId(t,m.targetId)),o++)})),M.waitFor(h).next((()=>o))}getTargetCount(t){return M.resolve(this.targetCount)}getTargetData(t,e){const r=this.ri.get(e)||null;return M.resolve(r)}addMatchingKeys(t,e,r){return this.si.$r(e,r),M.resolve()}removeMatchingKeys(t,e,r){this.si.Qr(e,r);const o=this.persistence.referenceDelegate,h=[];return o&&e.forEach((l=>{h.push(o.markPotentiallyOrphaned(t,l))})),M.waitFor(h)}removeMatchingKeysForTargetId(t,e){return this.si.Gr(e),M.resolve()}getMatchingKeysForTargetId(t,e){const r=this.si.jr(e);return M.resolve(r)}containsKey(t,e){return M.resolve(this.si.containsKey(e))}}class xd{constructor(t,e){this._i={},this.overlays={},this.ai=new Au(0),this.ui=!1,this.ui=!0,this.ci=new uw,this.referenceDelegate=t(this),this.li=new dw(this),this.indexManager=new Jv,this.remoteDocumentCache=(function(o){return new cw(o)})((r=>this.referenceDelegate.hi(r))),this.serializer=new Kv(e),this.Pi=new ow(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new aw,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this._i[t.toKey()];return r||(r=new hw(e,this.referenceDelegate),this._i[t.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(t,e,r){Z("MemoryPersistence","Starting transaction:",t);const o=new fw(this.ai.next());return this.referenceDelegate.Ti(),r(o).next((h=>this.referenceDelegate.Ii(o).next((()=>h)))).toPromise().then((h=>(o.raiseOnCommittedEvent(),h)))}Ei(t,e){return M.or(Object.values(this._i).map((r=>()=>r.containsKey(t,e))))}}class fw extends jy{constructor(t){super(),this.currentSequenceNumber=t}}class Mu{constructor(t){this.persistence=t,this.Ri=new Du,this.Ai=null}static Vi(t){return new Mu(t)}get di(){if(this.Ai)return this.Ai;throw it(60996)}addReference(t,e,r){return this.Ri.addReference(r,e),this.di.delete(r.toString()),M.resolve()}removeReference(t,e,r){return this.Ri.removeReference(r,e),this.di.add(r.toString()),M.resolve()}markPotentiallyOrphaned(t,e){return this.di.add(e.toString()),M.resolve()}removeTarget(t,e){this.Ri.Gr(e.targetId).forEach((o=>this.di.add(o.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((o=>{o.forEach((h=>this.di.add(h.toString())))})).next((()=>r.removeTargetData(t,e)))}Ti(){this.Ai=new Set}Ii(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return M.forEach(this.di,(r=>{const o=nt.fromPath(r);return this.mi(t,o).next((h=>{h||e.removeEntry(o,Pt.min())}))})).next((()=>(this.Ai=null,e.apply(t))))}updateLimboDocument(t,e){return this.mi(t,e).next((r=>{r?this.di.delete(e.toString()):this.di.add(e.toString())}))}hi(t){return 0}mi(t,e){return M.or([()=>M.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class qo{constructor(t,e){this.persistence=t,this.fi=new Ri((r=>Zy(r.path)),((r,o)=>r.isEqual(o))),this.garbageCollector=nw(this,e)}static Vi(t,e){return new qo(t,e)}Ti(){}Ii(t){return M.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}dr(t){const e=this.pr(t);return this.persistence.getTargetCache().getTargetCount(t).next((r=>e.next((o=>r+o))))}pr(t){let e=0;return this.mr(t,(r=>{e++})).next((()=>e))}mr(t,e){return M.forEach(this.fi,((r,o)=>this.wr(t,r,o).next((h=>h?M.resolve():e(o)))))}removeTargets(t,e,r){return this.persistence.getTargetCache().removeTargets(t,e,r)}removeOrphanedDocuments(t,e){let r=0;const o=this.persistence.getRemoteDocumentCache(),h=o.newChangeBuffer();return o.ni(t,(l=>this.wr(t,l,e).next((m=>{m||(r++,h.removeEntry(l,Pt.min()))})))).next((()=>h.apply(t))).next((()=>r))}markPotentiallyOrphaned(t,e){return this.fi.set(e,t.currentSequenceNumber),M.resolve()}removeTarget(t,e){const r=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,r)}addReference(t,e,r){return this.fi.set(r,t.currentSequenceNumber),M.resolve()}removeReference(t,e,r){return this.fi.set(r,t.currentSequenceNumber),M.resolve()}updateLimboDocument(t,e){return this.fi.set(e,t.currentSequenceNumber),M.resolve()}hi(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Po(t.data.value)),e}wr(t,e,r){return M.or([()=>this.persistence.Ei(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const o=this.fi.get(e);return M.resolve(o!==void 0&&o>r)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class Vu{constructor(t,e,r,o){this.targetId=t,this.fromCache=e,this.Ts=r,this.Is=o}static Es(t,e){let r=te(),o=te();for(const h of e.docChanges)switch(h.type){case 0:r=r.add(h.doc.key);break;case 1:o=o.add(h.doc.key)}return new Vu(t,e.fromCache,r,o)}}class pw{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class mw{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return $f()?8:Wy(ne())>0?6:4})()}initialize(t,e){this.fs=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,r,o){const h={result:null};return this.gs(t,e).next((l=>{h.result=l})).next((()=>{if(!h.result)return this.ps(t,e,o,r).next((l=>{h.result=l}))})).next((()=>{if(h.result)return;const l=new pw;return this.ys(t,e,l).next((m=>{if(h.result=m,this.As)return this.ws(t,e,l,m.size)}))})).next((()=>h.result))}ws(t,e,r,o){return r.documentReadCount<this.Vs?(sr()<=ht.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",Yr(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),M.resolve()):(sr()<=ht.DEBUG&&Z("QueryEngine","Query:",Yr(e),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ds*o?(sr()<=ht.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",Yr(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,vi(e))):M.resolve())}gs(t,e){if(uc(e))return M.resolve(null);let r=vi(e);return this.indexManager.getIndexType(t,r).next((o=>o===0?null:(e.limit!==null&&o===1&&(e=Ga(e,null,"F"),r=vi(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next((h=>{const l=te(...h);return this.fs.getDocuments(t,l).next((m=>this.indexManager.getMinOffset(t,r).next((_=>{const v=this.bs(e,m);return this.Ss(e,v,l,_.readTime)?this.gs(t,Ga(e,null,"F")):this.Ds(t,v,e,_)}))))})))))}ps(t,e,r,o){return uc(e)||o.isEqual(Pt.min())?M.resolve(null):this.fs.getDocuments(t,r).next((h=>{const l=this.bs(e,h);return this.Ss(e,l,r,o)?M.resolve(null):(sr()<=ht.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Yr(e)),this.Ds(t,l,e,Uy(o,ps)).next((m=>m)))}))}bs(t,e){let r=new Jt(_v(t));return e.forEach(((o,h)=>{Lu(t,h)&&(r=r.add(h))})),r}Ss(t,e,r,o){if(t.limit===null)return!1;if(r.size!==e.size)return!0;const h=t.limitType==="F"?e.last():e.first();return!!h&&(h.hasPendingWrites||h.version.compareTo(o)>0)}ys(t,e,r){return sr()<=ht.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",Yr(e)),this.fs.getDocumentsMatchingQuery(t,e,Wn.min(),r)}Ds(t,e,r,o){return this.fs.getDocumentsMatchingQuery(t,r,o).next((h=>(e.forEach((l=>{h=h.insert(l.key,l)})),h)))}}const _w="LocalStore";class gw{constructor(t,e,r,o){this.persistence=t,this.Cs=e,this.serializer=o,this.vs=new pe(yt),this.Fs=new Ri((h=>ku(h)),xu),this.Ms=new Map,this.xs=t.getRemoteDocumentCache(),this.li=t.getTargetCache(),this.Pi=t.getBundleCache(),this.Os(r)}Os(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new sw(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.vs)))}}function yw(i,t,e,r){return new gw(i,t,e,r)}async function Ld(i,t){const e=Et(i);return await e.persistence.runTransaction("Handle user change","readonly",(r=>{let o;return e.mutationQueue.getAllMutationBatches(r).next((h=>(o=h,e.Os(t),e.mutationQueue.getAllMutationBatches(r)))).next((h=>{const l=[],m=[];let _=te();for(const v of o){l.push(v.batchId);for(const A of v.mutations)_=_.add(A.key)}for(const v of h){m.push(v.batchId);for(const A of v.mutations)_=_.add(A.key)}return e.localDocuments.getDocuments(r,_).next((v=>({Ns:v,removedBatchIds:l,addedBatchIds:m})))}))}))}function vw(i,t){const e=Et(i);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const o=t.batch.keys(),h=e.xs.newChangeBuffer({trackRemovals:!0});return(function(m,_,v,A){const b=v.batch,R=b.keys();let U=M.resolve();return R.forEach((z=>{U=U.next((()=>A.getEntry(_,z))).next((H=>{const G=v.docVersions.get(z);kt(G!==null,48541),H.version.compareTo(G)<0&&(b.applyToRemoteDocument(H,v),H.isValidDocument()&&(H.setReadTime(v.commitVersion),A.addEntry(H)))}))})),U.next((()=>m.mutationQueue.removeMutationBatch(_,b)))})(e,r,t,h).next((()=>h.apply(r))).next((()=>e.mutationQueue.performConsistencyCheck(r))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(r,o,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(m){let _=te();for(let v=0;v<m.mutationResults.length;++v)m.mutationResults[v].transformResults.length>0&&(_=_.add(m.batch.mutations[v].key));return _})(t)))).next((()=>e.localDocuments.getDocuments(r,o)))}))}function ww(i){const t=Et(i);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.li.getLastRemoteSnapshotVersion(e)))}function Tw(i,t){const e=Et(i);return e.persistence.runTransaction("Get next mutation batch","readonly",(r=>(t===void 0&&(t=Pu),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t))))}class gc{constructor(){this.activeTargetIds=Ev()}Qs(t){this.activeTargetIds=this.activeTargetIds.add(t)}Gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Ew{constructor(){this.vo=new gc,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t,e=!0){return e&&this.vo.Qs(t),this.Fo[t]||"not-current"}updateQueryState(t,e,r){this.Fo[t]=e}removeLocalQueryTarget(t){this.vo.Gs(t)}isLocalQueryTarget(t){return this.vo.activeTargetIds.has(t)}clearQueryState(t){delete this.Fo[t]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(t){return this.vo.activeTargetIds.has(t)}start(){return this.vo=new gc,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Iw{Mo(t){}shutdown(){}}const yc="ConnectivityMonitor";class vc{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(t){this.Lo.push(t)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Z(yc,"Network connectivity changed: AVAILABLE");for(const t of this.Lo)t(0)}Bo(){Z(yc,"Network connectivity changed: UNAVAILABLE");for(const t of this.Lo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let yo=null;function Xa(){return yo===null?yo=(function(){return 268435456+Math.round(2147483648*Math.random())})():yo++,"0x"+yo.toString(16)}const Ra="RestConnection",Aw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Pw{get Ko(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=e+"://"+t.host,this.Uo=`projects/${r}/databases/${o}`,this.$o=this.databaseId.database===Uo?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Wo(t,e,r,o,h){const l=Xa(),m=this.Qo(t,e.toUriEncodedString());Z(Ra,`Sending RPC '${t}' ${l}:`,m,r);const _={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(_,o,h);const{host:v}=new URL(m),A=Kn(v);return this.zo(t,m,_,r,A).then((b=>(Z(Ra,`Received RPC '${t}' ${l}: `,b),b)),(b=>{throw fs(Ra,`RPC '${t}' ${l} failed with error: `,b,"url: ",m,"request:",r),b}))}jo(t,e,r,o,h,l){return this.Wo(t,e,r,o,h)}Go(t,e,r){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Tr})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((o,h)=>t[h]=o)),r&&r.headers.forEach(((o,h)=>t[h]=o))}Qo(t,e){const r=Aw[t];let o=`${this.qo}/v1/${e}:${r}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}class bw{constructor(t){this.Ho=t.Ho,this.Jo=t.Jo}Zo(t){this.Xo=t}Yo(t){this.e_=t}t_(t){this.n_=t}onMessage(t){this.r_=t}close(){this.Jo()}send(t){this.Ho(t)}i_(){this.Xo()}s_(){this.e_()}o_(t){this.n_(t)}__(t){this.r_(t)}}const Qt="WebChannelConnection",ts=(i,t,e)=>{i.listen(t,(r=>{try{e(r)}catch(o){setTimeout((()=>{throw o}),0)}}))};class dr extends Pw{constructor(t){super(t),this.a_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}static u_(){if(!dr.c_){const t=Zl();ts(t,ql.STAT_EVENT,(e=>{e.stat===za.PROXY?Z(Qt,"STAT_EVENT: detected buffering proxy"):e.stat===za.NOPROXY&&Z(Qt,"STAT_EVENT: detected no buffering proxy")})),dr.c_=!0}}zo(t,e,r,o,h){const l=Xa();return new Promise(((m,_)=>{const v=new jl;v.setWithCredentials(!0),v.listenOnce(Wl.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case Ao.NO_ERROR:const b=v.getResponseJson();Z(Qt,`XHR for RPC '${t}' ${l} received:`,JSON.stringify(b)),m(b);break;case Ao.TIMEOUT:Z(Qt,`RPC '${t}' ${l} timed out`),_(new K(B.DEADLINE_EXCEEDED,"Request time out"));break;case Ao.HTTP_ERROR:const R=v.getStatus();if(Z(Qt,`RPC '${t}' ${l} failed with status:`,R,"response text:",v.getResponseText()),R>0){let U=v.getResponseJson();Array.isArray(U)&&(U=U[0]);const z=U?.error;if(z&&z.status&&z.message){const H=(function(at){const ut=at.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(ut)>=0?ut:B.UNKNOWN})(z.status);_(new K(H,z.message))}else _(new K(B.UNKNOWN,"Server responded with status "+v.getStatus()))}else _(new K(B.UNAVAILABLE,"Connection failed."));break;default:it(9055,{l_:t,streamId:l,h_:v.getLastErrorCode(),P_:v.getLastError()})}}finally{Z(Qt,`RPC '${t}' ${l} completed.`)}}));const A=JSON.stringify(o);Z(Qt,`RPC '${t}' ${l} sending request:`,o),v.send(e,"POST",A,r,15)}))}T_(t,e,r){const o=Xa(),h=[this.qo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},_=this.longPollingOptions.timeoutSeconds;_!==void 0&&(m.longPollingTimeout=Math.round(1e3*_)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,e,r),m.encodeInitMessageHeaders=!0;const v=h.join("");Z(Qt,`Creating RPC '${t}' stream ${o}: ${v}`,m);const A=l.createWebChannel(v,m);this.I_(A);let b=!1,R=!1;const U=new bw({Ho:z=>{R?Z(Qt,`Not sending because RPC '${t}' stream ${o} is closed:`,z):(b||(Z(Qt,`Opening RPC '${t}' stream ${o} transport.`),A.open(),b=!0),Z(Qt,`RPC '${t}' stream ${o} sending:`,z),A.send(z))},Jo:()=>A.close()});return ts(A,es.EventType.OPEN,(()=>{R||(Z(Qt,`RPC '${t}' stream ${o} transport opened.`),U.i_())})),ts(A,es.EventType.CLOSE,(()=>{R||(R=!0,Z(Qt,`RPC '${t}' stream ${o} transport closed`),U.o_(),this.E_(A))})),ts(A,es.EventType.ERROR,(z=>{R||(R=!0,fs(Qt,`RPC '${t}' stream ${o} transport errored. Name:`,z.name,"Message:",z.message),U.o_(new K(B.UNAVAILABLE,"The operation could not be completed")))})),ts(A,es.EventType.MESSAGE,(z=>{if(!R){const H=z.data[0];kt(!!H,16349);const G=H,at=G?.error||G[0]?.error;if(at){Z(Qt,`RPC '${t}' stream ${o} received error:`,at);const ut=at.status;let et=(function(Ct){const S=Mt[Ct];if(S!==void 0)return Dv(S)})(ut),dt=at.message;ut==="NOT_FOUND"&&dt.includes("database")&&dt.includes("does not exist")&&dt.includes(this.databaseId.database)&&fs(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),et===void 0&&(et=B.INTERNAL,dt="Unknown error status: "+ut+" with message "+at.message),R=!0,U.o_(new K(et,dt)),A.close()}else Z(Qt,`RPC '${t}' stream ${o} received:`,H),U.__(H)}})),dr.u_(),setTimeout((()=>{U.s_()}),0),U}terminate(){this.a_.forEach((t=>t.close())),this.a_=[]}I_(t){this.a_.push(t)}E_(t){this.a_=this.a_.filter((e=>e===t))}Go(t,e,r){super.Go(t,e,r),this.databaseInfo.apiKey&&(t["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Gl()}}function Sw(i){return new dr(i)}function ka(){return typeof document<"u"?document:null}function ea(i){return new Mv(i,!0)}dr.c_=!1;class Od{constructor(t,e,r=1e3,o=1.5,h=6e4){this.Ci=t,this.timerId=e,this.R_=r,this.A_=o,this.V_=h,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(t){this.cancel();const e=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,e-r);o>0&&Z("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),t()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const wc="PersistentStream";class Cw{constructor(t,e,r,o,h,l,m,_){this.Ci=t,this.b_=r,this.S_=o,this.connection=h,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=m,this.listener=_,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Od(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(t){this.q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===B.RESOURCE_EXHAUSTED?(Pi(e.toString()),Pi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.t_(e)}W_(){}auth(){this.state=1;const t=this.Q_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,o])=>{this.D_===e&&this.G_(r,o)}),(r=>{t((()=>{const o=new K(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)}))}))}G_(t,e){const r=this.Q_(this.D_);this.stream=this.j_(t,e),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{r((()=>this.z_(o)))})),this.stream.onMessage((o=>{r((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return Z(wc,`close with error: ${t}`),this.stream=null,this.close(4,t)}Q_(t){return e=>{this.Ci.enqueueAndForget((()=>this.D_===t?e():(Z(wc,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Rw extends Cw{constructor(t,e,r,o,h,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,o,l),this.serializer=h}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}H_(t){return kt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,kt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){kt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=Wv(t.writeResults,t.commitTime),r=lr(t.commitTime);return this.listener.na(r,e)}ra(){const t={};t.database=zv(this.serializer),this.K_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((r=>jv(this.serializer,r)))};this.K_(e)}}class kw{}class xw extends kw{constructor(t,e,r,o){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new K(B.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([h,l])=>this.connection.Wo(t,$a(e,r),o,h,l))).catch((h=>{throw h.name==="FirebaseError"?(h.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new K(B.UNKNOWN,h.toString())}))}jo(t,e,r,o,h){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,m])=>this.connection.jo(t,$a(e,r),o,l,m,h))).catch((l=>{throw l.name==="FirebaseError"?(l.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new K(B.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Lw(i,t,e,r){return new xw(i,t,e,r)}class Ow{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Pi(e),this.aa=!1):Z("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ss="RemoteStore";class Nw{constructor(t,e,r,o,h){this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=h,this.Aa.Mo((l=>{r.enqueueAndForget((async()=>{Rs(this)&&(Z(Ss,"Restarting streams for network reachability change."),await(async function(_){const v=Et(_);v.Ea.add(4),await Cs(v),v.Va.set("Unknown"),v.Ea.delete(4),await na(v)})(this))}))})),this.Va=new Ow(r,o)}}async function na(i){if(Rs(i))for(const t of i.Ra)await t(!0)}async function Cs(i){for(const t of i.Ra)await t(!1)}function Rs(i){return Et(i).Ea.size===0}async function Nd(i,t,e){if(!Ps(t))throw t;i.Ea.add(1),await Cs(i),i.Va.set("Offline"),e||(e=()=>ww(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{Z(Ss,"Retrying IndexedDB access"),await e(),i.Ea.delete(1),await na(i)}))}function Dd(i,t){return t().catch((e=>Nd(i,e,t)))}async function ia(i){const t=Et(i),e=Zn(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Pu;for(;Dw(t);)try{const o=await Tw(t.localStore,r);if(o===null){t.Ta.length===0&&e.L_();break}r=o.batchId,Mw(t,o)}catch(o){await Nd(t,o)}Md(t)&&Vd(t)}function Dw(i){return Rs(i)&&i.Ta.length<10}function Mw(i,t){i.Ta.push(t);const e=Zn(i);e.O_()&&e.Y_&&e.ea(t.mutations)}function Md(i){return Rs(i)&&!Zn(i).x_()&&i.Ta.length>0}function Vd(i){Zn(i).start()}async function Vw(i){Zn(i).ra()}async function Bw(i){const t=Zn(i);for(const e of i.Ta)t.ea(e.mutations)}async function Uw(i,t,e){const r=i.Ta.shift(),o=Nu.from(r,t,e);await Dd(i,(()=>i.remoteSyncer.applySuccessfulWrite(o))),await ia(i)}async function Fw(i,t){t&&Zn(i).Y_&&await(async function(r,o){if((function(l){return Nv(l)&&l!==B.ABORTED})(o.code)){const h=r.Ta.shift();Zn(r).B_(),await Dd(r,(()=>r.remoteSyncer.rejectFailedWrite(h.batchId,o))),await ia(r)}})(i,t),Md(i)&&Vd(i)}async function Tc(i,t){const e=Et(i);e.asyncQueue.verifyOperationInProgress(),Z(Ss,"RemoteStore received new credentials");const r=Rs(e);e.Ea.add(3),await Cs(e),r&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await na(e)}async function zw(i,t){const e=Et(i);t?(e.Ea.delete(2),await na(e)):t||(e.Ea.add(2),await Cs(e),e.Va.set("Unknown"))}function Zn(i){return i.fa||(i.fa=(function(e,r,o){const h=Et(e);return h.sa(),new Rw(r,h.connection,h.authCredentials,h.appCheckCredentials,h.serializer,o)})(i.datastore,i.asyncQueue,{Zo:()=>Promise.resolve(),Yo:Vw.bind(null,i),t_:Fw.bind(null,i),ta:Bw.bind(null,i),na:Uw.bind(null,i)}),i.Ra.push((async t=>{t?(i.fa.B_(),await ia(i)):(await i.fa.stop(),i.Ta.length>0&&(Z(Ss,`Stopping write stream with ${i.Ta.length} pending writes`),i.Ta=[]))}))),i.fa}class Bu{constructor(t,e,r,o,h){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=o,this.removalCallback=h,this.deferred=new yi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,r,o,h){const l=Date.now()+r,m=new Bu(t,e,l,o,h);return m.start(r),m}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new K(B.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bd(i,t){if(Pi("AsyncQueue",`${t}: ${i}`),Ps(i))return new K(B.UNAVAILABLE,`${t}: ${i}`);throw i}class Hw{constructor(){this.queries=Ec(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,r){const o=Et(e),h=o.queries;o.queries=Ec(),h.forEach(((l,m)=>{for(const _ of m.ba)_.onError(r)}))})(this,new K(B.ABORTED,"Firestore shutting down"))}}function Ec(){return new Ri((i=>md(i)),pd)}function jw(i){i.Ca.forEach((t=>{t.next()}))}var Ic,Ac;(Ac=Ic||(Ic={})).Ma="default",Ac.Cache="cache";const Ww="SyncEngine";class qw{constructor(t,e,r,o,h,l){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=o,this.currentUser=h,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Ri((m=>md(m)),pd),this.Iu=new Map,this.Eu=new Set,this.Ru=new pe(nt.comparator),this.Au=new Map,this.Vu=new Du,this.du={},this.mu=new Map,this.fu=vr.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Zw(i,t,e){const r=Jw(i);try{const o=await(function(l,m){const _=Et(l),v=bt.now(),A=m.reduce(((U,z)=>U.add(z.key)),te());let b,R;return _.persistence.runTransaction("Locally write mutations","readwrite",(U=>{let z=jo(),H=te();return _.xs.getEntries(U,A).next((G=>{z=G,z.forEach(((at,ut)=>{ut.isValidDocument()||(H=H.add(at))}))})).next((()=>_.localDocuments.getOverlayedDocuments(U,z))).next((G=>{b=G;const at=[];for(const ut of m){const et=kv(ut,b.get(ut.key).overlayedDocument);et!=null&&at.push(new ki(ut.key,et,ad(et.value.mapValue),gn.exists(!0)))}return _.mutationQueue.addMutationBatch(U,v,at,m)})).next((G=>{R=G;const at=G.applyToLocalDocumentSet(b,H);return _.documentOverlayCache.saveOverlays(U,G.batchId,at)}))})).then((()=>({batchId:R.batchId,changes:gd(b)})))})(r.localStore,t);r.sharedClientState.addPendingMutation(o.batchId),(function(l,m,_){let v=l.du[l.currentUser.toKey()];v||(v=new pe(yt)),v=v.insert(m,_),l.du[l.currentUser.toKey()]=v})(r,o.batchId,e),await ra(r,o.changes),await ia(r.remoteStore)}catch(o){const h=Bd(o,"Failed to persist write");e.reject(h)}}function Pc(i,t,e){const r=Et(i);if(r.isPrimaryClient&&e===0||!r.isPrimaryClient&&e===1){const o=[];r.Tu.forEach(((h,l)=>{const m=l.view.va(t);m.snapshot&&o.push(m.snapshot)})),(function(l,m){const _=Et(l);_.onlineState=m;let v=!1;_.queries.forEach(((A,b)=>{for(const R of b.ba)R.va(m)&&(v=!0)})),v&&jw(_)})(r.eventManager,t),o.length&&r.Pu.J_(o),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Gw(i,t){const e=Et(i),r=t.batch.batchId;try{const o=await vw(e.localStore,t);Fd(e,r,null),Ud(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await ra(e,o)}catch(o){await Iu(o)}}async function Kw(i,t,e){const r=Et(i);try{const o=await(function(l,m){const _=Et(l);return _.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let A;return _.mutationQueue.lookupMutationBatch(v,m).next((b=>(kt(b!==null,37113),A=b.keys(),_.mutationQueue.removeMutationBatch(v,b)))).next((()=>_.mutationQueue.performConsistencyCheck(v))).next((()=>_.documentOverlayCache.removeOverlaysForBatchId(v,A,m))).next((()=>_.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,A))).next((()=>_.localDocuments.getDocuments(v,A)))}))})(r.localStore,t);Fd(r,t,e),Ud(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),await ra(r,o)}catch(o){await Iu(o)}}function Ud(i,t){(i.mu.get(t)||[]).forEach((e=>{e.resolve()})),i.mu.delete(t)}function Fd(i,t,e){const r=Et(i);let o=r.du[r.currentUser.toKey()];if(o){const h=o.get(t);h&&(e?h.reject(e):h.resolve(),o=o.remove(t)),r.du[r.currentUser.toKey()]=o}}async function ra(i,t,e){const r=Et(i),o=[],h=[],l=[];r.Tu.isEmpty()||(r.Tu.forEach(((m,_)=>{l.push(r.pu(_,t,e).then((v=>{if((v||e)&&r.isPrimaryClient){const A=v?!v.fromCache:e?.targetChanges.get(_.targetId)?.current;r.sharedClientState.updateQueryState(_.targetId,A?"current":"not-current")}if(v){o.push(v);const A=Vu.Es(_.targetId,v);h.push(A)}})))})),await Promise.all(l),r.Pu.J_(o),await(async function(_,v){const A=Et(_);try{await A.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>M.forEach(v,(R=>M.forEach(R.Ts,(U=>A.persistence.referenceDelegate.addReference(b,R.targetId,U))).next((()=>M.forEach(R.Is,(U=>A.persistence.referenceDelegate.removeReference(b,R.targetId,U)))))))))}catch(b){if(!Ps(b))throw b;Z(_w,"Failed to update sequence numbers: "+b)}for(const b of v){const R=b.targetId;if(!b.fromCache){const U=A.vs.get(R),z=U.snapshotVersion,H=U.withLastLimboFreeSnapshotVersion(z);A.vs=A.vs.insert(R,H)}}})(r.localStore,h))}async function $w(i,t){const e=Et(i);if(!e.currentUser.isEqual(t)){Z(Ww,"User change. New user:",t.toKey());const r=await Ld(e.localStore,t);e.currentUser=t,(function(h,l){h.mu.forEach((m=>{m.forEach((_=>{_.reject(new K(B.CANCELLED,l))}))})),h.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),await ra(e,r.Ns)}}function Jw(i){const t=Et(i);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Gw.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Kw.bind(null,t),t}class Zo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=ea(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return yw(this.persistence,new mw,t.initialUser,this.serializer)}Cu(t){return new xd(Mu.Vi,this.serializer)}Du(t){return new Ew}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zo.provider={build:()=>new Zo};class Xw extends Zo{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){kt(this.persistence.referenceDelegate instanceof qo,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new tw(r,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?fe.withCacheSize(this.cacheSizeBytes):fe.DEFAULT;return new xd((r=>qo.Vi(r,e)),this.serializer)}}class Qa{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Pc(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=$w.bind(null,this.syncEngine),await zw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Hw})()}createDatastore(t){const e=ea(t.databaseInfo.databaseId),r=Sw(t.databaseInfo);return Lw(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return(function(r,o,h,l,m){return new Nw(r,o,h,l,m)})(this.localStore,this.datastore,t.asyncQueue,(e=>Pc(this.syncEngine,e,0)),(function(){return vc.v()?new vc:new Iw})())}createSyncEngine(t,e){return(function(o,h,l,m,_,v,A){const b=new qw(o,h,l,m,_,v);return A&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const r=Et(e);Z(Ss,"RemoteStore shutting down."),r.Ea.add(5),await Cs(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Qa.provider={build:()=>new Qa};const Gn="FirestoreClient";class Qw{constructor(t,e,r,o,h){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this._databaseInfo=o,this.user=Yt.UNAUTHENTICATED,this.clientId=Tu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=h,this.authCredentials.start(r,(async l=>{Z(Gn,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(Z(Gn,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new yi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const r=Bd(e,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}async function xa(i,t){i.asyncQueue.verifyOperationInProgress(),Z(Gn,"Initializing OfflineComponentProvider");const e=i.configuration;await t.initialize(e);let r=e.initialUser;i.setCredentialChangeListener((async o=>{r.isEqual(o)||(await Ld(t.localStore,o),r=o)})),t.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=t}async function bc(i,t){i.asyncQueue.verifyOperationInProgress();const e=await Yw(i);Z(Gn,"Initializing OnlineComponentProvider"),await t.initialize(e,i.configuration),i.setCredentialChangeListener((r=>Tc(t.remoteStore,r))),i.setAppCheckTokenChangeListener(((r,o)=>Tc(t.remoteStore,o))),i._onlineComponents=t}async function Yw(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){Z(Gn,"Using user provided OfflineComponentProvider");try{await xa(i,i._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(o){return o.name==="FirebaseError"?o.code===B.FAILED_PRECONDITION||o.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(e))throw e;fs("Error using user provided cache. Falling back to memory cache: "+e),await xa(i,new Zo)}}else Z(Gn,"Using default OfflineComponentProvider"),await xa(i,new Xw(void 0));return i._offlineComponents}async function tT(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(Z(Gn,"Using user provided OnlineComponentProvider"),await bc(i,i._uninitializedComponentsProvider._online)):(Z(Gn,"Using default OnlineComponentProvider"),await bc(i,new Qa))),i._onlineComponents}function eT(i){return tT(i).then((t=>t.syncEngine))}function nT(i,t){const e=new yi;return i.asyncQueue.enqueueAndForget((async()=>Zw(await eT(i),t,e))),e.promise}function zd(i){const t={};return i.timeoutSeconds!==void 0&&(t.timeoutSeconds=i.timeoutSeconds),t}const iT="ComponentProvider",Sc=new Map;function rT(i,t,e,r,o){return new Jy(i,t,e,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,zd(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,r)}const Hd="firestore.googleapis.com",Cc=!0;class Rc{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new K(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Hd,this.ssl=Cc}else this.host=t.host,this.ssl=t.ssl??Cc;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=kd;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<Qv)throw new K(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}By("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zd(t.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new K(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new K(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new K(B.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(r,o){return r.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class sa{constructor(t,e,r,o){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Rc({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new K(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new K(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rc(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Cy;switch(r.type){case"firstParty":return new Ly(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new K(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const r=Sc.get(e);r&&(Z(iT,"Removing Datastore"),Sc.delete(e),r.terminate())})(this),Promise.resolve()}}function sT(i,t,e,r={}){i=Ql(i,sa);const o=Kn(t),h=i._getSettings(),l={...h,emulatorOptions:i._getEmulatorOptions()},m=`${t}:${e}`;o&&(tu(`https://${m}`),eu("Firestore",!0)),h.host!==Hd&&h.host!==m&&fs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const _={...h,host:m,ssl:o,emulatorOptions:r};if(!wi(_,l)&&(i._setSettings(_),r.mockUserToken)){let v,A;if(typeof r.mockUserToken=="string")v=r.mockUserToken,A=Yt.MOCK_USER;else{v=jc(r.mockUserToken,i._app?.options.projectId);const b=r.mockUserToken.sub||r.mockUserToken.user_id;if(!b)throw new K(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");A=new Yt(b)}i._authCredentials=new Ry(new $l(v,A))}}class Uu{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new Uu(this.firestore,t,this._query)}}class ee{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ee(this.firestore,t,this._key)}toJSON(){return{type:ee._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,r){if(As(e,ee._jsonSchema))return new ee(t,r||null,new nt(St.fromString(e.referencePath)))}}ee._jsonSchemaVersion="firestore/documentReference/1.0",ee._jsonSchema={type:Vt("string",ee._jsonSchemaVersion),referencePath:Vt("string")};class zn extends Uu{constructor(t,e,r){super(t,e,dv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ee(this.firestore,null,new nt(t))}withConverter(t){return new zn(this.firestore,t,this._path)}}function oT(i,t,...e){if(i=ue(i),Jl("collection","path",t),i instanceof sa){const r=St.fromString(t,...e);return Xh(r),new zn(i,null,r)}{if(!(i instanceof ee||i instanceof zn))throw new K(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=i._path.child(St.fromString(t,...e));return Xh(r),new zn(i.firestore,null,r)}}function aT(i,t,...e){if(i=ue(i),arguments.length===1&&(t=Tu.newId()),Jl("doc","path",t),i instanceof sa){const r=St.fromString(t,...e);return Jh(r),new ee(i,null,new nt(r))}{if(!(i instanceof ee||i instanceof zn))throw new K(B.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=i._path.child(St.fromString(t,...e));return Jh(r),new ee(i.firestore,i instanceof zn?i.converter:null,new nt(r))}}const kc="AsyncQueue";class xc{constructor(t=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Od(this,"async_queue_retry"),this._c=()=>{const r=ka();r&&Z(kc,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=t;const e=ka();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=ka();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new yi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Yu.push(t),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(t){if(!Ps(t))throw t;Z(kc,"Operation failed with retryable error: "+t)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((r=>{throw this.nc=r,this.rc=!1,Pi("INTERNAL UNHANDLED ERROR: ",Lc(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=e,e}enqueueAfterDelay(t,e,r){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const o=Bu.createAndSchedule(this,t,e,r,(h=>this.hc(h)));return this.tc.push(o),o}uc(){this.nc&&it(47125,{Pc:Lc(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,r)=>e.targetTimeMs-r.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}Rc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function Lc(i){let t=i.message||"";return i.stack&&(t=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),t}class jd extends sa{constructor(t,e,r,o){super(t,e,r,o),this.type="firestore",this._queue=new xc,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new xc(t),this._firestoreClient=void 0,await t}}}function uT(i,t){const e=typeof i=="object"?i:ru(),r=typeof i=="string"?i:Uo,o=$o(e,"firestore").getImmediate({identifier:r});if(!o._initialized){const h=Fc("firestore");h&&sT(o,...h)}return o}function hT(i){if(i._terminated)throw new K(B.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||cT(i),i._firestoreClient}function cT(i){const t=i._freezeSettings(),e=rT(i._databaseId,i._app?.options.appId||"",i._persistenceKey,i._app?.options.apiKey,t);i._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),i._firestoreClient=new Qw(i._authCredentials,i._appCheckCredentials,i._queue,e,i._componentsProvider&&(function(o){const h=o?._online.build();return{_offline:o?._offline.build(h),_online:h}})(i._componentsProvider))}class De{constructor(t){this._byteString=t}static fromBase64String(t){try{return new De(Qe.fromBase64String(t))}catch(e){throw new K(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new De(Qe.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:De._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(As(t,De._jsonSchema))return De.fromBase64String(t.bytes)}}De._jsonSchemaVersion="firestore/bytes/1.0",De._jsonSchema={type:Vt("string",De._jsonSchemaVersion),bytes:Vt("string")};class Wd{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new K(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $t(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Fu{constructor(t){this._methodName=t}}class yn{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new K(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new K(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return yt(this._lat,t._lat)||yt(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:yn._jsonSchemaVersion}}static fromJSON(t){if(As(t,yn._jsonSchema))return new yn(t.latitude,t.longitude)}}yn._jsonSchemaVersion="firestore/geoPoint/1.0",yn._jsonSchema={type:Vt("string",yn._jsonSchemaVersion),latitude:Vt("number"),longitude:Vt("number")};class Xe{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(r,o){if(r.length!==o.length)return!1;for(let h=0;h<r.length;++h)if(r[h]!==o[h])return!1;return!0})(this._values,t._values)}toJSON(){return{type:Xe._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(As(t,Xe._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new Xe(t.vectorValues);throw new K(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Xe._jsonSchemaVersion="firestore/vectorValue/1.0",Xe._jsonSchema={type:Vt("string",Xe._jsonSchemaVersion),vectorValues:Vt("object")};const lT=/^__.*__$/;class dT{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return this.fieldMask!==null?new ki(t,this.data,this.fieldMask,e,this.fieldTransforms):new bs(t,this.data,e,this.fieldTransforms)}}function qd(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{dataSource:i})}}class zu{constructor(t,e,r,o,h,l){this.settings=t,this.databaseId=e,this.serializer=r,this.ignoreUndefinedProperties=o,h===void 0&&this.validatePath(),this.fieldTransforms=h||[],this.fieldMask=l||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(t){return new zu({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(t){const e=this.path?.child(t),r=this.contextWith({path:e,arrayElement:!1});return r.validatePathSegment(t),r}childContextForFieldPath(t){const e=this.path?.child(t),r=this.contextWith({path:e,arrayElement:!1});return r.validatePath(),r}childContextForArray(t){return this.contextWith({path:void 0,arrayElement:!0})}createError(t){return Go(t,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}validatePath(){if(this.path)for(let t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))}validatePathSegment(t){if(t.length===0)throw this.createError("Document fields must not be empty");if(qd(this.dataSource)&&lT.test(t))throw this.createError('Document fields cannot begin and end with "__"')}}class fT{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=r||ea(t)}createContext(t,e,r,o=!1){return new zu({dataSource:t,methodName:e,targetDoc:r,path:$t.emptyPath(),arrayElement:!1,hasConverter:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function pT(i){const t=i._freezeSettings(),e=ea(i._databaseId);return new fT(i._databaseId,!!t.ignoreUndefinedProperties,e)}function mT(i,t,e,r,o,h={}){const l=i.createContext(h.merge||h.mergeFields?2:0,t,e,o);$d("Data must be an object, but it was:",l,r);const m=Gd(r,l);let _,v;if(h.merge)_=new Ve(l.fieldMask),v=l.fieldTransforms;else if(h.mergeFields){const A=[];for(const b of h.mergeFields){const R=ju(t,b,e);if(!l.contains(R))throw new K(B.INVALID_ARGUMENT,`Field '${R}' is specified in your field mask but missing from your input data.`);yT(A,R)||A.push(R)}_=new Ve(A),v=l.fieldTransforms.filter((b=>_.covers(b.field)))}else _=null,v=l.fieldTransforms;return new dT(new Ne(m),_,v)}class Hu extends Fu{_toFieldTransform(t){return new bv(t.path,new _s)}isEqual(t){return t instanceof Hu}}function Zd(i,t){if(Kd(i=ue(i)))return $d("Unsupported field value:",t,i),Gd(i,t);if(i instanceof Fu)return(function(r,o){if(!qd(o.dataSource))throw o.createError(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.createError(`${r._methodName}() is not currently supported inside arrays`);const h=r._toFieldTransform(o);h&&o.fieldTransforms.push(h)})(i,t),null;if(i===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),i instanceof Array){if(t.settings.arrayElement&&t.dataSource!==4)throw t.createError("Nested arrays are not supported");return(function(r,o){const h=[];let l=0;for(const m of r){let _=Zd(m,o.childContextForArray(l));_==null&&(_={nullValue:"NULL_VALUE"}),h.push(_),l++}return{arrayValue:{values:h}}})(i,t)}return(function(r,o){if((r=ue(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Iv(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const h=bt.fromDate(r);return{timestampValue:Ka(o.serializer,h)}}if(r instanceof bt){const h=new bt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ka(o.serializer,h)}}if(r instanceof yn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof De)return{bytesValue:Vv(o.serializer,r._byteString)};if(r instanceof ee){const h=o.databaseId,l=r.firestore._databaseId;if(!l.isEqual(h))throw o.createError(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${h.projectId}/${h.database}`);return{referenceValue:Sd(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof Xe)return(function(l,m){const _=l instanceof Xe?l.toArray():l;return{mapValue:{fields:{[sd]:{stringValue:od},[ja]:{arrayValue:{values:_.map((A=>{if(typeof A!="number")throw m.createError("VectorValues must only contain numeric values.");return Ou(m.serializer,A)}))}}}}}})(r,o);if(Rd(r))return r._toProto(o.serializer);throw o.createError(`Unsupported field value: ${Eu(r)}`)})(i,t)}function Gd(i,t){const e={};return td(i)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Er(i,((r,o)=>{const h=Zd(o,t.childContextForField(r));h!=null&&(e[r]=h)})),{mapValue:{fields:e}}}function Kd(i){return!(typeof i!="object"||i===null||i instanceof Array||i instanceof Date||i instanceof bt||i instanceof yn||i instanceof De||i instanceof ee||i instanceof Fu||i instanceof Xe||Rd(i))}function $d(i,t,e){if(!Kd(e)||!Xl(e)){const r=Eu(e);throw r==="an object"?t.createError(i+" a custom object"):t.createError(i+" "+r)}}function ju(i,t,e){if((t=ue(t))instanceof Wd)return t._internalPath;if(typeof t=="string")return gT(i,t);throw Go("Field path arguments must be of type string or ",i,!1,void 0,e)}const _T=new RegExp("[~\\*/\\[\\]]");function gT(i,t,e){if(t.search(_T)>=0)throw Go(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,e);try{return new Wd(...t.split("."))._internalPath}catch{throw Go(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,e)}}function Go(i,t,e,r,o){const h=r&&!r.isEmpty(),l=o!==void 0;let m=`Function ${t}() called with invalid data`;e&&(m+=" (via `toFirestore()`)"),m+=". ";let _="";return(h||l)&&(_+=" (found",h&&(_+=` in field ${r}`),l&&(_+=` in document ${o}`),_+=")"),new K(B.INVALID_ARGUMENT,m+i+_)}function yT(i,t){return i.some((e=>e.isEqual(t)))}function vT(){return new Hu("serverTimestamp")}const Oc="@firebase/firestore",Nc="4.11.0";class Jd{constructor(t,e,r,o,h){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=o,this._converter=h}get id(){return this._key.path.lastSegment()}get ref(){return new ee(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new wT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(t){if(this._document){const e=this._document.data.field(ju("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class wT extends Jd{data(){return super.data()}}function TT(i,t,e){let r;return r=i?i.toFirestore(t):t,r}class vo{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class fr extends Jd{constructor(t,e,r,o,h,l){super(t,e,r,o,l),this._firestore=t,this._firestoreImpl=t,this.metadata=h}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Co(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(ju("DocumentSnapshot.get",t));if(r!==null)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new K(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=fr._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}fr._jsonSchemaVersion="firestore/documentSnapshot/1.0",fr._jsonSchema={type:Vt("string",fr._jsonSchemaVersion),bundleSource:Vt("string","DocumentSnapshot"),bundleName:Vt("string"),bundle:Vt("string")};class Co extends fr{data(t={}){return super.data(t)}}class cs{constructor(t,e,r,o){this._firestore=t,this._userDataWriter=e,this._snapshot=o,this.metadata=new vo(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((r=>{t.call(e,new Co(this._firestore,this._userDataWriter,r.key,r,new vo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new K(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(o,h){if(o._snapshot.oldDocs.isEmpty()){let l=0;return o._snapshot.docChanges.map((m=>{const _=new Co(o._firestore,o._userDataWriter,m.doc.key,m.doc,new vo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:_,oldIndex:-1,newIndex:l++}}))}{let l=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>h||m.type!==3)).map((m=>{const _=new Co(o._firestore,o._userDataWriter,m.doc.key,m.doc,new vo(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let v=-1,A=-1;return m.type!==0&&(v=l.indexOf(m.doc.key),l=l.delete(m.doc.key)),m.type!==1&&(l=l.add(m.doc),A=l.indexOf(m.doc.key)),{type:ET(m.type),doc:_,oldIndex:v,newIndex:A}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new K(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=cs._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Tu.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],r=[],o=[];return this.docs.forEach((h=>{h._document!==null&&(e.push(h._document),r.push(this._userDataWriter.convertObjectMap(h._document.data.value.mapValue.fields,"previous")),o.push(h.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function ET(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:i})}}cs._jsonSchemaVersion="firestore/querySnapshot/1.0",cs._jsonSchema={type:Vt("string",cs._jsonSchemaVersion),bundleSource:Vt("string","QuerySnapshot"),bundleName:Vt("string"),bundle:Vt("string")};function IT(i,t){const e=Ql(i.firestore,jd),r=aT(i),o=TT(i.converter,t),h=pT(i.firestore);return AT(e,[mT(h,"addDoc",r._key,o,i.converter!==null,{}).toMutation(r._key,gn.exists(!1))]).then((()=>r))}function AT(i,t){const e=hT(i);return nT(e,t)}(function(t,e=!0){Sy(Ci),Ti(new jn("firestore",((r,{instanceIdentifier:o,options:h})=>{const l=r.getProvider("app").getImmediate(),m=new jd(new ky(r.getProvider("auth-internal")),new Oy(l,r.getProvider("app-check-internal")),Xy(l,o),l);return h={useFetchStreams:e,...h},m._setSettings(h),m}),"PUBLIC").setMultipleInstances(!0)),Ke(Oc,Nc,t),Ke(Oc,Nc,"esm2020")})();const PT={apiKey:"AIzaSyBhDODHvzxAWPXuxrKA_aZfKHZbGXbXF2k",authDomain:"bhoomitech-field.firebaseapp.com",projectId:"bhoomitech-field",storageBucket:"bhoomitech-field.firebasestorage.app",messagingSenderId:"815695507485",appId:"1:815695507485:web:6e9d8d6112d6ef9173d6f4"},Wu=Zc(PT);lg(Wu);const bT=uT(Wu),ST=Iy(Wu);document.addEventListener("DOMContentLoaded",()=>{if("serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js").then(R=>{console.log("Service Worker registered:",R.scope)}).catch(R=>{console.error("Service Worker registration failed:",R)})}),!document.getElementById("map")){console.error("Map container not found");return}const t=L.map("map").setView([20.5937,78.9629],5);let e=null;L.tileLayer("https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}",{maxZoom:19}).addTo(t),t.on("click",function(R){v(R.latlng.lat,R.latlng.lng)});const r=document.getElementById("name"),o=document.getElementById("lat"),h=document.getElementById("lng"),l=document.getElementById("submitBtn"),m=document.getElementById("status");function _(){const R=r.value.trim(),U=o.value.trim(),z=h.value.trim();l.disabled=!(R&&U&&z)}r.addEventListener("input",_),o.addEventListener("input",_),h.addEventListener("input",_);function v(R,U){R=parseFloat(R),U=parseFloat(U),!(isNaN(R)||isNaN(U))&&(e?e.setLatLng([R,U]):e=L.marker([R,U]).addTo(t),t.setView([R,U],20),o.value=R.toFixed(6),h.value=U.toFixed(6),_())}window.useLocation=function(){if(!navigator.geolocation){alert("Geolocation not supported.");return}navigator.geolocation.getCurrentPosition(function(R){v(R.coords.latitude,R.coords.longitude)},function(){alert("Unable to retrieve location.")})};function A(){v(o.value,h.value)}o.addEventListener("input",A),h.addEventListener("input",A),window.openStreetView=function(){const R=o.value,U=h.value;if(!R||!U){alert("Select or enter coordinates first");return}window.open(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${R},${U}`,"_blank")},window.openStreetView=function(){const R=o.value,U=h.value;if(!R||!U){alert("Select or enter coordinates first");return}window.open(`https://www.google.com/maps/@?api=1&map_action=pano&viewpoint=${R},${U}`,"_blank")};function b(){navigator.onLine?m.innerText=" Online":m.innerText=" Offline - Saving Locally"}window.addEventListener("online",b),window.addEventListener("offline",b),b()});window.manualSync=async function(){if(!navigator.onLine){alert("You are offline. Please connect to internet before syncing.");return}const i=await kf();if(!i.length){alert("No pending records to sync.");return}if(!confirm(`You have ${i.length} record(s). Start sync?`))return;alert("Starting sync...");let t=0;for(let e of i)try{let r=null;if(e.imageBlob){const o=Ey(ST,`submissions/${e.id}.jpg`);await wy(o,e.imageBlob),r=await Ty(o)}await IT(oT(bT,"submissions"),{name:e.name,phone:e.phone,description:e.description,lat:e.lat,lng:e.lng,imageUrl:r,timestamp:vT()}),xf(e.id),t++}catch(r){console.error("Sync failed for record:",e.id,r)}alert(`Sync complete. ${t} record(s) uploaded.`)};window.submitData=async function(){const i=document.getElementById("name").value.trim(),t=document.getElementById("phone").value.trim(),e=document.getElementById("description").value.trim(),r=parseFloat(document.getElementById("lat").value),o=parseFloat(document.getElementById("lng").value),h=document.getElementById("photo").files[0];if(!i||!t||isNaN(r)||isNaN(o)){alert("Please complete all required fields.");return}let l=null;h&&(l=await CT(h));const m={id:Date.now(),name:i,phone:t,description:e,lat:r,lng:o,imageBlob:l,synced:!1,timestamp:new Date};await Rf(m),alert("Saved locally. Click Sync Now when internet is available."),location.reload()};async function CT(i){return new Promise(t=>{const e=new Image,r=new FileReader;r.onload=function(o){e.src=o.target.result},e.onload=function(){const o=document.createElement("canvas"),h=300;let l=e.width,m=e.height;l>h&&(m=m*(h/l),l=h),o.width=l,o.height=m,o.getContext("2d").drawImage(e,0,0,l,m),o.toBlob(v=>{t(v)},"image/jpeg",.8)},r.readAsDataURL(i)})}function RT(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var ns={exports:{}};var kT=ns.exports,Dc;function xT(){return Dc||(Dc=1,(function(i,t){(function(e,r){r(t)})(kT,(function(e){var r="1.9.4";function o(n){var s,u,c,f;for(u=1,c=arguments.length;u<c;u++){f=arguments[u];for(s in f)n[s]=f[s]}return n}var h=Object.create||(function(){function n(){}return function(s){return n.prototype=s,new n}})();function l(n,s){var u=Array.prototype.slice;if(n.bind)return n.bind.apply(n,u.call(arguments,1));var c=u.call(arguments,2);return function(){return n.apply(s,c.length?c.concat(u.call(arguments)):arguments)}}var m=0;function _(n){return"_leaflet_id"in n||(n._leaflet_id=++m),n._leaflet_id}function v(n,s,u){var c,f,g,T;return T=function(){c=!1,f&&(g.apply(u,f),f=!1)},g=function(){c?f=arguments:(n.apply(u,arguments),setTimeout(T,s),c=!0)},g}function A(n,s,u){var c=s[1],f=s[0],g=c-f;return n===c&&u?n:((n-f)%g+g)%g+f}function b(){return!1}function R(n,s){if(s===!1)return n;var u=Math.pow(10,s===void 0?6:s);return Math.round(n*u)/u}function U(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function z(n){return U(n).split(/\s+/)}function H(n,s){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?h(n.options):{});for(var u in s)n.options[u]=s[u];return n.options}function G(n,s,u){var c=[];for(var f in n)c.push(encodeURIComponent(u?f.toUpperCase():f)+"="+encodeURIComponent(n[f]));return(!s||s.indexOf("?")===-1?"?":"&")+c.join("&")}var at=/\{ *([\w_ -]+) *\}/g;function ut(n,s){return n.replace(at,function(u,c){var f=s[c];if(f===void 0)throw new Error("No value provided for variable "+u);return typeof f=="function"&&(f=f(s)),f})}var et=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function dt(n,s){for(var u=0;u<n.length;u++)if(n[u]===s)return u;return-1}var Bt="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ct(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var S=0;function w(n){var s=+new Date,u=Math.max(0,16-(s-S));return S=s+u,window.setTimeout(n,u)}var I=window.requestAnimationFrame||Ct("RequestAnimationFrame")||w,C=window.cancelAnimationFrame||Ct("CancelAnimationFrame")||Ct("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function P(n,s,u){if(u&&I===w)n.call(s);else return I.call(window,l(n,s))}function k(n){n&&C.call(window,n)}var E={__proto__:null,extend:o,create:h,bind:l,get lastId(){return m},stamp:_,throttle:v,wrapNum:A,falseFn:b,formatNum:R,trim:U,splitWords:z,setOptions:H,getParamString:G,template:ut,isArray:et,indexOf:dt,emptyImageUrl:Bt,requestFn:I,cancelFn:C,requestAnimFrame:P,cancelAnimFrame:k};function At(){}At.extend=function(n){var s=function(){H(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},u=s.__super__=this.prototype,c=h(u);c.constructor=s,s.prototype=c;for(var f in this)Object.prototype.hasOwnProperty.call(this,f)&&f!=="prototype"&&f!=="__super__"&&(s[f]=this[f]);return n.statics&&o(s,n.statics),n.includes&&(en(n.includes),o.apply(null,[c].concat(n.includes))),o(c,n),delete c.statics,delete c.includes,c.options&&(c.options=u.options?h(u.options):{},o(c.options,n.options)),c._initHooks=[],c.callInitHooks=function(){if(!this._initHooksCalled){u.callInitHooks&&u.callInitHooks.call(this),this._initHooksCalled=!0;for(var g=0,T=c._initHooks.length;g<T;g++)c._initHooks[g].call(this)}},s},At.include=function(n){var s=this.prototype.options;return o(this.prototype,n),n.options&&(this.prototype.options=s,this.mergeOptions(n.options)),this},At.mergeOptions=function(n){return o(this.prototype.options,n),this},At.addInitHook=function(n){var s=Array.prototype.slice.call(arguments,1),u=typeof n=="function"?n:function(){this[n].apply(this,s)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(u),this};function en(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=et(n)?n:[n];for(var s=0;s<n.length;s++)n[s]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ie={on:function(n,s,u){if(typeof n=="object")for(var c in n)this._on(c,n[c],s);else{n=z(n);for(var f=0,g=n.length;f<g;f++)this._on(n[f],s,u)}return this},off:function(n,s,u){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var c in n)this._off(c,n[c],s);else{n=z(n);for(var f=arguments.length===1,g=0,T=n.length;g<T;g++)f?this._off(n[g]):this._off(n[g],s,u)}return this},_on:function(n,s,u,c){if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}if(this._listens(n,s,u)===!1){u===this&&(u=void 0);var f={fn:s,ctx:u};c&&(f.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(f)}},_off:function(n,s,u){var c,f,g;if(this._events&&(c=this._events[n],!!c)){if(arguments.length===1){if(this._firingCount)for(f=0,g=c.length;f<g;f++)c[f].fn=b;delete this._events[n];return}if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}var T=this._listens(n,s,u);if(T!==!1){var O=c[T];this._firingCount&&(O.fn=b,this._events[n]=c=c.slice()),c.splice(T,1)}}},fire:function(n,s,u){if(!this.listens(n,u))return this;var c=o({},s,{type:n,target:this,sourceTarget:s&&s.sourceTarget||this});if(this._events){var f=this._events[n];if(f){this._firingCount=this._firingCount+1||1;for(var g=0,T=f.length;g<T;g++){var O=f[g],D=O.fn;O.once&&this.off(n,D,O.ctx),D.call(O.ctx||this,c)}this._firingCount--}}return u&&this._propagateEvent(c),this},listens:function(n,s,u,c){typeof n!="string"&&console.warn('"string" type argument expected');var f=s;typeof s!="function"&&(c=!!s,f=void 0,u=void 0);var g=this._events&&this._events[n];if(g&&g.length&&this._listens(n,f,u)!==!1)return!0;if(c){for(var T in this._eventParents)if(this._eventParents[T].listens(n,s,u,c))return!0}return!1},_listens:function(n,s,u){if(!this._events)return!1;var c=this._events[n]||[];if(!s)return!!c.length;u===this&&(u=void 0);for(var f=0,g=c.length;f<g;f++)if(c[f].fn===s&&c[f].ctx===u)return f;return!1},once:function(n,s,u){if(typeof n=="object")for(var c in n)this._on(c,n[c],s,!0);else{n=z(n);for(var f=0,g=n.length;f<g;f++)this._on(n[f],s,u,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[_(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[_(n)],this},_propagateEvent:function(n){for(var s in this._eventParents)this._eventParents[s].fire(n.type,o({layer:n.target,propagatedFrom:n.target},n),!0)}};ie.addEventListener=ie.on,ie.removeEventListener=ie.clearAllEventListeners=ie.off,ie.addOneTimeEventListener=ie.once,ie.fireEvent=ie.fire,ie.hasEventListeners=ie.listens;var $n=At.extend(ie);function J(n,s,u){this.x=u?Math.round(n):n,this.y=u?Math.round(s):s}var Jn=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};J.prototype={clone:function(){return new J(this.x,this.y)},add:function(n){return this.clone()._add(Q(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(Q(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new J(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new J(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Jn(this.x),this.y=Jn(this.y),this},distanceTo:function(n){n=Q(n);var s=n.x-this.x,u=n.y-this.y;return Math.sqrt(s*s+u*u)},equals:function(n){return n=Q(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=Q(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+R(this.x)+", "+R(this.y)+")"}};function Q(n,s,u){return n instanceof J?n:et(n)?new J(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new J(n.x,n.y):new J(n,s,u)}function wt(n,s){if(n)for(var u=s?[n,s]:n,c=0,f=u.length;c<f;c++)this.extend(u[c])}wt.prototype={extend:function(n){var s,u;if(!n)return this;if(n instanceof J||typeof n[0]=="number"||"x"in n)s=u=Q(n);else if(n=qt(n),s=n.min,u=n.max,!s||!u)return this;return!this.min&&!this.max?(this.min=s.clone(),this.max=u.clone()):(this.min.x=Math.min(s.x,this.min.x),this.max.x=Math.max(u.x,this.max.x),this.min.y=Math.min(s.y,this.min.y),this.max.y=Math.max(u.y,this.max.y)),this},getCenter:function(n){return Q((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return Q(this.min.x,this.max.y)},getTopRight:function(){return Q(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var s,u;return typeof n[0]=="number"||n instanceof J?n=Q(n):n=qt(n),n instanceof wt?(s=n.min,u=n.max):s=u=n,s.x>=this.min.x&&u.x<=this.max.x&&s.y>=this.min.y&&u.y<=this.max.y},intersects:function(n){n=qt(n);var s=this.min,u=this.max,c=n.min,f=n.max,g=f.x>=s.x&&c.x<=u.x,T=f.y>=s.y&&c.y<=u.y;return g&&T},overlaps:function(n){n=qt(n);var s=this.min,u=this.max,c=n.min,f=n.max,g=f.x>s.x&&c.x<u.x,T=f.y>s.y&&c.y<u.y;return g&&T},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var s=this.min,u=this.max,c=Math.abs(s.x-u.x)*n,f=Math.abs(s.y-u.y)*n;return qt(Q(s.x-c,s.y-f),Q(u.x+c,u.y+f))},equals:function(n){return n?(n=qt(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function qt(n,s){return!n||n instanceof wt?n:new wt(n,s)}function Zt(n,s){if(n)for(var u=s?[n,s]:n,c=0,f=u.length;c<f;c++)this.extend(u[c])}Zt.prototype={extend:function(n){var s=this._southWest,u=this._northEast,c,f;if(n instanceof ft)c=n,f=n;else if(n instanceof Zt){if(c=n._southWest,f=n._northEast,!c||!f)return this}else return n?this.extend(rt(n)||It(n)):this;return!s&&!u?(this._southWest=new ft(c.lat,c.lng),this._northEast=new ft(f.lat,f.lng)):(s.lat=Math.min(c.lat,s.lat),s.lng=Math.min(c.lng,s.lng),u.lat=Math.max(f.lat,u.lat),u.lng=Math.max(f.lng,u.lng)),this},pad:function(n){var s=this._southWest,u=this._northEast,c=Math.abs(s.lat-u.lat)*n,f=Math.abs(s.lng-u.lng)*n;return new Zt(new ft(s.lat-c,s.lng-f),new ft(u.lat+c,u.lng+f))},getCenter:function(){return new ft((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ft(this.getNorth(),this.getWest())},getSouthEast:function(){return new ft(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof ft||"lat"in n?n=rt(n):n=It(n);var s=this._southWest,u=this._northEast,c,f;return n instanceof Zt?(c=n.getSouthWest(),f=n.getNorthEast()):c=f=n,c.lat>=s.lat&&f.lat<=u.lat&&c.lng>=s.lng&&f.lng<=u.lng},intersects:function(n){n=It(n);var s=this._southWest,u=this._northEast,c=n.getSouthWest(),f=n.getNorthEast(),g=f.lat>=s.lat&&c.lat<=u.lat,T=f.lng>=s.lng&&c.lng<=u.lng;return g&&T},overlaps:function(n){n=It(n);var s=this._southWest,u=this._northEast,c=n.getSouthWest(),f=n.getNorthEast(),g=f.lat>s.lat&&c.lat<u.lat,T=f.lng>s.lng&&c.lng<u.lng;return g&&T},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,s){return n?(n=It(n),this._southWest.equals(n.getSouthWest(),s)&&this._northEast.equals(n.getNorthEast(),s)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function It(n,s){return n instanceof Zt?n:new Zt(n,s)}function ft(n,s,u){if(isNaN(n)||isNaN(s))throw new Error("Invalid LatLng object: ("+n+", "+s+")");this.lat=+n,this.lng=+s,u!==void 0&&(this.alt=+u)}ft.prototype={equals:function(n,s){if(!n)return!1;n=rt(n);var u=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return u<=(s===void 0?1e-9:s)},toString:function(n){return"LatLng("+R(this.lat,n)+", "+R(this.lng,n)+")"},distanceTo:function(n){return ve.distance(this,rt(n))},wrap:function(){return ve.wrapLatLng(this)},toBounds:function(n){var s=180*n/40075017,u=s/Math.cos(Math.PI/180*this.lat);return It([this.lat-s,this.lng-u],[this.lat+s,this.lng+u])},clone:function(){return new ft(this.lat,this.lng,this.alt)}};function rt(n,s,u){return n instanceof ft?n:et(n)&&typeof n[0]!="object"?n.length===3?new ft(n[0],n[1],n[2]):n.length===2?new ft(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new ft(n.lat,"lng"in n?n.lng:n.lon,n.alt):s===void 0?null:new ft(n,s,u)}var me={latLngToPoint:function(n,s){var u=this.projection.project(n),c=this.scale(s);return this.transformation._transform(u,c)},pointToLatLng:function(n,s){var u=this.scale(s),c=this.transformation.untransform(n,u);return this.projection.unproject(c)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var s=this.projection.bounds,u=this.scale(n),c=this.transformation.transform(s.min,u),f=this.transformation.transform(s.max,u);return new wt(c,f)},infinite:!1,wrapLatLng:function(n){var s=this.wrapLng?A(n.lng,this.wrapLng,!0):n.lng,u=this.wrapLat?A(n.lat,this.wrapLat,!0):n.lat,c=n.alt;return new ft(u,s,c)},wrapLatLngBounds:function(n){var s=n.getCenter(),u=this.wrapLatLng(s),c=s.lat-u.lat,f=s.lng-u.lng;if(c===0&&f===0)return n;var g=n.getSouthWest(),T=n.getNorthEast(),O=new ft(g.lat-c,g.lng-f),D=new ft(T.lat-c,T.lng-f);return new Zt(O,D)}},ve=o({},me,{wrapLng:[-180,180],R:6371e3,distance:function(n,s){var u=Math.PI/180,c=n.lat*u,f=s.lat*u,g=Math.sin((s.lat-n.lat)*u/2),T=Math.sin((s.lng-n.lng)*u/2),O=g*g+Math.cos(c)*Math.cos(f)*T*T,D=2*Math.atan2(Math.sqrt(O),Math.sqrt(1-O));return this.R*D}}),Ir=6378137,Ar={R:Ir,MAX_LATITUDE:85.0511287798,project:function(n){var s=Math.PI/180,u=this.MAX_LATITUDE,c=Math.max(Math.min(u,n.lat),-u),f=Math.sin(c*s);return new J(this.R*n.lng*s,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(n){var s=180/Math.PI;return new ft((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*s,n.x*s/this.R)},bounds:(function(){var n=Ir*Math.PI;return new wt([-n,-n],[n,n])})()};function Pr(n,s,u,c){if(et(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=s,this._c=u,this._d=c}Pr.prototype={transform:function(n,s){return this._transform(n.clone(),s)},_transform:function(n,s){return s=s||1,n.x=s*(this._a*n.x+this._b),n.y=s*(this._c*n.y+this._d),n},untransform:function(n,s){return s=s||1,new J((n.x/s-this._b)/this._a,(n.y/s-this._d)/this._c)}};function En(n,s,u,c){return new Pr(n,s,u,c)}var Xn=o({},ve,{code:"EPSG:3857",projection:Ar,transformation:(function(){var n=.5/(Math.PI*Ar.R);return En(n,.5,-n,.5)})()}),ks=o({},Xn,{code:"EPSG:900913"});function xs(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function xi(n,s){var u="",c,f,g,T,O,D;for(c=0,g=n.length;c<g;c++){for(O=n[c],f=0,T=O.length;f<T;f++)D=O[f],u+=(f?"L":"M")+D.x+" "+D.y;u+=s?q.svg?"z":"x":""}return u||"M0 0"}var Qn=document.documentElement.style,Yn="ActiveXObject"in window,Ut=Yn&&!document.addEventListener,Ft="msLaunchUri"in navigator&&!("documentMode"in document),In=he("webkit"),Ls=he("android"),br=he("android 2")||he("android 3"),oa=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ti=Ls&&he("Google")&&oa<537&&!("AudioNode"in window),Li=!!window.opera,Sr=!Ft&&he("chrome"),Oi=he("gecko")&&!In&&!Li&&!Yn,aa=!Sr&&he("safari"),Os=he("phantom"),Cr="OTransition"in Qn,Ns=navigator.platform.indexOf("Win")===0,An=Yn&&"transition"in Qn,ei="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!br,Ni="MozPerspective"in Qn,nn=!window.L_DISABLE_3D&&(An||ei||Ni)&&!Cr&&!Os,Pn=typeof orientation<"u"||he("mobile"),Di=Pn&&In,Ds=Pn&&ei,bn=!window.PointerEvent&&window.MSPointerEvent,Rr=!!(window.PointerEvent||bn),zt="ontouchstart"in window||!!window.TouchEvent,Ms=!window.L_NO_TOUCH&&(zt||Rr),ni=Pn&&Li,ii=Pn&&Oi,ua=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ha=(function(){var n=!1;try{var s=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",b,s),window.removeEventListener("testPassiveEventSupport",b,s)}catch{}return n})(),Sn=(function(){return!!document.createElement("canvas").getContext})(),kr=!!(document.createElementNS&&xs("svg").createSVGRect),ca=!!kr&&(function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Mi=!kr&&(function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var s=n.firstChild;return s.style.behavior="url(#default#VML)",s&&typeof s.adj=="object"}catch{return!1}})(),Vs=navigator.platform.indexOf("Mac")===0,Bs=navigator.platform.indexOf("Linux")===0;function he(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var q={ie:Yn,ielt9:Ut,edge:Ft,webkit:In,android:Ls,android23:br,androidStock:ti,opera:Li,chrome:Sr,gecko:Oi,safari:aa,phantom:Os,opera12:Cr,win:Ns,ie3d:An,webkit3d:ei,gecko3d:Ni,any3d:nn,mobile:Pn,mobileWebkit:Di,mobileWebkit3d:Ds,msPointer:bn,pointer:Rr,touch:Ms,touchNative:zt,mobileOpera:ni,mobileGecko:ii,retina:ua,passiveEvents:ha,canvas:Sn,svg:kr,vml:Mi,inlineSvg:ca,mac:Vs,linux:Bs},Us=q.msPointer?"MSPointerDown":"pointerdown",Se=q.msPointer?"MSPointerMove":"pointermove",xr=q.msPointer?"MSPointerUp":"pointerup",Lr=q.msPointer?"MSPointerCancel":"pointercancel",ri={touchstart:Us,touchmove:Se,touchend:xr,touchcancel:Lr},Vi={touchstart:Or,touchmove:we,touchend:we,touchcancel:we},rn={},Fs=!1;function zs(n,s,u){return s==="touchstart"&&si(),Vi[s]?(u=Vi[s].bind(this,u),n.addEventListener(ri[s],u,!1),u):(console.warn("wrong event specified:",s),b)}function la(n,s,u){if(!ri[s]){console.warn("wrong event specified:",s);return}n.removeEventListener(ri[s],u,!1)}function Bi(n){rn[n.pointerId]=n}function Hs(n){rn[n.pointerId]&&(rn[n.pointerId]=n)}function Ui(n){delete rn[n.pointerId]}function si(){Fs||(document.addEventListener(Us,Bi,!0),document.addEventListener(Se,Hs,!0),document.addEventListener(xr,Ui,!0),document.addEventListener(Lr,Ui,!0),Fs=!0)}function we(n,s){if(s.pointerType!==(s.MSPOINTER_TYPE_MOUSE||"mouse")){s.touches=[];for(var u in rn)s.touches.push(rn[u]);s.changedTouches=[s],n(s)}}function Or(n,s){s.MSPOINTER_TYPE_TOUCH&&s.pointerType===s.MSPOINTER_TYPE_TOUCH&&Nt(s),we(n,s)}function da(n){var s={},u,c;for(c in n)u=n[c],s[c]=u&&u.bind?u.bind(n):u;return n=s,s.type="dblclick",s.detail=2,s.isTrusted=!1,s._simulated=!0,s}var js=200;function Ws(n,s){n.addEventListener("dblclick",s);var u=0,c;function f(g){if(g.detail!==1){c=g.detail;return}if(!(g.pointerType==="mouse"||g.sourceCapabilities&&!g.sourceCapabilities.firesTouchEvents)){var T=Br(g);if(!(T.some(function(D){return D instanceof HTMLLabelElement&&D.attributes.for})&&!T.some(function(D){return D instanceof HTMLInputElement||D instanceof HTMLSelectElement}))){var O=Date.now();O-u<=js?(c++,c===2&&s(da(g))):c=1,u=O}}}return n.addEventListener("click",f),{dblclick:s,simDblclick:f}}function qs(n,s){n.removeEventListener("dblclick",s.dblclick),n.removeEventListener("click",s.simDblclick)}var oi=Fi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),sn=Fi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Nr=sn==="webkitTransition"||sn==="OTransition"?sn+"End":"transitionend";function Dr(n){return typeof n=="string"?document.getElementById(n):n}function Cn(n,s){var u=n.style[s]||n.currentStyle&&n.currentStyle[s];if((!u||u==="auto")&&document.defaultView){var c=document.defaultView.getComputedStyle(n,null);u=c?c[s]:null}return u==="auto"?null:u}function ct(n,s,u){var c=document.createElement(n);return c.className=s||"",u&&u.appendChild(c),c}function pt(n){var s=n.parentNode;s&&s.removeChild(n)}function re(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function Te(n){var s=n.parentNode;s&&s.lastChild!==n&&s.appendChild(n)}function Ee(n){var s=n.parentNode;s&&s.firstChild!==n&&s.insertBefore(n,s.firstChild)}function ai(n,s){if(n.classList!==void 0)return n.classList.contains(s);var u=Be(n);return u.length>0&&new RegExp("(^|\\s)"+s+"(\\s|$)").test(u)}function W(n,s){if(n.classList!==void 0)for(var u=z(s),c=0,f=u.length;c<f;c++)n.classList.add(u[c]);else if(!ai(n,s)){var g=Be(n);on(n,(g?g+" ":"")+s)}}function Tt(n,s){n.classList!==void 0?n.classList.remove(s):on(n,U((" "+Be(n)+" ").replace(" "+s+" "," ")))}function on(n,s){n.className.baseVal===void 0?n.className=s:n.className.baseVal=s}function Be(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function ce(n,s){"opacity"in n.style?n.style.opacity=s:"filter"in n.style&&Zs(n,s)}function Zs(n,s){var u=!1,c="DXImageTransform.Microsoft.Alpha";try{u=n.filters.item(c)}catch{if(s===1)return}s=Math.round(s*100),u?(u.Enabled=s!==100,u.Opacity=s):n.style.filter+=" progid:"+c+"(opacity="+s+")"}function Fi(n){for(var s=document.documentElement.style,u=0;u<n.length;u++)if(n[u]in s)return n[u];return!1}function an(n,s,u){var c=s||new J(0,0);n.style[oi]=(q.ie3d?"translate("+c.x+"px,"+c.y+"px)":"translate3d("+c.x+"px,"+c.y+"px,0)")+(u?" scale("+u+")":"")}function Rt(n,s){n._leaflet_pos=s,q.any3d?an(n,s):(n.style.left=s.x+"px",n.style.top=s.y+"px")}function un(n){return n._leaflet_pos||new J(0,0)}var Ce,_e,zi;if("onselectstart"in document)Ce=function(){Y(window,"selectstart",Nt)},_e=function(){vt(window,"selectstart",Nt)};else{var Rn=Fi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ce=function(){if(Rn){var n=document.documentElement.style;zi=n[Rn],n[Rn]="none"}},_e=function(){Rn&&(document.documentElement.style[Rn]=zi,zi=void 0)}}function Hi(){Y(window,"dragstart",Nt)}function ji(){vt(window,"dragstart",Nt)}var ui,Ue;function Mr(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(Wi(),ui=n,Ue=n.style.outlineStyle,n.style.outlineStyle="none",Y(window,"keydown",Wi))}function Wi(){ui&&(ui.style.outlineStyle=Ue,ui=void 0,Ue=void 0,vt(window,"keydown",Wi))}function Gs(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function Ie(n){var s=n.getBoundingClientRect();return{x:s.width/n.offsetWidth||1,y:s.height/n.offsetHeight||1,boundingClientRect:s}}var fa={__proto__:null,TRANSFORM:oi,TRANSITION:sn,TRANSITION_END:Nr,get:Dr,getStyle:Cn,create:ct,remove:pt,empty:re,toFront:Te,toBack:Ee,hasClass:ai,addClass:W,removeClass:Tt,setClass:on,getClass:Be,setOpacity:ce,testProp:Fi,setTransform:an,setPosition:Rt,getPosition:un,get disableTextSelection(){return Ce},get enableTextSelection(){return _e},disableImageDrag:Hi,enableImageDrag:ji,preventOutline:Mr,restoreOutline:Wi,getSizedParentNode:Gs,getScale:Ie};function Y(n,s,u,c){if(s&&typeof s=="object")for(var f in s)qi(n,f,s[f],u);else{s=z(s);for(var g=0,T=s.length;g<T;g++)qi(n,s[g],u,c)}return this}var se="_leaflet_events";function vt(n,s,u,c){if(arguments.length===1)kn(n),delete n[se];else if(s&&typeof s=="object")for(var f in s)hi(n,f,s[f],u);else if(s=z(s),arguments.length===2)kn(n,function(O){return dt(s,O)!==-1});else for(var g=0,T=s.length;g<T;g++)hi(n,s[g],u,c);return this}function kn(n,s){for(var u in n[se]){var c=u.split(/\d/)[0];(!s||s(c))&&hi(n,c,null,null,u)}}var hn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function qi(n,s,u,c){var f=s+_(u)+(c?"_"+_(c):"");if(n[se]&&n[se][f])return this;var g=function(O){return u.call(c||n,O||window.event)},T=g;!q.touchNative&&q.pointer&&s.indexOf("touch")===0?g=zs(n,s,g):q.touch&&s==="dblclick"?g=Ws(n,g):"addEventListener"in n?s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?n.addEventListener(hn[s]||s,g,q.passiveEvents?{passive:!1}:!1):s==="mouseenter"||s==="mouseleave"?(g=function(O){O=O||window.event,Fr(n,O)&&T(O)},n.addEventListener(hn[s],g,!1)):n.addEventListener(s,T,!1):n.attachEvent("on"+s,g),n[se]=n[se]||{},n[se][f]=g}function hi(n,s,u,c,f){f=f||s+_(u)+(c?"_"+_(c):"");var g=n[se]&&n[se][f];if(!g)return this;!q.touchNative&&q.pointer&&s.indexOf("touch")===0?la(n,s,g):q.touch&&s==="dblclick"?qs(n,g):"removeEventListener"in n?n.removeEventListener(hn[s]||s,g,!1):n.detachEvent("on"+s,g),n[se][f]=null}function _t(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function Vr(n){return qi(n,"wheel",_t),this}function ci(n){return Y(n,"mousedown touchstart dblclick contextmenu",_t),n._leaflet_disable_click=!0,this}function Nt(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Fe(n){return Nt(n),_t(n),this}function Br(n){if(n.composedPath)return n.composedPath();for(var s=[],u=n.target;u;)s.push(u),u=u.parentNode;return s}function li(n,s){if(!s)return new J(n.clientX,n.clientY);var u=Ie(s),c=u.boundingClientRect;return new J((n.clientX-c.left)/u.x-s.clientLeft,(n.clientY-c.top)/u.y-s.clientTop)}var ze=q.linux&&q.chrome?window.devicePixelRatio:q.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ur(n){return q.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/ze:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function Fr(n,s){var u=s.relatedTarget;if(!u)return!0;try{for(;u&&u!==n;)u=u.parentNode}catch{return!1}return u!==n}var di={__proto__:null,on:Y,off:vt,stopPropagation:_t,disableScrollPropagation:Vr,disableClickPropagation:ci,preventDefault:Nt,stop:Fe,getPropagationPath:Br,getMousePosition:li,getWheelDelta:Ur,isExternalTarget:Fr,addListener:Y,removeListener:vt},zr=$n.extend({run:function(n,s,u,c){this.stop(),this._el=n,this._inProgress=!0,this._duration=u||.25,this._easeOutPower=1/Math.max(c||.5,.2),this._startPos=un(n),this._offset=s.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(n){var s=+new Date-this._startTime,u=this._duration*1e3;s<u?this._runFrame(this._easeOut(s/u),n):(this._runFrame(1),this._complete())},_runFrame:function(n,s){var u=this._startPos.add(this._offset.multiplyBy(n));s&&u._round(),Rt(this._el,u),this.fire("step")},_complete:function(){k(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),st=$n.extend({options:{crs:Xn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,s){s=H(this,s),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.zoom!==void 0&&(this._zoom=this._limitZoom(s.zoom)),s.center&&s.zoom!==void 0&&this.setView(rt(s.center),s.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=sn&&q.any3d&&!q.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Y(this._proxy,Nr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,s,u){if(s=s===void 0?this._zoom:this._limitZoom(s),n=this._limitCenter(rt(n),s,this.options.maxBounds),u=u||{},this._stop(),this._loaded&&!u.reset&&u!==!0){u.animate!==void 0&&(u.zoom=o({animate:u.animate},u.zoom),u.pan=o({animate:u.animate,duration:u.duration},u.pan));var c=this._zoom!==s?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,s,u.zoom):this._tryAnimatedPan(n,u.pan);if(c)return clearTimeout(this._sizeTimer),this}return this._resetView(n,s,u.pan&&u.pan.noMoveStart),this},setZoom:function(n,s){return this._loaded?this.setView(this.getCenter(),n,{zoom:s}):(this._zoom=n,this)},zoomIn:function(n,s){return n=n||(q.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,s)},zoomOut:function(n,s){return n=n||(q.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,s)},setZoomAround:function(n,s,u){var c=this.getZoomScale(s),f=this.getSize().divideBy(2),g=n instanceof J?n:this.latLngToContainerPoint(n),T=g.subtract(f).multiplyBy(1-1/c),O=this.containerPointToLatLng(f.add(T));return this.setView(O,s,{zoom:u})},_getBoundsCenterZoom:function(n,s){s=s||{},n=n.getBounds?n.getBounds():It(n);var u=Q(s.paddingTopLeft||s.padding||[0,0]),c=Q(s.paddingBottomRight||s.padding||[0,0]),f=this.getBoundsZoom(n,!1,u.add(c));if(f=typeof s.maxZoom=="number"?Math.min(s.maxZoom,f):f,f===1/0)return{center:n.getCenter(),zoom:f};var g=c.subtract(u).divideBy(2),T=this.project(n.getSouthWest(),f),O=this.project(n.getNorthEast(),f),D=this.unproject(T.add(O).divideBy(2).add(g),f);return{center:D,zoom:f}},fitBounds:function(n,s){if(n=It(n),!n.isValid())throw new Error("Bounds are not valid.");var u=this._getBoundsCenterZoom(n,s);return this.setView(u.center,u.zoom,s)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,s){return this.setView(n,this._zoom,{pan:s})},panBy:function(n,s){if(n=Q(n).round(),s=s||{},!n.x&&!n.y)return this.fire("moveend");if(s.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new zr,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),s.noMoveStart||this.fire("movestart"),s.animate!==!1){W(this._mapPane,"leaflet-pan-anim");var u=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,u,s.duration||.25,s.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,s,u){if(u=u||{},u.animate===!1||!q.any3d)return this.setView(n,s,u);this._stop();var c=this.project(this.getCenter()),f=this.project(n),g=this.getSize(),T=this._zoom;n=rt(n),s=s===void 0?T:s;var O=Math.max(g.x,g.y),D=O*this.getZoomScale(T,s),V=f.distanceTo(c)||1,j=1.42,$=j*j;function ot(Dt){var ho=Dt?-1:1,Af=Dt?D:O,Pf=D*D-O*O+ho*$*$*V*V,bf=2*Af*$*V,ya=Pf/bf,fh=Math.sqrt(ya*ya+1)-ya,Sf=fh<1e-9?-18:Math.log(fh);return Sf}function oe(Dt){return(Math.exp(Dt)-Math.exp(-Dt))/2}function Ht(Dt){return(Math.exp(Dt)+Math.exp(-Dt))/2}function be(Dt){return oe(Dt)/Ht(Dt)}var de=ot(0);function rr(Dt){return O*(Ht(de)/Ht(de+j*Dt))}function wf(Dt){return O*(Ht(de)*be(de+j*Dt)-oe(de))/$}function Tf(Dt){return 1-Math.pow(1-Dt,1.5)}var Ef=Date.now(),lh=(ot(1)-de)/j,If=u.duration?1e3*u.duration:1e3*lh*.8;function dh(){var Dt=(Date.now()-Ef)/If,ho=Tf(Dt)*lh;Dt<=1?(this._flyToFrame=P(dh,this),this._move(this.unproject(c.add(f.subtract(c).multiplyBy(wf(ho)/V)),T),this.getScaleZoom(O/rr(ho),T),{flyTo:!0})):this._move(n,s)._moveEnd(!0)}return this._moveStart(!0,u.noMoveStart),dh.call(this),this},flyToBounds:function(n,s){var u=this._getBoundsCenterZoom(n,s);return this.flyTo(u.center,u.zoom,s)},setMaxBounds:function(n){return n=It(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var s=this.options.minZoom;return this.options.minZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var s=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&s!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,s){this._enforcingBounds=!0;var u=this.getCenter(),c=this._limitCenter(u,this._zoom,It(n));return u.equals(c)||this.panTo(c,s),this._enforcingBounds=!1,this},panInside:function(n,s){s=s||{};var u=Q(s.paddingTopLeft||s.padding||[0,0]),c=Q(s.paddingBottomRight||s.padding||[0,0]),f=this.project(this.getCenter()),g=this.project(n),T=this.getPixelBounds(),O=qt([T.min.add(u),T.max.subtract(c)]),D=O.getSize();if(!O.contains(g)){this._enforcingBounds=!0;var V=g.subtract(O.getCenter()),j=O.extend(g).getSize().subtract(D);f.x+=V.x<0?-j.x:j.x,f.y+=V.y<0?-j.y:j.y,this.panTo(this.unproject(f),s),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=o({animate:!1,pan:!0},n===!0?{animate:!0}:n);var s=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var u=this.getSize(),c=s.divideBy(2).round(),f=u.divideBy(2).round(),g=c.subtract(f);return!g.x&&!g.y?this:(n.animate&&n.pan?this.panBy(g):(n.pan&&this._rawPanBy(g),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:s,newSize:u}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=o({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var s=l(this._handleGeolocationResponse,this),u=l(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(s,u,n):navigator.geolocation.getCurrentPosition(s,u,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var s=n.code,u=n.message||(s===1?"permission denied":s===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:s,message:"Geolocation error: "+u+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var s=n.coords.latitude,u=n.coords.longitude,c=new ft(s,u),f=c.toBounds(n.coords.accuracy*2),g=this._locateOptions;if(g.setView){var T=this.getBoundsZoom(f);this.setView(c,g.maxZoom?Math.min(T,g.maxZoom):T)}var O={latlng:c,bounds:f,timestamp:n.timestamp};for(var D in n.coords)typeof n.coords[D]=="number"&&(O[D]=n.coords[D]);this.fire("locationfound",O)}},addHandler:function(n,s){if(!s)return this;var u=this[n]=new s(this);return this._handlers.push(u),this.options[n]&&u.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),pt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(k(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)pt(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,s){var u="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),c=ct("div",u,s||this._mapPane);return n&&(this._panes[n]=c),c},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),s=this.unproject(n.getBottomLeft()),u=this.unproject(n.getTopRight());return new Zt(s,u)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,s,u){n=It(n),u=Q(u||[0,0]);var c=this.getZoom()||0,f=this.getMinZoom(),g=this.getMaxZoom(),T=n.getNorthWest(),O=n.getSouthEast(),D=this.getSize().subtract(u),V=qt(this.project(O,c),this.project(T,c)).getSize(),j=q.any3d?this.options.zoomSnap:1,$=D.x/V.x,ot=D.y/V.y,oe=s?Math.max($,ot):Math.min($,ot);return c=this.getScaleZoom(oe,c),j&&(c=Math.round(c/(j/100))*(j/100),c=s?Math.ceil(c/j)*j:Math.floor(c/j)*j),Math.max(f,Math.min(g,c))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new J(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,s){var u=this._getTopLeftPoint(n,s);return new wt(u,u.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,s){var u=this.options.crs;return s=s===void 0?this._zoom:s,u.scale(n)/u.scale(s)},getScaleZoom:function(n,s){var u=this.options.crs;s=s===void 0?this._zoom:s;var c=u.zoom(n*u.scale(s));return isNaN(c)?1/0:c},project:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.latLngToPoint(rt(n),s)},unproject:function(n,s){return s=s===void 0?this._zoom:s,this.options.crs.pointToLatLng(Q(n),s)},layerPointToLatLng:function(n){var s=Q(n).add(this.getPixelOrigin());return this.unproject(s)},latLngToLayerPoint:function(n){var s=this.project(rt(n))._round();return s._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(rt(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(It(n))},distance:function(n,s){return this.options.crs.distance(rt(n),rt(s))},containerPointToLayerPoint:function(n){return Q(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return Q(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var s=this.containerPointToLayerPoint(Q(n));return this.layerPointToLatLng(s)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(rt(n)))},mouseEventToContainerPoint:function(n){return li(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var s=this._container=Dr(n);if(s){if(s._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Y(s,"scroll",this._onScroll,this),this._containerId=_(s)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&q.any3d,W(n,"leaflet-container"+(q.touch?" leaflet-touch":"")+(q.retina?" leaflet-retina":"")+(q.ielt9?" leaflet-oldie":"")+(q.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var s=Cn(n,"position");s!=="absolute"&&s!=="relative"&&s!=="fixed"&&s!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Rt(this._mapPane,new J(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(W(n.markerPane,"leaflet-zoom-hide"),W(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,s,u){Rt(this._mapPane,new J(0,0));var c=!this._loaded;this._loaded=!0,s=this._limitZoom(s),this.fire("viewprereset");var f=this._zoom!==s;this._moveStart(f,u)._move(n,s)._moveEnd(f),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(n,s){return n&&this.fire("zoomstart"),s||this.fire("movestart"),this},_move:function(n,s,u,c){s===void 0&&(s=this._zoom);var f=this._zoom!==s;return this._zoom=s,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),c?u&&u.pinch&&this.fire("zoom",u):((f||u&&u.pinch)&&this.fire("zoom",u),this.fire("move",u)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return k(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){Rt(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[_(this._container)]=this;var s=n?vt:Y;s(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&s(window,"resize",this._onResize,this),q.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){k(this._resizeRequest),this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,s){for(var u=[],c,f=s==="mouseout"||s==="mouseover",g=n.target||n.srcElement,T=!1;g;){if(c=this._targets[_(g)],c&&(s==="click"||s==="preclick")&&this._draggableMoved(c)){T=!0;break}if(c&&c.listens(s,!0)&&(f&&!Fr(g,n)||(u.push(c),f))||g===this._container)break;g=g.parentNode}return!u.length&&!T&&!f&&this.listens(s,!0)&&(u=[this]),u},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var s=n.target||n.srcElement;if(!(!this._loaded||s._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(s))){var u=n.type;u==="mousedown"&&Mr(s),this._fireDOMEvent(n,u)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,s,u){if(n.type==="click"){var c=o({},n);c.type="preclick",this._fireDOMEvent(c,c.type,u)}var f=this._findEventTargets(n,s);if(u){for(var g=[],T=0;T<u.length;T++)u[T].listens(s,!0)&&g.push(u[T]);f=g.concat(f)}if(f.length){s==="contextmenu"&&Nt(n);var O=f[0],D={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var V=O.getLatLng&&(!O._radius||O._radius<=10);D.containerPoint=V?this.latLngToContainerPoint(O.getLatLng()):this.mouseEventToContainerPoint(n),D.layerPoint=this.containerPointToLayerPoint(D.containerPoint),D.latlng=V?O.getLatLng():this.layerPointToLatLng(D.layerPoint)}for(T=0;T<f.length;T++)if(f[T].fire(s,D,!0),D.originalEvent._stopped||f[T].options.bubblingMouseEvents===!1&&dt(this._mouseEvents,s)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,s=this._handlers.length;n<s;n++)this._handlers[n].disable()},whenReady:function(n,s){return this._loaded?n.call(s||this,{target:this}):this.on("load",n,s),this},_getMapPanePos:function(){return un(this._mapPane)||new J(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,s){var u=n&&s!==void 0?this._getNewPixelOrigin(n,s):this.getPixelOrigin();return u.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,s){var u=this.getSize()._divideBy(2);return this.project(n,s)._subtract(u)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,s,u){var c=this._getNewPixelOrigin(u,s);return this.project(n,s)._subtract(c)},_latLngBoundsToNewLayerBounds:function(n,s,u){var c=this._getNewPixelOrigin(u,s);return qt([this.project(n.getSouthWest(),s)._subtract(c),this.project(n.getNorthWest(),s)._subtract(c),this.project(n.getSouthEast(),s)._subtract(c),this.project(n.getNorthEast(),s)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,s,u){if(!u)return n;var c=this.project(n,s),f=this.getSize().divideBy(2),g=new wt(c.subtract(f),c.add(f)),T=this._getBoundsOffset(g,u,s);return Math.abs(T.x)<=1&&Math.abs(T.y)<=1?n:this.unproject(c.add(T),s)},_limitOffset:function(n,s){if(!s)return n;var u=this.getPixelBounds(),c=new wt(u.min.add(n),u.max.add(n));return n.add(this._getBoundsOffset(c,s))},_getBoundsOffset:function(n,s,u){var c=qt(this.project(s.getNorthEast(),u),this.project(s.getSouthWest(),u)),f=c.min.subtract(n.min),g=c.max.subtract(n.max),T=this._rebound(f.x,-g.x),O=this._rebound(f.y,-g.y);return new J(T,O)},_rebound:function(n,s){return n+s>0?Math.round(n-s)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(s))},_limitZoom:function(n){var s=this.getMinZoom(),u=this.getMaxZoom(),c=q.any3d?this.options.zoomSnap:1;return c&&(n=Math.round(n/c)*c),Math.max(s,Math.min(u,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Tt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,s){var u=this._getCenterOffset(n)._trunc();return(s&&s.animate)!==!0&&!this.getSize().contains(u)?!1:(this.panBy(u,s),!0)},_createAnimProxy:function(){var n=this._proxy=ct("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(s){var u=oi,c=this._proxy.style[u];an(this._proxy,this.project(s.center,s.zoom),this.getZoomScale(s.zoom,1)),c===this._proxy.style[u]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){pt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),s=this.getZoom();an(this._proxy,this.project(n,s),this.getZoomScale(s,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,s,u){if(this._animatingZoom)return!0;if(u=u||{},!this._zoomAnimated||u.animate===!1||this._nothingToAnimate()||Math.abs(s-this._zoom)>this.options.zoomAnimationThreshold)return!1;var c=this.getZoomScale(s),f=this._getCenterOffset(n)._divideBy(1-1/c);return u.animate!==!0&&!this.getSize().contains(f)?!1:(P(function(){this._moveStart(!0,u.noMoveStart||!1)._animateZoom(n,s,!0)},this),!0)},_animateZoom:function(n,s,u,c){this._mapPane&&(u&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=s,W(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:s,noUpdate:c}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Tt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Zi(n,s){return new st(n,s)}var le=At.extend({options:{position:"topright"},initialize:function(n){H(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var s=this._map;return s&&s.removeControl(this),this.options.position=n,s&&s.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var s=this._container=this.onAdd(n),u=this.getPosition(),c=n._controlCorners[u];return W(s,"leaflet-control"),u.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(pt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),He=function(n){return new le(n)};st.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},s="leaflet-",u=this._controlContainer=ct("div",s+"control-container",this._container);function c(f,g){var T=s+f+" "+s+g;n[f+g]=ct("div",T,u)}c("top","left"),c("top","right"),c("bottom","left"),c("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)pt(this._controlCorners[n]);pt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ks=le.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,s,u,c){return u<c?-1:c<u?1:0}},initialize:function(n,s,u){H(this,u),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var c in n)this._addLayer(n[c],c);for(c in s)this._addLayer(s[c],c,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return le.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,s){return this._addLayer(n,s),this._map?this._update():this},addOverlay:function(n,s){return this._addLayer(n,s,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var s=this._getLayer(_(n));return s&&this._layers.splice(this._layers.indexOf(s),1),this._map?this._update():this},expand:function(){W(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(W(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):Tt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Tt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",s=this._container=ct("div",n),u=this.options.collapsed;s.setAttribute("aria-haspopup",!0),ci(s),Vr(s);var c=this._section=ct("section",n+"-list");u&&(this._map.on("click",this.collapse,this),Y(s,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var f=this._layersLink=ct("a",n+"-toggle",s);f.href="#",f.title="Layers",f.setAttribute("role","button"),Y(f,{keydown:function(g){g.keyCode===13&&this._expandSafely()},click:function(g){Nt(g),this._expandSafely()}},this),u||this.expand(),this._baseLayersList=ct("div",n+"-base",c),this._separator=ct("div",n+"-separator",c),this._overlaysList=ct("div",n+"-overlays",c),s.appendChild(c)},_getLayer:function(n){for(var s=0;s<this._layers.length;s++)if(this._layers[s]&&_(this._layers[s].layer)===n)return this._layers[s]},_addLayer:function(n,s,u){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:s,overlay:u}),this.options.sortLayers&&this._layers.sort(l(function(c,f){return this.options.sortFunction(c.layer,f.layer,c.name,f.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;re(this._baseLayersList),re(this._overlaysList),this._layerControlInputs=[];var n,s,u,c,f=0;for(u=0;u<this._layers.length;u++)c=this._layers[u],this._addItem(c),s=s||c.overlay,n=n||!c.overlay,f+=c.overlay?0:1;return this.options.hideSingleBase&&(n=n&&f>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=s&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var s=this._getLayer(_(n.target)),u=s.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;u&&this._map.fire(u,s)},_createRadioElement:function(n,s){var u='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(s?' checked="checked"':"")+"/>",c=document.createElement("div");return c.innerHTML=u,c.firstChild},_addItem:function(n){var s=document.createElement("label"),u=this._map.hasLayer(n.layer),c;n.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=u):c=this._createRadioElement("leaflet-base-layers_"+_(this),u),this._layerControlInputs.push(c),c.layerId=_(n.layer),Y(c,"click",this._onInputClick,this);var f=document.createElement("span");f.innerHTML=" "+n.name;var g=document.createElement("span");s.appendChild(g),g.appendChild(c),g.appendChild(f);var T=n.overlay?this._overlaysList:this._baseLayersList;return T.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,s,u,c=[],f=[];this._handlingClick=!0;for(var g=n.length-1;g>=0;g--)s=n[g],u=this._getLayer(s.layerId).layer,s.checked?c.push(u):s.checked||f.push(u);for(g=0;g<f.length;g++)this._map.hasLayer(f[g])&&this._map.removeLayer(f[g]);for(g=0;g<c.length;g++)this._map.hasLayer(c[g])||this._map.addLayer(c[g]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,s,u,c=this._map.getZoom(),f=n.length-1;f>=0;f--)s=n[f],u=this._getLayer(s.layerId).layer,s.disabled=u.options.minZoom!==void 0&&c<u.options.minZoom||u.options.maxZoom!==void 0&&c>u.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,Y(n,"click",Nt),this.expand();var s=this;setTimeout(function(){vt(n,"click",Nt),s._preventClick=!1})}}),$s=function(n,s,u){return new Ks(n,s,u)},cn=le.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var s="leaflet-control-zoom",u=ct("div",s+" leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,s+"-in",u,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,s+"-out",u,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),u},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,s,u,c,f){var g=ct("a",u,c);return g.innerHTML=n,g.href="#",g.title=s,g.setAttribute("role","button"),g.setAttribute("aria-label",s),ci(g),Y(g,"click",Fe),Y(g,"click",f,this),Y(g,"click",this._refocusOnMap,this),g},_updateDisabled:function(){var n=this._map,s="leaflet-disabled";Tt(this._zoomInButton,s),Tt(this._zoomOutButton,s),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(W(this._zoomOutButton,s),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(W(this._zoomInButton,s),this._zoomInButton.setAttribute("aria-disabled","true"))}});st.mergeOptions({zoomControl:!0}),st.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new cn,this.addControl(this.zoomControl))});var Js=function(n){return new cn(n)},Hr=le.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var s="leaflet-control-scale",u=ct("div",s),c=this.options;return this._addScales(c,s+"-line",u),n.on(c.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),u},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,s,u){n.metric&&(this._mScale=ct("div",s,u)),n.imperial&&(this._iScale=ct("div",s,u))},_update:function(){var n=this._map,s=n.getSize().y/2,u=n.distance(n.containerPointToLatLng([0,s]),n.containerPointToLatLng([this.options.maxWidth,s]));this._updateScales(u)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var s=this._getRoundNum(n),u=s<1e3?s+" m":s/1e3+" km";this._updateScale(this._mScale,u,s/n)},_updateImperial:function(n){var s=n*3.2808399,u,c,f;s>5280?(u=s/5280,c=this._getRoundNum(u),this._updateScale(this._iScale,c+" mi",c/u)):(f=this._getRoundNum(s),this._updateScale(this._iScale,f+" ft",f/s))},_updateScale:function(n,s,u){n.style.width=Math.round(this.options.maxWidth*u)+"px",n.innerHTML=s},_getRoundNum:function(n){var s=Math.pow(10,(Math.floor(n)+"").length-1),u=n/s;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:1,s*u}}),jr=function(n){return new Hr(n)},Wr='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Gi=le.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(q.inlineSvg?Wr+" ":"")+"Leaflet</a>"},initialize:function(n){H(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=ct("div","leaflet-control-attribution"),ci(this._container);for(var s in n._layers)n._layers[s].getAttribution&&this.addAttribution(n._layers[s].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var s in this._attributions)this._attributions[s]&&n.push(s);var u=[];this.options.prefix&&u.push(this.options.prefix),n.length&&u.push(n.join(", ")),this._container.innerHTML=u.join(' <span aria-hidden="true">|</span> ')}}});st.mergeOptions({attributionControl:!0}),st.addInitHook(function(){this.options.attributionControl&&new Gi().addTo(this)});var Ki=function(n){return new Gi(n)};le.Layers=Ks,le.Zoom=cn,le.Scale=Hr,le.Attribution=Gi,He.layers=$s,He.zoom=Js,He.scale=jr,He.attribution=Ki;var ge=At.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ge.addTo=function(n,s){return n.addHandler(s,this),this};var Xs={Events:ie},je=q.touch?"touchstart mousedown":"mousedown",Re=$n.extend({options:{clickTolerance:3},initialize:function(n,s,u,c){H(this,c),this._element=n,this._dragStartTarget=s||n,this._preventOutline=u},enable:function(){this._enabled||(Y(this._dragStartTarget,je,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Re._dragging===this&&this.finishDrag(!0),vt(this._dragStartTarget,je,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!ai(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Re._dragging===this&&this.finishDrag();return}if(!(Re._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Re._dragging=this,this._preventOutline&&Mr(this._element),Hi(),Ce(),!this._moving)){this.fire("down");var s=n.touches?n.touches[0]:n,u=Gs(this._element);this._startPoint=new J(s.clientX,s.clientY),this._startPos=un(this._element),this._parentScale=Ie(u);var c=n.type==="mousedown";Y(document,c?"mousemove":"touchmove",this._onMove,this),Y(document,c?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var s=n.touches&&n.touches.length===1?n.touches[0]:n,u=new J(s.clientX,s.clientY)._subtract(this._startPoint);!u.x&&!u.y||Math.abs(u.x)+Math.abs(u.y)<this.options.clickTolerance||(u.x/=this._parentScale.x,u.y/=this._parentScale.y,Nt(n),this._moved||(this.fire("dragstart"),this._moved=!0,W(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),W(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(u),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),Rt(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){Tt(document.body,"leaflet-dragging"),this._lastTarget&&(Tt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),vt(document,"mousemove touchmove",this._onMove,this),vt(document,"mouseup touchend touchcancel",this._onUp,this),ji(),_e();var s=this._moved&&this._moving;this._moving=!1,Re._dragging=!1,s&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function qr(n,s,u){var c,f=[1,4,2,8],g,T,O,D,V,j,$,ot;for(g=0,j=n.length;g<j;g++)n[g]._code=N(n[g],s);for(O=0;O<4;O++){for($=f[O],c=[],g=0,j=n.length,T=j-1;g<j;T=g++)D=n[g],V=n[T],D._code&$?V._code&$||(ot=x(V,D,$,s,u),ot._code=N(ot,s),c.push(ot)):(V._code&$&&(ot=x(V,D,$,s,u),ot._code=N(ot,s),c.push(ot)),c.push(D));n=c}return n}function Zr(n,s){var u,c,f,g,T,O,D,V,j;if(!n||n.length===0)throw new Error("latlngs not passed");mt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var $=rt([0,0]),ot=It(n),oe=ot.getNorthWest().distanceTo(ot.getSouthWest())*ot.getNorthEast().distanceTo(ot.getNorthWest());oe<1700&&($=$i(n));var Ht=n.length,be=[];for(u=0;u<Ht;u++){var de=rt(n[u]);be.push(s.project(rt([de.lat-$.lat,de.lng-$.lng])))}for(O=D=V=0,u=0,c=Ht-1;u<Ht;c=u++)f=be[u],g=be[c],T=f.y*g.x-g.y*f.x,D+=(f.x+g.x)*T,V+=(f.y+g.y)*T,O+=T*3;O===0?j=be[0]:j=[D/O,V/O];var rr=s.unproject(Q(j));return rt([rr.lat+$.lat,rr.lng+$.lng])}function $i(n){for(var s=0,u=0,c=0,f=0;f<n.length;f++){var g=rt(n[f]);s+=g.lat,u+=g.lng,c++}return rt([s/c,u/c])}var Ji={__proto__:null,clipPolygon:qr,polygonCenter:Zr,centroid:$i};function Xt(n,s){if(!s||!n.length)return n.slice();var u=s*s;return n=d(n,u),n=xn(n,u),n}function Gr(n,s,u){return Math.sqrt(tt(n,s,u,!0))}function Qs(n,s,u){return tt(n,s,u)}function xn(n,s){var u=n.length,c=typeof Uint8Array<"u"?Uint8Array:Array,f=new c(u);f[0]=f[u-1]=1,a(n,f,s,0,u-1);var g,T=[];for(g=0;g<u;g++)f[g]&&T.push(n[g]);return T}function a(n,s,u,c,f){var g=0,T,O,D;for(O=c+1;O<=f-1;O++)D=tt(n[O],n[c],n[f],!0),D>g&&(T=O,g=D);g>u&&(s[T]=1,a(n,s,u,c,T),a(n,s,u,T,f))}function d(n,s){for(var u=[n[0]],c=1,f=0,g=n.length;c<g;c++)F(n[c],n[f])>s&&(u.push(n[c]),f=c);return f<g-1&&u.push(n[g-1]),u}var p;function y(n,s,u,c,f){var g=c?p:N(n,u),T=N(s,u),O,D,V;for(p=T;;){if(!(g|T))return[n,s];if(g&T)return!1;O=g||T,D=x(n,s,O,u,f),V=N(D,u),O===g?(n=D,g=V):(s=D,T=V)}}function x(n,s,u,c,f){var g=s.x-n.x,T=s.y-n.y,O=c.min,D=c.max,V,j;return u&8?(V=n.x+g*(D.y-n.y)/T,j=D.y):u&4?(V=n.x+g*(O.y-n.y)/T,j=O.y):u&2?(V=D.x,j=n.y+T*(D.x-n.x)/g):u&1&&(V=O.x,j=n.y+T*(O.x-n.x)/g),new J(V,j,f)}function N(n,s){var u=0;return n.x<s.min.x?u|=1:n.x>s.max.x&&(u|=2),n.y<s.min.y?u|=4:n.y>s.max.y&&(u|=8),u}function F(n,s){var u=s.x-n.x,c=s.y-n.y;return u*u+c*c}function tt(n,s,u,c){var f=s.x,g=s.y,T=u.x-f,O=u.y-g,D=T*T+O*O,V;return D>0&&(V=((n.x-f)*T+(n.y-g)*O)/D,V>1?(f=u.x,g=u.y):V>0&&(f+=T*V,g+=O*V)),T=n.x-f,O=n.y-g,c?T*T+O*O:new J(f,g)}function mt(n){return!et(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function gt(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),mt(n)}function Ot(n,s){var u,c,f,g,T,O,D,V;if(!n||n.length===0)throw new Error("latlngs not passed");mt(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var j=rt([0,0]),$=It(n),ot=$.getNorthWest().distanceTo($.getSouthWest())*$.getNorthEast().distanceTo($.getNorthWest());ot<1700&&(j=$i(n));var oe=n.length,Ht=[];for(u=0;u<oe;u++){var be=rt(n[u]);Ht.push(s.project(rt([be.lat-j.lat,be.lng-j.lng])))}for(u=0,c=0;u<oe-1;u++)c+=Ht[u].distanceTo(Ht[u+1])/2;if(c===0)V=Ht[0];else for(u=0,g=0;u<oe-1;u++)if(T=Ht[u],O=Ht[u+1],f=T.distanceTo(O),g+=f,g>c){D=(g-c)/f,V=[O.x-D*(O.x-T.x),O.y-D*(O.y-T.y)];break}var de=s.unproject(Q(V));return rt([de.lat+j.lat,de.lng+j.lng])}var Ae={__proto__:null,simplify:Xt,pointToSegmentDistance:Gr,closestPointOnSegment:Qs,clipSegment:y,_getEdgeIntersection:x,_getBitCode:N,_sqClosestPointOnSegment:tt,isFlat:mt,_flat:gt,polylineCenter:Ot},ke={project:function(n){return new J(n.lng,n.lat)},unproject:function(n){return new ft(n.y,n.x)},bounds:new wt([-180,-90],[180,90])},Pe={R:6378137,R_MINOR:6356752314245179e-9,bounds:new wt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var s=Math.PI/180,u=this.R,c=n.lat*s,f=this.R_MINOR/u,g=Math.sqrt(1-f*f),T=g*Math.sin(c),O=Math.tan(Math.PI/4-c/2)/Math.pow((1-T)/(1+T),g/2);return c=-u*Math.log(Math.max(O,1e-10)),new J(n.lng*s*u,c)},unproject:function(n){for(var s=180/Math.PI,u=this.R,c=this.R_MINOR/u,f=Math.sqrt(1-c*c),g=Math.exp(-n.y/u),T=Math.PI/2-2*Math.atan(g),O=0,D=.1,V;O<15&&Math.abs(D)>1e-7;O++)V=f*Math.sin(T),V=Math.pow((1-V)/(1+V),f/2),D=Math.PI/2-2*Math.atan(g*V)-T,T+=D;return new ft(T*s,n.x*s/u)}},We={__proto__:null,LonLat:ke,Mercator:Pe,SphericalMercator:Ar},Xi=o({},ve,{code:"EPSG:3395",projection:Pe,transformation:(function(){var n=.5/(Math.PI*Pe.R);return En(n,.5,-n,.5)})()}),Qi=o({},ve,{code:"EPSG:4326",projection:ke,transformation:En(1/180,1,-1/180,.5)}),Xd=o({},me,{projection:ke,transformation:En(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,s){var u=s.lng-n.lng,c=s.lat-n.lat;return Math.sqrt(u*u+c*c)},infinite:!0});me.Earth=ve,me.EPSG3395=Xi,me.EPSG3857=Xn,me.EPSG900913=ks,me.EPSG4326=Qi,me.Simple=Xd;var xe=$n.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[_(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[_(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var s=n.target;if(s.hasLayer(this)){if(this._map=s,this._zoomAnimated=s._zoomAnimated,this.getEvents){var u=this.getEvents();s.on(u,this),this.once("remove",function(){s.off(u,this)},this)}this.onAdd(s),this.fire("add"),s.fire("layeradd",{layer:this})}}});st.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var s=_(n);return this._layers[s]?this:(this._layers[s]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var s=_(n);return this._layers[s]?(this._loaded&&n.onRemove(this),delete this._layers[s],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return _(n)in this._layers},eachLayer:function(n,s){for(var u in this._layers)n.call(s,this._layers[u]);return this},_addLayers:function(n){n=n?et(n)?n:[n]:[];for(var s=0,u=n.length;s<u;s++)this.addLayer(n[s])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[_(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var s=_(n);this._zoomBoundLayers[s]&&(delete this._zoomBoundLayers[s],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,s=-1/0,u=this._getZoomSpan();for(var c in this._zoomBoundLayers){var f=this._zoomBoundLayers[c].options;n=f.minZoom===void 0?n:Math.min(n,f.minZoom),s=f.maxZoom===void 0?s:Math.max(s,f.maxZoom)}this._layersMaxZoom=s===-1/0?void 0:s,this._layersMinZoom=n===1/0?void 0:n,u!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Yi=xe.extend({initialize:function(n,s){H(this,s),this._layers={};var u,c;if(n)for(u=0,c=n.length;u<c;u++)this.addLayer(n[u])},addLayer:function(n){var s=this.getLayerId(n);return this._layers[s]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var s=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[s]&&this._map.removeLayer(this._layers[s]),delete this._layers[s],this},hasLayer:function(n){var s=typeof n=="number"?n:this.getLayerId(n);return s in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var s=Array.prototype.slice.call(arguments,1),u,c;for(u in this._layers)c=this._layers[u],c[n]&&c[n].apply(c,s);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,s){for(var u in this._layers)n.call(s,this._layers[u]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return _(n)}}),Qd=function(n,s){return new Yi(n,s)},ln=Yi.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),Yi.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),Yi.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new Zt;for(var s in this._layers){var u=this._layers[s];n.extend(u.getBounds?u.getBounds():u.getLatLng())}return n}}),Yd=function(n,s){return new ln(n,s)},tr=At.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){H(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,s){var u=this._getIconUrl(n);if(!u){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var c=this._createImg(u,s&&s.tagName==="IMG"?s:null);return this._setIconStyles(c,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),c},_setIconStyles:function(n,s){var u=this.options,c=u[s+"Size"];typeof c=="number"&&(c=[c,c]);var f=Q(c),g=Q(s==="shadow"&&u.shadowAnchor||u.iconAnchor||f&&f.divideBy(2,!0));n.className="leaflet-marker-"+s+" "+(u.className||""),g&&(n.style.marginLeft=-g.x+"px",n.style.marginTop=-g.y+"px"),f&&(n.style.width=f.x+"px",n.style.height=f.y+"px")},_createImg:function(n,s){return s=s||document.createElement("img"),s.src=n,s},_getIconUrl:function(n){return q.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function tf(n){return new tr(n)}var Kr=tr.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Kr.imagePath!="string"&&(Kr.imagePath=this._detectIconPath()),(this.options.imagePath||Kr.imagePath)+tr.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var s=function(u,c,f){var g=c.exec(u);return g&&g[f]};return n=s(n,/^url\((['"])?(.+)\1\)$/,2),n&&s(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=ct("div","leaflet-default-icon-path",document.body),s=Cn(n,"background-image")||Cn(n,"backgroundImage");if(document.body.removeChild(n),s=this._stripUrl(s),s)return s;var u=document.querySelector('link[href$="leaflet.css"]');return u?u.href.substring(0,u.href.length-11-1):""}}),Zu=ge.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Re(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),W(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Tt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var s=this._marker,u=s._map,c=this._marker.options.autoPanSpeed,f=this._marker.options.autoPanPadding,g=un(s._icon),T=u.getPixelBounds(),O=u.getPixelOrigin(),D=qt(T.min._subtract(O).add(f),T.max._subtract(O).subtract(f));if(!D.contains(g)){var V=Q((Math.max(D.max.x,g.x)-D.max.x)/(T.max.x-D.max.x)-(Math.min(D.min.x,g.x)-D.min.x)/(T.min.x-D.min.x),(Math.max(D.max.y,g.y)-D.max.y)/(T.max.y-D.max.y)-(Math.min(D.min.y,g.y)-D.min.y)/(T.min.y-D.min.y)).multiplyBy(c);u.panBy(V,{animate:!1}),this._draggable._newPos._add(V),this._draggable._startPos._add(V),Rt(s._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=P(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(k(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,n)))},_onDrag:function(n){var s=this._marker,u=s._shadow,c=un(s._icon),f=s._map.layerPointToLatLng(c);u&&Rt(u,c),s._latlng=f,n.latlng=f,n.oldLatLng=this._oldLatLng,s.fire("move",n).fire("drag",n)},_onDragEnd:function(n){k(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Ys=xe.extend({options:{icon:new Kr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,s){H(this,s),this._latlng=rt(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var s=this._latlng;return this._latlng=rt(n),this.update(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,s="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),u=n.icon.createIcon(this._icon),c=!1;u!==this._icon&&(this._icon&&this._removeIcon(),c=!0,n.title&&(u.title=n.title),u.tagName==="IMG"&&(u.alt=n.alt||"")),W(u,s),n.keyboard&&(u.tabIndex="0",u.setAttribute("role","button")),this._icon=u,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Y(u,"focus",this._panOnFocus,this);var f=n.icon.createShadow(this._shadow),g=!1;f!==this._shadow&&(this._removeShadow(),g=!0),f&&(W(f,s),f.alt=""),this._shadow=f,n.opacity<1&&this._updateOpacity(),c&&this.getPane().appendChild(this._icon),this._initInteraction(),f&&g&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&vt(this._icon,"focus",this._panOnFocus,this),pt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&pt(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&Rt(this._icon,n),this._shadow&&Rt(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(s)},_initInteraction:function(){if(this.options.interactive&&(W(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Zu)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Zu(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&ce(this._icon,n),this._shadow&&ce(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var s=this.options.icon.options,u=s.iconSize?Q(s.iconSize):Q(0,0),c=s.iconAnchor?Q(s.iconAnchor):Q(0,0);n.panInside(this._latlng,{paddingTopLeft:c,paddingBottomRight:u.subtract(c)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ef(n,s){return new Ys(n,s)}var Ln=xe.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return H(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),to=Ln.extend({options:{fill:!0,radius:10},initialize:function(n,s){H(this,s),this._latlng=rt(n),this._radius=this.options.radius},setLatLng:function(n){var s=this._latlng;return this._latlng=rt(n),this.redraw(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var s=n&&n.radius||this._radius;return Ln.prototype.setStyle.call(this,n),this.setRadius(s),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,s=this._radiusY||n,u=this._clickTolerance(),c=[n+u,s+u];this._pxBounds=new wt(this._point.subtract(c),this._point.add(c))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function nf(n,s){return new to(n,s)}var pa=to.extend({initialize:function(n,s,u){if(typeof s=="number"&&(s=o({},u,{radius:s})),H(this,s),this._latlng=rt(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new Zt(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:Ln.prototype.setStyle,_project:function(){var n=this._latlng.lng,s=this._latlng.lat,u=this._map,c=u.options.crs;if(c.distance===ve.distance){var f=Math.PI/180,g=this._mRadius/ve.R/f,T=u.project([s+g,n]),O=u.project([s-g,n]),D=T.add(O).divideBy(2),V=u.unproject(D).lat,j=Math.acos((Math.cos(g*f)-Math.sin(s*f)*Math.sin(V*f))/(Math.cos(s*f)*Math.cos(V*f)))/f;(isNaN(j)||j===0)&&(j=g/Math.cos(Math.PI/180*s)),this._point=D.subtract(u.getPixelOrigin()),this._radius=isNaN(j)?0:D.x-u.project([V,n-j]).x,this._radiusY=D.y-T.y}else{var $=c.unproject(c.project(this._latlng).subtract([this._mRadius,0]));this._point=u.latLngToLayerPoint(this._latlng),this._radius=this._point.x-u.latLngToLayerPoint($).x}this._updateBounds()}});function rf(n,s,u){return new pa(n,s,u)}var dn=Ln.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,s){H(this,s),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var s=1/0,u=null,c=tt,f,g,T=0,O=this._parts.length;T<O;T++)for(var D=this._parts[T],V=1,j=D.length;V<j;V++){f=D[V-1],g=D[V];var $=c(n,f,g,!0);$<s&&(s=$,u=c(n,f,g))}return u&&(u.distance=Math.sqrt(s)),u},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ot(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,s){return s=s||this._defaultShape(),n=rt(n),s.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new Zt,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return mt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var s=[],u=mt(n),c=0,f=n.length;c<f;c++)u?(s[c]=rt(n[c]),this._bounds.extend(s[c])):s[c]=this._convertLatLngs(n[c]);return s},_project:function(){var n=new wt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),s=new J(n,n);this._rawPxBounds&&(this._pxBounds=new wt([this._rawPxBounds.min.subtract(s),this._rawPxBounds.max.add(s)]))},_projectLatlngs:function(n,s,u){var c=n[0]instanceof ft,f=n.length,g,T;if(c){for(T=[],g=0;g<f;g++)T[g]=this._map.latLngToLayerPoint(n[g]),u.extend(T[g]);s.push(T)}else for(g=0;g<f;g++)this._projectLatlngs(n[g],s,u)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var s=this._parts,u,c,f,g,T,O,D;for(u=0,f=0,g=this._rings.length;u<g;u++)for(D=this._rings[u],c=0,T=D.length;c<T-1;c++)O=y(D[c],D[c+1],n,c,!0),O&&(s[f]=s[f]||[],s[f].push(O[0]),(O[1]!==D[c+1]||c===T-2)&&(s[f].push(O[1]),f++))}},_simplifyPoints:function(){for(var n=this._parts,s=this.options.smoothFactor,u=0,c=n.length;u<c;u++)n[u]=Xt(n[u],s)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,s){var u,c,f,g,T,O,D=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(u=0,g=this._parts.length;u<g;u++)for(O=this._parts[u],c=0,T=O.length,f=T-1;c<T;f=c++)if(!(!s&&c===0)&&Gr(n,O[f],O[c])<=D)return!0;return!1}});function sf(n,s){return new dn(n,s)}dn._flat=gt;var er=dn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Zr(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var s=dn.prototype._convertLatLngs.call(this,n),u=s.length;return u>=2&&s[0]instanceof ft&&s[0].equals(s[u-1])&&s.pop(),s},_setLatLngs:function(n){dn.prototype._setLatLngs.call(this,n),mt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return mt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,s=this.options.weight,u=new J(s,s);if(n=new wt(n.min.subtract(u),n.max.add(u)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var c=0,f=this._rings.length,g;c<f;c++)g=qr(this._rings[c],n,!0),g.length&&this._parts.push(g)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var s=!1,u,c,f,g,T,O,D,V;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(g=0,D=this._parts.length;g<D;g++)for(u=this._parts[g],T=0,V=u.length,O=V-1;T<V;O=T++)c=u[T],f=u[O],c.y>n.y!=f.y>n.y&&n.x<(f.x-c.x)*(n.y-c.y)/(f.y-c.y)+c.x&&(s=!s);return s||dn.prototype._containsPoint.call(this,n,!0)}});function of(n,s){return new er(n,s)}var fn=ln.extend({initialize:function(n,s){H(this,s),this._layers={},n&&this.addData(n)},addData:function(n){var s=et(n)?n:n.features,u,c,f;if(s){for(u=0,c=s.length;u<c;u++)f=s[u],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}var g=this.options;if(g.filter&&!g.filter(n))return this;var T=eo(n,g);return T?(T.feature=ro(n),T.defaultOptions=T.options,this.resetStyle(T),g.onEachFeature&&g.onEachFeature(n,T),this.addLayer(T)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=o({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(s){this._setLayerStyle(s,n)},this)},_setLayerStyle:function(n,s){n.setStyle&&(typeof s=="function"&&(s=s(n.feature)),n.setStyle(s))}});function eo(n,s){var u=n.type==="Feature"?n.geometry:n,c=u?u.coordinates:null,f=[],g=s&&s.pointToLayer,T=s&&s.coordsToLatLng||ma,O,D,V,j;if(!c&&!u)return null;switch(u.type){case"Point":return O=T(c),Gu(g,n,O,s);case"MultiPoint":for(V=0,j=c.length;V<j;V++)O=T(c[V]),f.push(Gu(g,n,O,s));return new ln(f);case"LineString":case"MultiLineString":return D=no(c,u.type==="LineString"?0:1,T),new dn(D,s);case"Polygon":case"MultiPolygon":return D=no(c,u.type==="Polygon"?1:2,T),new er(D,s);case"GeometryCollection":for(V=0,j=u.geometries.length;V<j;V++){var $=eo({geometry:u.geometries[V],type:"Feature",properties:n.properties},s);$&&f.push($)}return new ln(f);case"FeatureCollection":for(V=0,j=u.features.length;V<j;V++){var ot=eo(u.features[V],s);ot&&f.push(ot)}return new ln(f);default:throw new Error("Invalid GeoJSON object.")}}function Gu(n,s,u,c){return n?n(s,u):new Ys(u,c&&c.markersInheritOptions&&c)}function ma(n){return new ft(n[1],n[0],n[2])}function no(n,s,u){for(var c=[],f=0,g=n.length,T;f<g;f++)T=s?no(n[f],s-1,u):(u||ma)(n[f]),c.push(T);return c}function _a(n,s){return n=rt(n),n.alt!==void 0?[R(n.lng,s),R(n.lat,s),R(n.alt,s)]:[R(n.lng,s),R(n.lat,s)]}function io(n,s,u,c){for(var f=[],g=0,T=n.length;g<T;g++)f.push(s?io(n[g],mt(n[g])?0:s-1,u,c):_a(n[g],c));return!s&&u&&f.length>0&&f.push(f[0].slice()),f}function nr(n,s){return n.feature?o({},n.feature,{geometry:s}):ro(s)}function ro(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var ga={toGeoJSON:function(n){return nr(this,{type:"Point",coordinates:_a(this.getLatLng(),n)})}};Ys.include(ga),pa.include(ga),to.include(ga),dn.include({toGeoJSON:function(n){var s=!mt(this._latlngs),u=io(this._latlngs,s?1:0,!1,n);return nr(this,{type:(s?"Multi":"")+"LineString",coordinates:u})}}),er.include({toGeoJSON:function(n){var s=!mt(this._latlngs),u=s&&!mt(this._latlngs[0]),c=io(this._latlngs,u?2:s?1:0,!0,n);return s||(c=[c]),nr(this,{type:(u?"Multi":"")+"Polygon",coordinates:c})}}),Yi.include({toMultiPoint:function(n){var s=[];return this.eachLayer(function(u){s.push(u.toGeoJSON(n).geometry.coordinates)}),nr(this,{type:"MultiPoint",coordinates:s})},toGeoJSON:function(n){var s=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(s==="MultiPoint")return this.toMultiPoint(n);var u=s==="GeometryCollection",c=[];return this.eachLayer(function(f){if(f.toGeoJSON){var g=f.toGeoJSON(n);if(u)c.push(g.geometry);else{var T=ro(g);T.type==="FeatureCollection"?c.push.apply(c,T.features):c.push(T)}}}),u?nr(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}});function Ku(n,s){return new fn(n,s)}var af=Ku,so=xe.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,s,u){this._url=n,this._bounds=It(s),H(this,u)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(W(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){pt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&Te(this._image),this},bringToBack:function(){return this._map&&Ee(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=It(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",s=this._image=n?this._url:ct("img");if(W(s,"leaflet-image-layer"),this._zoomAnimated&&W(s,"leaflet-zoom-animated"),this.options.className&&W(s,this.options.className),s.onselectstart=b,s.onmousemove=b,s.onload=l(this.fire,this,"load"),s.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=s.src;return}s.src=this._url,s.alt=this.options.alt},_animateZoom:function(n){var s=this._map.getZoomScale(n.zoom),u=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;an(this._image,u,s)},_reset:function(){var n=this._image,s=new wt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),u=s.getSize();Rt(n,s.min),n.style.width=u.x+"px",n.style.height=u.y+"px"},_updateOpacity:function(){ce(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),uf=function(n,s,u){return new so(n,s,u)},$u=so.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",s=this._image=n?this._url:ct("video");if(W(s,"leaflet-image-layer"),this._zoomAnimated&&W(s,"leaflet-zoom-animated"),this.options.className&&W(s,this.options.className),s.onselectstart=b,s.onmousemove=b,s.onloadeddata=l(this.fire,this,"load"),n){for(var u=s.getElementsByTagName("source"),c=[],f=0;f<u.length;f++)c.push(u[f].src);this._url=u.length>0?c:[s.src];return}et(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(s.style,"objectFit")&&(s.style.objectFit="fill"),s.autoplay=!!this.options.autoplay,s.loop=!!this.options.loop,s.muted=!!this.options.muted,s.playsInline=!!this.options.playsInline;for(var g=0;g<this._url.length;g++){var T=ct("source");T.src=this._url[g],s.appendChild(T)}}});function hf(n,s,u){return new $u(n,s,u)}var Ju=so.extend({_initImage:function(){var n=this._image=this._url;W(n,"leaflet-image-layer"),this._zoomAnimated&&W(n,"leaflet-zoom-animated"),this.options.className&&W(n,this.options.className),n.onselectstart=b,n.onmousemove=b}});function cf(n,s,u){return new Ju(n,s,u)}var qe=xe.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,s){n&&(n instanceof ft||et(n))?(this._latlng=rt(n),H(this,s)):(H(this,n),this._source=s),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&ce(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&ce(this._container,1),this.bringToFront(),this.options.interactive&&(W(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(ce(this._container,0),this._removeTimeout=setTimeout(l(pt,void 0,this._container),200)):pt(this._container),this.options.interactive&&(Tt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=rt(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Te(this._container),this},bringToBack:function(){return this._map&&Ee(this._container),this},_prepareOpen:function(n){var s=this._source;if(!s._map)return!1;if(s instanceof ln){s=null;var u=this._source._layers;for(var c in u)if(u[c]._map){s=u[c];break}if(!s)return!1;this._source=s}if(!n)if(s.getCenter)n=s.getCenter();else if(s.getLatLng)n=s.getLatLng();else if(s.getBounds)n=s.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,s=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof s=="string")n.innerHTML=s;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(s)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),s=Q(this.options.offset),u=this._getAnchor();this._zoomAnimated?Rt(this._container,n.add(u)):s=s.add(n).add(u);var c=this._containerBottom=-s.y,f=this._containerLeft=-Math.round(this._containerWidth/2)+s.x;this._container.style.bottom=c+"px",this._container.style.left=f+"px"}},_getAnchor:function(){return[0,0]}});st.include({_initOverlay:function(n,s,u,c){var f=s;return f instanceof n||(f=new n(c).setContent(s)),u&&f.setLatLng(u),f}}),xe.include({_initOverlay:function(n,s,u,c){var f=u;return f instanceof n?(H(f,c),f._source=this):(f=s&&!c?s:new n(c,this),f.setContent(u)),f}});var oo=qe.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,qe.prototype.openOn.call(this,n)},onAdd:function(n){qe.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ln||this._source.on("preclick",_t))},onRemove:function(n){qe.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ln||this._source.off("preclick",_t))},getEvents:function(){var n=qe.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",s=this._container=ct("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),u=this._wrapper=ct("div",n+"-content-wrapper",s);if(this._contentNode=ct("div",n+"-content",u),ci(s),Vr(this._contentNode),Y(s,"contextmenu",_t),this._tipContainer=ct("div",n+"-tip-container",s),this._tip=ct("div",n+"-tip",this._tipContainer),this.options.closeButton){var c=this._closeButton=ct("a",n+"-close-button",s);c.setAttribute("role","button"),c.setAttribute("aria-label","Close popup"),c.href="#close",c.innerHTML='<span aria-hidden="true">&#215;</span>',Y(c,"click",function(f){Nt(f),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,s=n.style;s.width="",s.whiteSpace="nowrap";var u=n.offsetWidth;u=Math.min(u,this.options.maxWidth),u=Math.max(u,this.options.minWidth),s.width=u+1+"px",s.whiteSpace="",s.height="";var c=n.offsetHeight,f=this.options.maxHeight,g="leaflet-popup-scrolled";f&&c>f?(s.height=f+"px",W(n,g)):Tt(n,g),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),u=this._getAnchor();Rt(this._container,s.add(u))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,s=parseInt(Cn(this._container,"marginBottom"),10)||0,u=this._container.offsetHeight+s,c=this._containerWidth,f=new J(this._containerLeft,-u-this._containerBottom);f._add(un(this._container));var g=n.layerPointToContainerPoint(f),T=Q(this.options.autoPanPadding),O=Q(this.options.autoPanPaddingTopLeft||T),D=Q(this.options.autoPanPaddingBottomRight||T),V=n.getSize(),j=0,$=0;g.x+c+D.x>V.x&&(j=g.x+c-V.x+D.x),g.x-j-O.x<0&&(j=g.x-O.x),g.y+u+D.y>V.y&&($=g.y+u-V.y+D.y),g.y-$-O.y<0&&($=g.y-O.y),(j||$)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([j,$]))}},_getAnchor:function(){return Q(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),lf=function(n,s){return new oo(n,s)};st.mergeOptions({closePopupOnClick:!0}),st.include({openPopup:function(n,s,u){return this._initOverlay(oo,n,s,u).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),xe.include({bindPopup:function(n,s){return this._popup=this._initOverlay(oo,this._popup,n,s),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof ln||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Fe(n);var s=n.layer||n.target;if(this._popup._source===s&&!(s instanceof Ln)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=s,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var ao=qe.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){qe.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){qe.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=qe.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",s=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ct("div",s),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+_(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var s,u,c=this._map,f=this._container,g=c.latLngToContainerPoint(c.getCenter()),T=c.layerPointToContainerPoint(n),O=this.options.direction,D=f.offsetWidth,V=f.offsetHeight,j=Q(this.options.offset),$=this._getAnchor();O==="top"?(s=D/2,u=V):O==="bottom"?(s=D/2,u=0):O==="center"?(s=D/2,u=V/2):O==="right"?(s=0,u=V/2):O==="left"?(s=D,u=V/2):T.x<g.x?(O="right",s=0,u=V/2):(O="left",s=D+(j.x+$.x)*2,u=V/2),n=n.subtract(Q(s,u,!0)).add(j).add($),Tt(f,"leaflet-tooltip-right"),Tt(f,"leaflet-tooltip-left"),Tt(f,"leaflet-tooltip-top"),Tt(f,"leaflet-tooltip-bottom"),W(f,"leaflet-tooltip-"+O),Rt(f,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&ce(this._container,n)},_animateZoom:function(n){var s=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(s)},_getAnchor:function(){return Q(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),df=function(n,s){return new ao(n,s)};st.include({openTooltip:function(n,s,u){return this._initOverlay(ao,n,s,u).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),xe.include({bindTooltip:function(n,s){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ao,this._tooltip,n,s),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var s=n?"off":"on",u={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?u.add=this._openTooltip:(u.mouseover=this._openTooltip,u.mouseout=this.closeTooltip,u.click=this._openTooltip,this._map?this._addFocusListeners():u.add=this._addFocusListeners),this._tooltip.options.sticky&&(u.mousemove=this._moveTooltip),this[s](u),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof ln||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&(Y(s,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),Y(s,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var s=typeof n.getElement=="function"&&n.getElement();s&&s.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var s=this;this._map.once("moveend",function(){s._openOnceFlag=!1,s._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var s=n.latlng,u,c;this._tooltip.options.sticky&&n.originalEvent&&(u=this._map.mouseEventToContainerPoint(n.originalEvent),c=this._map.containerPointToLayerPoint(u),s=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(s)}});var Xu=tr.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var s=n&&n.tagName==="DIV"?n:document.createElement("div"),u=this.options;if(u.html instanceof Element?(re(s),s.appendChild(u.html)):s.innerHTML=u.html!==!1?u.html:"",u.bgPos){var c=Q(u.bgPos);s.style.backgroundPosition=-c.x+"px "+-c.y+"px"}return this._setIconStyles(s,"icon"),s},createShadow:function(){return null}});function ff(n){return new Xu(n)}tr.Default=Kr;var $r=xe.extend({options:{tileSize:256,opacity:1,updateWhenIdle:q.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){H(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),pt(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Te(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ee(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof J?n:new J(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var s=this.getPane().children,u=-n(-1/0,1/0),c=0,f=s.length,g;c<f;c++)g=s[c].style.zIndex,s[c]!==this._container&&g&&(u=n(u,+g));isFinite(u)&&(this.options.zIndex=u+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!q.ielt9){ce(this._container,this.options.opacity);var n=+new Date,s=!1,u=!1;for(var c in this._tiles){var f=this._tiles[c];if(!(!f.current||!f.loaded)){var g=Math.min(1,(n-f.loaded)/200);ce(f.el,g),g<1?s=!0:(f.active?u=!0:this._onOpaqueTile(f),f.active=!0)}}u&&!this._noPrune&&this._pruneTiles(),s&&(k(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:b,_initContainer:function(){this._container||(this._container=ct("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,s=this.options.maxZoom;if(n!==void 0){for(var u in this._levels)u=Number(u),this._levels[u].el.children.length||u===n?(this._levels[u].el.style.zIndex=s-Math.abs(n-u),this._onUpdateLevel(u)):(pt(this._levels[u].el),this._removeTilesAtZoom(u),this._onRemoveLevel(u),delete this._levels[u]);var c=this._levels[n],f=this._map;return c||(c=this._levels[n]={},c.el=ct("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=s,c.origin=f.project(f.unproject(f.getPixelOrigin()),n).round(),c.zoom=n,this._setZoomTransform(c,f.getCenter(),f.getZoom()),b(c.el.offsetWidth),this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:b,_onRemoveLevel:b,_onCreateLevel:b,_pruneTiles:function(){if(this._map){var n,s,u=this._map.getZoom();if(u>this.options.maxZoom||u<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)s=this._tiles[n],s.retain=s.current;for(n in this._tiles)if(s=this._tiles[n],s.current&&!s.active){var c=s.coords;this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var s in this._tiles)this._tiles[s].coords.z===n&&this._removeTile(s)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)pt(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,s,u,c){var f=Math.floor(n/2),g=Math.floor(s/2),T=u-1,O=new J(+f,+g);O.z=+T;var D=this._tileCoordsToKey(O),V=this._tiles[D];return V&&V.active?(V.retain=!0,!0):(V&&V.loaded&&(V.retain=!0),T>c?this._retainParent(f,g,T,c):!1)},_retainChildren:function(n,s,u,c){for(var f=2*n;f<2*n+2;f++)for(var g=2*s;g<2*s+2;g++){var T=new J(f,g);T.z=u+1;var O=this._tileCoordsToKey(T),D=this._tiles[O];if(D&&D.active){D.retain=!0;continue}else D&&D.loaded&&(D.retain=!0);u+1<c&&this._retainChildren(f,g,u+1,c)}},_resetView:function(n){var s=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),s,s)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var s=this.options;return s.minNativeZoom!==void 0&&n<s.minNativeZoom?s.minNativeZoom:s.maxNativeZoom!==void 0&&s.maxNativeZoom<n?s.maxNativeZoom:n},_setView:function(n,s,u,c){var f=Math.round(s);this.options.maxZoom!==void 0&&f>this.options.maxZoom||this.options.minZoom!==void 0&&f<this.options.minZoom?f=void 0:f=this._clampZoom(f);var g=this.options.updateWhenZooming&&f!==this._tileZoom;(!c||g)&&(this._tileZoom=f,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),f!==void 0&&this._update(n),u||this._pruneTiles(),this._noPrune=!!u),this._setZoomTransforms(n,s)},_setZoomTransforms:function(n,s){for(var u in this._levels)this._setZoomTransform(this._levels[u],n,s)},_setZoomTransform:function(n,s,u){var c=this._map.getZoomScale(u,n.zoom),f=n.origin.multiplyBy(c).subtract(this._map._getNewPixelOrigin(s,u)).round();q.any3d?an(n.el,f,c):Rt(n.el,f)},_resetGrid:function(){var n=this._map,s=n.options.crs,u=this._tileSize=this.getTileSize(),c=this._tileZoom,f=this._map.getPixelWorldBounds(this._tileZoom);f&&(this._globalTileRange=this._pxBoundsToTileRange(f)),this._wrapX=s.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,s.wrapLng[0]],c).x/u.x),Math.ceil(n.project([0,s.wrapLng[1]],c).x/u.y)],this._wrapY=s.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([s.wrapLat[0],0],c).y/u.x),Math.ceil(n.project([s.wrapLat[1],0],c).y/u.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var s=this._map,u=s._animatingZoom?Math.max(s._animateToZoom,s.getZoom()):s.getZoom(),c=s.getZoomScale(u,this._tileZoom),f=s.project(n,this._tileZoom).floor(),g=s.getSize().divideBy(c*2);return new wt(f.subtract(g),f.add(g))},_update:function(n){var s=this._map;if(s){var u=this._clampZoom(s.getZoom());if(n===void 0&&(n=s.getCenter()),this._tileZoom!==void 0){var c=this._getTiledPixelBounds(n),f=this._pxBoundsToTileRange(c),g=f.getCenter(),T=[],O=this.options.keepBuffer,D=new wt(f.getBottomLeft().subtract([O,-O]),f.getTopRight().add([O,-O]));if(!(isFinite(f.min.x)&&isFinite(f.min.y)&&isFinite(f.max.x)&&isFinite(f.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var V in this._tiles){var j=this._tiles[V].coords;(j.z!==this._tileZoom||!D.contains(new J(j.x,j.y)))&&(this._tiles[V].current=!1)}if(Math.abs(u-this._tileZoom)>1){this._setView(n,u);return}for(var $=f.min.y;$<=f.max.y;$++)for(var ot=f.min.x;ot<=f.max.x;ot++){var oe=new J(ot,$);if(oe.z=this._tileZoom,!!this._isValidTile(oe)){var Ht=this._tiles[this._tileCoordsToKey(oe)];Ht?Ht.current=!0:T.push(oe)}}if(T.sort(function(de,rr){return de.distanceTo(g)-rr.distanceTo(g)}),T.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var be=document.createDocumentFragment();for(ot=0;ot<T.length;ot++)this._addTile(T[ot],be);this._level.el.appendChild(be)}}}},_isValidTile:function(n){var s=this._map.options.crs;if(!s.infinite){var u=this._globalTileRange;if(!s.wrapLng&&(n.x<u.min.x||n.x>u.max.x)||!s.wrapLat&&(n.y<u.min.y||n.y>u.max.y))return!1}if(!this.options.bounds)return!0;var c=this._tileCoordsToBounds(n);return It(this.options.bounds).overlaps(c)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var s=this._map,u=this.getTileSize(),c=n.scaleBy(u),f=c.add(u),g=s.unproject(c,n.z),T=s.unproject(f,n.z);return[g,T]},_tileCoordsToBounds:function(n){var s=this._tileCoordsToNwSe(n),u=new Zt(s[0],s[1]);return this.options.noWrap||(u=this._map.wrapLatLngBounds(u)),u},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var s=n.split(":"),u=new J(+s[0],+s[1]);return u.z=+s[2],u},_removeTile:function(n){var s=this._tiles[n];s&&(pt(s.el),delete this._tiles[n],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){W(n,"leaflet-tile");var s=this.getTileSize();n.style.width=s.x+"px",n.style.height=s.y+"px",n.onselectstart=b,n.onmousemove=b,q.ielt9&&this.options.opacity<1&&ce(n,this.options.opacity)},_addTile:function(n,s){var u=this._getTilePos(n),c=this._tileCoordsToKey(n),f=this.createTile(this._wrapCoords(n),l(this._tileReady,this,n));this._initTile(f),this.createTile.length<2&&P(l(this._tileReady,this,n,null,f)),Rt(f,u),this._tiles[c]={el:f,coords:n,current:!0},s.appendChild(f),this.fire("tileloadstart",{tile:f,coords:n})},_tileReady:function(n,s,u){s&&this.fire("tileerror",{error:s,tile:u,coords:n});var c=this._tileCoordsToKey(n);u=this._tiles[c],u&&(u.loaded=+new Date,this._map._fadeAnimated?(ce(u.el,0),k(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(u.active=!0,this._pruneTiles()),s||(W(u.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:u.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),q.ielt9||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var s=new J(this._wrapX?A(n.x,this._wrapX):n.x,this._wrapY?A(n.y,this._wrapY):n.y);return s.z=n.z,s},_pxBoundsToTileRange:function(n){var s=this.getTileSize();return new wt(n.min.unscaleBy(s).floor(),n.max.unscaleBy(s).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function pf(n){return new $r(n)}var ir=$r.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,s){this._url=n,s=H(this,s),s.detectRetina&&q.retina&&s.maxZoom>0?(s.tileSize=Math.floor(s.tileSize/2),s.zoomReverse?(s.zoomOffset--,s.minZoom=Math.min(s.maxZoom,s.minZoom+1)):(s.zoomOffset++,s.maxZoom=Math.max(s.minZoom,s.maxZoom-1)),s.minZoom=Math.max(0,s.minZoom)):s.zoomReverse?s.minZoom=Math.min(s.maxZoom,s.minZoom):s.maxZoom=Math.max(s.minZoom,s.maxZoom),typeof s.subdomains=="string"&&(s.subdomains=s.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,s){return this._url===n&&s===void 0&&(s=!0),this._url=n,s||this.redraw(),this},createTile:function(n,s){var u=document.createElement("img");return Y(u,"load",l(this._tileOnLoad,this,s,u)),Y(u,"error",l(this._tileOnError,this,s,u)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(u.referrerPolicy=this.options.referrerPolicy),u.alt="",u.src=this.getTileUrl(n),u},getTileUrl:function(n){var s={r:q.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var u=this._globalTileRange.max.y-n.y;this.options.tms&&(s.y=u),s["-y"]=u}return ut(this._url,o(s,this.options))},_tileOnLoad:function(n,s){q.ielt9?setTimeout(l(n,this,null,s),0):n(null,s)},_tileOnError:function(n,s,u){var c=this.options.errorTileUrl;c&&s.getAttribute("src")!==c&&(s.src=c),n(u,s)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,s=this.options.maxZoom,u=this.options.zoomReverse,c=this.options.zoomOffset;return u&&(n=s-n),n+c},_getSubdomain:function(n){var s=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[s]},_abortLoading:function(){var n,s;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(s=this._tiles[n].el,s.onload=b,s.onerror=b,!s.complete)){s.src=Bt;var u=this._tiles[n].coords;pt(s),delete this._tiles[n],this.fire("tileabort",{tile:s,coords:u})}},_removeTile:function(n){var s=this._tiles[n];if(s)return s.el.setAttribute("src",Bt),$r.prototype._removeTile.call(this,n)},_tileReady:function(n,s,u){if(!(!this._map||u&&u.getAttribute("src")===Bt))return $r.prototype._tileReady.call(this,n,s,u)}});function Qu(n,s){return new ir(n,s)}var Yu=ir.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,s){this._url=n;var u=o({},this.defaultWmsParams);for(var c in s)c in this.options||(u[c]=s[c]);s=H(this,s);var f=s.detectRetina&&q.retina?2:1,g=this.getTileSize();u.width=g.x*f,u.height=g.y*f,this.wmsParams=u},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=this._crs.code,ir.prototype.onAdd.call(this,n)},getTileUrl:function(n){var s=this._tileCoordsToNwSe(n),u=this._crs,c=qt(u.project(s[0]),u.project(s[1])),f=c.min,g=c.max,T=(this._wmsVersion>=1.3&&this._crs===Qi?[f.y,f.x,g.y,g.x]:[f.x,f.y,g.x,g.y]).join(","),O=ir.prototype.getTileUrl.call(this,n);return O+G(this.wmsParams,O,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+T},setParams:function(n,s){return o(this.wmsParams,n),s||this.redraw(),this}});function mf(n,s){return new Yu(n,s)}ir.WMS=Yu,Qu.wms=mf;var pn=xe.extend({options:{padding:.1},initialize:function(n){H(this,n),_(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),W(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,s){var u=this._map.getZoomScale(s,this._zoom),c=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,s),g=c.multiplyBy(-u).add(f).subtract(this._map._getNewPixelOrigin(n,s));q.any3d?an(this._container,g,u):Rt(this._container,g)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,s=this._map.getSize(),u=this._map.containerPointToLayerPoint(s.multiplyBy(-n)).round();this._bounds=new wt(u,u.add(s.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),th=pn.extend({options:{tolerance:0},getEvents:function(){var n=pn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){pn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");Y(n,"mousemove",this._onMouseMove,this),Y(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Y(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){k(this._redrawRequest),delete this._ctx,pt(this._container),vt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var s in this._layers)n=this._layers[s],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){pn.prototype._update.call(this);var n=this._bounds,s=this._container,u=n.getSize(),c=q.retina?2:1;Rt(s,n.min),s.width=c*u.x,s.height=c*u.y,s.style.width=u.x+"px",s.style.height=u.y+"px",q.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){pn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[_(n)]=n;var s=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=s),this._drawLast=s,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var s=n._order,u=s.next,c=s.prev;u?u.prev=c:this._drawLast=c,c?c.next=u:this._drawFirst=u,delete n._order,delete this._layers[_(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var s=n.options.dashArray.split(/[, ]+/),u=[],c,f;for(f=0;f<s.length;f++){if(c=Number(s[f]),isNaN(c))return;u.push(c)}n.options._dashArray=u}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var s=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new wt,this._redrawBounds.extend(n._pxBounds.min.subtract([s,s])),this._redrawBounds.extend(n._pxBounds.max.add([s,s]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var s=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,s.x,s.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,s=this._redrawBounds;if(this._ctx.save(),s){var u=s.getSize();this._ctx.beginPath(),this._ctx.rect(s.min.x,s.min.y,u.x,u.y),this._ctx.clip()}this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)n=c.layer,(!s||n._pxBounds&&n._pxBounds.intersects(s))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,s){if(this._drawing){var u,c,f,g,T=n._parts,O=T.length,D=this._ctx;if(O){for(D.beginPath(),u=0;u<O;u++){for(c=0,f=T[u].length;c<f;c++)g=T[u][c],D[c?"lineTo":"moveTo"](g.x,g.y);s&&D.closePath()}this._fillStroke(D,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var s=n._point,u=this._ctx,c=Math.max(Math.round(n._radius),1),f=(Math.max(Math.round(n._radiusY),1)||c)/c;f!==1&&(u.save(),u.scale(1,f)),u.beginPath(),u.arc(s.x,s.y/f,c,0,Math.PI*2,!1),f!==1&&u.restore(),this._fillStroke(u,n)}},_fillStroke:function(n,s){var u=s.options;u.fill&&(n.globalAlpha=u.fillOpacity,n.fillStyle=u.fillColor||u.color,n.fill(u.fillRule||"evenodd")),u.stroke&&u.weight!==0&&(n.setLineDash&&n.setLineDash(s.options&&s.options._dashArray||[]),n.globalAlpha=u.opacity,n.lineWidth=u.weight,n.strokeStyle=u.color,n.lineCap=u.lineCap,n.lineJoin=u.lineJoin,n.stroke())},_onClick:function(n){for(var s=this._map.mouseEventToLayerPoint(n),u,c,f=this._drawFirst;f;f=f.next)u=f.layer,u.options.interactive&&u._containsPoint(s)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(u))&&(c=u);this._fireEvent(c?[c]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var s=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,s)}},_handleMouseOut:function(n){var s=this._hoveredLayer;s&&(Tt(this._container,"leaflet-interactive"),this._fireEvent([s],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,s){if(!this._mouseHoverThrottled){for(var u,c,f=this._drawFirst;f;f=f.next)u=f.layer,u.options.interactive&&u._containsPoint(s)&&(c=u);c!==this._hoveredLayer&&(this._handleMouseOut(n),c&&(W(this._container,"leaflet-interactive"),this._fireEvent([c],n,"mouseover"),this._hoveredLayer=c)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,s,u){this._map._fireDOMEvent(s,u||s.type,n)},_bringToFront:function(n){var s=n._order;if(s){var u=s.next,c=s.prev;if(u)u.prev=c;else return;c?c.next=u:u&&(this._drawFirst=u),s.prev=this._drawLast,this._drawLast.next=s,s.next=null,this._drawLast=s,this._requestRedraw(n)}},_bringToBack:function(n){var s=n._order;if(s){var u=s.next,c=s.prev;if(c)c.next=u;else return;u?u.prev=c:c&&(this._drawLast=c),s.prev=null,s.next=this._drawFirst,this._drawFirst.prev=s,this._drawFirst=s,this._requestRedraw(n)}}});function eh(n){return q.canvas?new th(n):null}var Jr=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),_f={_initContainer:function(){this._container=ct("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(pn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var s=n._container=Jr("shape");W(s,"leaflet-vml-shape "+(this.options.className||"")),s.coordsize="1 1",n._path=Jr("path"),s.appendChild(n._path),this._updateStyle(n),this._layers[_(n)]=n},_addPath:function(n){var s=n._container;this._container.appendChild(s),n.options.interactive&&n.addInteractiveTarget(s)},_removePath:function(n){var s=n._container;pt(s),n.removeInteractiveTarget(s),delete this._layers[_(n)]},_updateStyle:function(n){var s=n._stroke,u=n._fill,c=n.options,f=n._container;f.stroked=!!c.stroke,f.filled=!!c.fill,c.stroke?(s||(s=n._stroke=Jr("stroke")),f.appendChild(s),s.weight=c.weight+"px",s.color=c.color,s.opacity=c.opacity,c.dashArray?s.dashStyle=et(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):s.dashStyle="",s.endcap=c.lineCap.replace("butt","flat"),s.joinstyle=c.lineJoin):s&&(f.removeChild(s),n._stroke=null),c.fill?(u||(u=n._fill=Jr("fill")),f.appendChild(u),u.color=c.fillColor||c.color,u.opacity=c.fillOpacity):u&&(f.removeChild(u),n._fill=null)},_updateCircle:function(n){var s=n._point.round(),u=Math.round(n._radius),c=Math.round(n._radiusY||u);this._setPath(n,n._empty()?"M0 0":"AL "+s.x+","+s.y+" "+u+","+c+" 0,"+65535*360)},_setPath:function(n,s){n._path.v=s},_bringToFront:function(n){Te(n._container)},_bringToBack:function(n){Ee(n._container)}},uo=q.vml?Jr:xs,Xr=pn.extend({_initContainer:function(){this._container=uo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=uo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){pt(this._container),vt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){pn.prototype._update.call(this);var n=this._bounds,s=n.getSize(),u=this._container;(!this._svgSize||!this._svgSize.equals(s))&&(this._svgSize=s,u.setAttribute("width",s.x),u.setAttribute("height",s.y)),Rt(u,n.min),u.setAttribute("viewBox",[n.min.x,n.min.y,s.x,s.y].join(" ")),this.fire("update")}},_initPath:function(n){var s=n._path=uo("path");n.options.className&&W(s,n.options.className),n.options.interactive&&W(s,"leaflet-interactive"),this._updateStyle(n),this._layers[_(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){pt(n._path),n.removeInteractiveTarget(n._path),delete this._layers[_(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var s=n._path,u=n.options;s&&(u.stroke?(s.setAttribute("stroke",u.color),s.setAttribute("stroke-opacity",u.opacity),s.setAttribute("stroke-width",u.weight),s.setAttribute("stroke-linecap",u.lineCap),s.setAttribute("stroke-linejoin",u.lineJoin),u.dashArray?s.setAttribute("stroke-dasharray",u.dashArray):s.removeAttribute("stroke-dasharray"),u.dashOffset?s.setAttribute("stroke-dashoffset",u.dashOffset):s.removeAttribute("stroke-dashoffset")):s.setAttribute("stroke","none"),u.fill?(s.setAttribute("fill",u.fillColor||u.color),s.setAttribute("fill-opacity",u.fillOpacity),s.setAttribute("fill-rule",u.fillRule||"evenodd")):s.setAttribute("fill","none"))},_updatePoly:function(n,s){this._setPath(n,xi(n._parts,s))},_updateCircle:function(n){var s=n._point,u=Math.max(Math.round(n._radius),1),c=Math.max(Math.round(n._radiusY),1)||u,f="a"+u+","+c+" 0 1,0 ",g=n._empty()?"M0 0":"M"+(s.x-u)+","+s.y+f+u*2+",0 "+f+-u*2+",0 ";this._setPath(n,g)},_setPath:function(n,s){n._path.setAttribute("d",s)},_bringToFront:function(n){Te(n._path)},_bringToBack:function(n){Ee(n._path)}});q.vml&&Xr.include(_f);function nh(n){return q.svg||q.vml?new Xr(n):null}st.include({getRenderer:function(n){var s=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return s||(s=this._renderer=this._createRenderer()),this.hasLayer(s)||this.addLayer(s),s},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var s=this._paneRenderers[n];return s===void 0&&(s=this._createRenderer({pane:n}),this._paneRenderers[n]=s),s},_createRenderer:function(n){return this.options.preferCanvas&&eh(n)||nh(n)}});var ih=er.extend({initialize:function(n,s){er.prototype.initialize.call(this,this._boundsToLatLngs(n),s)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=It(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function gf(n,s){return new ih(n,s)}Xr.create=uo,Xr.pointsToPath=xi,fn.geometryToLayer=eo,fn.coordsToLatLng=ma,fn.coordsToLatLngs=no,fn.latLngToCoords=_a,fn.latLngsToCoords=io,fn.getFeature=nr,fn.asFeature=ro,st.mergeOptions({boxZoom:!0});var rh=ge.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){Y(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){vt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){pt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ce(),Hi(),this._startPoint=this._map.mouseEventToContainerPoint(n),Y(document,{contextmenu:Fe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=ct("div","leaflet-zoom-box",this._container),W(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var s=new wt(this._point,this._startPoint),u=s.getSize();Rt(this._box,s.min),this._box.style.width=u.x+"px",this._box.style.height=u.y+"px"},_finish:function(){this._moved&&(pt(this._box),Tt(this._container,"leaflet-crosshair")),_e(),ji(),vt(document,{contextmenu:Fe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var s=new Zt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(s).fire("boxzoomend",{boxZoomBounds:s})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});st.addInitHook("addHandler","boxZoom",rh),st.mergeOptions({doubleClickZoom:!0});var sh=ge.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var s=this._map,u=s.getZoom(),c=s.options.zoomDelta,f=n.originalEvent.shiftKey?u-c:u+c;s.options.doubleClickZoom==="center"?s.setZoom(f):s.setZoomAround(n.containerPoint,f)}});st.addInitHook("addHandler","doubleClickZoom",sh),st.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var oh=ge.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Re(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}W(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Tt(this._map._container,"leaflet-grab"),Tt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var s=It(this._map.options.maxBounds);this._offsetLimit=qt(this._map.latLngToContainerPoint(s.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(s.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var s=this._lastTime=+new Date,u=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(u),this._times.push(s),this._prunePositions(s)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),s=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=s.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,s){return n-(n-s)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),s=this._offsetLimit;n.x<s.min.x&&(n.x=this._viscousLimit(n.x,s.min.x)),n.y<s.min.y&&(n.y=this._viscousLimit(n.y,s.min.y)),n.x>s.max.x&&(n.x=this._viscousLimit(n.x,s.max.x)),n.y>s.max.y&&(n.y=this._viscousLimit(n.y,s.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,s=Math.round(n/2),u=this._initialWorldOffset,c=this._draggable._newPos.x,f=(c-s+u)%n+s-u,g=(c+s+u)%n-s-u,T=Math.abs(f+u)<Math.abs(g+u)?f:g;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=T},_onDragEnd:function(n){var s=this._map,u=s.options,c=!u.inertia||n.noInertia||this._times.length<2;if(s.fire("dragend",n),c)s.fire("moveend");else{this._prunePositions(+new Date);var f=this._lastPos.subtract(this._positions[0]),g=(this._lastTime-this._times[0])/1e3,T=u.easeLinearity,O=f.multiplyBy(T/g),D=O.distanceTo([0,0]),V=Math.min(u.inertiaMaxSpeed,D),j=O.multiplyBy(V/D),$=V/(u.inertiaDeceleration*T),ot=j.multiplyBy(-$/2).round();!ot.x&&!ot.y?s.fire("moveend"):(ot=s._limitOffset(ot,s.options.maxBounds),P(function(){s.panBy(ot,{duration:$,easeLinearity:T,noMoveStart:!0,animate:!0})}))}}});st.addInitHook("addHandler","dragging",oh),st.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ah=ge.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),Y(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),vt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,s=document.documentElement,u=n.scrollTop||s.scrollTop,c=n.scrollLeft||s.scrollLeft;this._map._container.focus(),window.scrollTo(c,u)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var s=this._panKeys={},u=this.keyCodes,c,f;for(c=0,f=u.left.length;c<f;c++)s[u.left[c]]=[-1*n,0];for(c=0,f=u.right.length;c<f;c++)s[u.right[c]]=[n,0];for(c=0,f=u.down.length;c<f;c++)s[u.down[c]]=[0,n];for(c=0,f=u.up.length;c<f;c++)s[u.up[c]]=[0,-1*n]},_setZoomDelta:function(n){var s=this._zoomKeys={},u=this.keyCodes,c,f;for(c=0,f=u.zoomIn.length;c<f;c++)s[u.zoomIn[c]]=n;for(c=0,f=u.zoomOut.length;c<f;c++)s[u.zoomOut[c]]=-n},_addHooks:function(){Y(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){vt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var s=n.keyCode,u=this._map,c;if(s in this._panKeys){if(!u._panAnim||!u._panAnim._inProgress)if(c=this._panKeys[s],n.shiftKey&&(c=Q(c).multiplyBy(3)),u.options.maxBounds&&(c=u._limitOffset(Q(c),u.options.maxBounds)),u.options.worldCopyJump){var f=u.wrapLatLng(u.unproject(u.project(u.getCenter()).add(c)));u.panTo(f)}else u.panBy(c)}else if(s in this._zoomKeys)u.setZoom(u.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[s]);else if(s===27&&u._popup&&u._popup.options.closeOnEscapeKey)u.closePopup();else return;Fe(n)}}});st.addInitHook("addHandler","keyboard",ah),st.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var uh=ge.extend({addHooks:function(){Y(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){vt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var s=Ur(n),u=this._map.options.wheelDebounceTime;this._delta+=s,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var c=Math.max(u-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),c),Fe(n)},_performZoom:function(){var n=this._map,s=n.getZoom(),u=this._map.options.zoomSnap||0;n._stop();var c=this._delta/(this._map.options.wheelPxPerZoomLevel*4),f=4*Math.log(2/(1+Math.exp(-Math.abs(c))))/Math.LN2,g=u?Math.ceil(f/u)*u:f,T=n._limitZoom(s+(this._delta>0?g:-g))-s;this._delta=0,this._startTime=null,T&&(n.options.scrollWheelZoom==="center"?n.setZoom(s+T):n.setZoomAround(this._lastMousePos,s+T))}});st.addInitHook("addHandler","scrollWheelZoom",uh);var yf=600;st.mergeOptions({tapHold:q.touchNative&&q.safari&&q.mobile,tapTolerance:15});var hh=ge.extend({addHooks:function(){Y(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){vt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var s=n.touches[0];this._startPos=this._newPos=new J(s.clientX,s.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Y(document,"touchend",Nt),Y(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",s))},this),yf),Y(document,"touchend touchcancel contextmenu",this._cancel,this),Y(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){vt(document,"touchend",Nt),vt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),vt(document,"touchend touchcancel contextmenu",this._cancel,this),vt(document,"touchmove",this._onMove,this)},_onMove:function(n){var s=n.touches[0];this._newPos=new J(s.clientX,s.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,s){var u=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});u._simulated=!0,s.target.dispatchEvent(u)}});st.addInitHook("addHandler","tapHold",hh),st.mergeOptions({touchZoom:q.touch,bounceAtZoomLimits:!0});var ch=ge.extend({addHooks:function(){W(this._map._container,"leaflet-touch-zoom"),Y(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Tt(this._map._container,"leaflet-touch-zoom"),vt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var s=this._map;if(!(!n.touches||n.touches.length!==2||s._animatingZoom||this._zooming)){var u=s.mouseEventToContainerPoint(n.touches[0]),c=s.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=s.getSize()._divideBy(2),this._startLatLng=s.containerPointToLatLng(this._centerPoint),s.options.touchZoom!=="center"&&(this._pinchStartLatLng=s.containerPointToLatLng(u.add(c)._divideBy(2))),this._startDist=u.distanceTo(c),this._startZoom=s.getZoom(),this._moved=!1,this._zooming=!0,s._stop(),Y(document,"touchmove",this._onTouchMove,this),Y(document,"touchend touchcancel",this._onTouchEnd,this),Nt(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var s=this._map,u=s.mouseEventToContainerPoint(n.touches[0]),c=s.mouseEventToContainerPoint(n.touches[1]),f=u.distanceTo(c)/this._startDist;if(this._zoom=s.getScaleZoom(f,this._startZoom),!s.options.bounceAtZoomLimits&&(this._zoom<s.getMinZoom()&&f<1||this._zoom>s.getMaxZoom()&&f>1)&&(this._zoom=s._limitZoom(this._zoom)),s.options.touchZoom==="center"){if(this._center=this._startLatLng,f===1)return}else{var g=u._add(c)._divideBy(2)._subtract(this._centerPoint);if(f===1&&g.x===0&&g.y===0)return;this._center=s.unproject(s.project(this._pinchStartLatLng,this._zoom).subtract(g),this._zoom)}this._moved||(s._moveStart(!0,!1),this._moved=!0),k(this._animRequest);var T=l(s._move,s,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=P(T,this,!0),Nt(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,k(this._animRequest),vt(document,"touchmove",this._onTouchMove,this),vt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});st.addInitHook("addHandler","touchZoom",ch),st.BoxZoom=rh,st.DoubleClickZoom=sh,st.Drag=oh,st.Keyboard=ah,st.ScrollWheelZoom=uh,st.TapHold=hh,st.TouchZoom=ch,e.Bounds=wt,e.Browser=q,e.CRS=me,e.Canvas=th,e.Circle=pa,e.CircleMarker=to,e.Class=At,e.Control=le,e.DivIcon=Xu,e.DivOverlay=qe,e.DomEvent=di,e.DomUtil=fa,e.Draggable=Re,e.Evented=$n,e.FeatureGroup=ln,e.GeoJSON=fn,e.GridLayer=$r,e.Handler=ge,e.Icon=tr,e.ImageOverlay=so,e.LatLng=ft,e.LatLngBounds=Zt,e.Layer=xe,e.LayerGroup=Yi,e.LineUtil=Ae,e.Map=st,e.Marker=Ys,e.Mixin=Xs,e.Path=Ln,e.Point=J,e.PolyUtil=Ji,e.Polygon=er,e.Polyline=dn,e.Popup=oo,e.PosAnimation=zr,e.Projection=We,e.Rectangle=ih,e.Renderer=pn,e.SVG=Xr,e.SVGOverlay=Ju,e.TileLayer=ir,e.Tooltip=ao,e.Transformation=Pr,e.Util=E,e.VideoOverlay=$u,e.bind=l,e.bounds=qt,e.canvas=eh,e.circle=rf,e.circleMarker=nf,e.control=He,e.divIcon=ff,e.extend=o,e.featureGroup=Yd,e.geoJSON=Ku,e.geoJson=af,e.gridLayer=pf,e.icon=tf,e.imageOverlay=uf,e.latLng=rt,e.latLngBounds=It,e.layerGroup=Qd,e.map=Zi,e.marker=ef,e.point=Q,e.polygon=of,e.polyline=sf,e.popup=lf,e.rectangle=gf,e.setOptions=H,e.stamp=_,e.svg=nh,e.svgOverlay=cf,e.tileLayer=Qu,e.tooltip=df,e.transformation=En,e.version=r,e.videoOverlay=hf;var vf=window.L;e.noConflict=function(){return window.L=vf,this},window.L=e}))})(ns,ns.exports)),ns.exports}var LT=xT();const qu=RT(LT),OT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",NT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",DT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";delete qu.Icon.Default.prototype._getIconUrl;qu.Icon.Default.mergeOptions({iconRetinaUrl:OT,iconUrl:NT,shadowUrl:DT});window.L=qu;
